Sender: LSF System <lsfadmin@lo-g2-020>
Subject: Job 6133284: <python GridSearch.py> in cluster <leonhard> Done

Job <python GridSearch.py> was submitted from host <lo-login-01> by user <dgarellick> in cluster <leonhard> at Sat Apr 25 14:36:26 2020
Job was executed on host(s) <8*lo-g2-020>, in queue <gpu.24h>, as user <dgarellick> in cluster <leonhard> at Sat Apr 25 14:37:08 2020
</cluster/home/dgarellick> was used as the home directory.
</cluster/home/dgarellick/mlproject3/u_neural_net> was used as the working directory.
Started at Sat Apr 25 14:37:08 2020
Terminated at Sat Apr 25 22:50:24 2020
Results reported at Sat Apr 25 22:50:24 2020

Your job looked like:

------------------------------------------------------------
# LSBATCH: User input
python GridSearch.py
------------------------------------------------------------

Successfully completed.

Resource usage summary:

    CPU time :                                   24180.49 sec.
    Max Memory :                                 8465 MB
    Average Memory :                             6521.14 MB
    Total Requested Memory :                     64768.00 MB
    Delta Memory :                               56303.00 MB
    Max Swap :                                   -
    Max Processes :                              3
    Max Threads :                                64
    Run time :                                   29603 sec.
    Turnaround time :                            29638 sec.

The output (if any) follows:

2020-04-25 14:37:12.166879: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /cluster/apps/lsf/10.1/linux3.10-glibc2.17-x86_64/lib:/cluster/apps/gcc-4.8.5/libpng-1.6.27-d6quyddan2eotsexesxufytusf27xxgz/lib:/cluster/apps/gcc-4.8.5/jpeg-9b-psjvucpx7xwkflb3meatuo6ugdtapkex/lib:/cluster/apps/gcc-4.8.5/nccl-2.4.8-1-xpkpjc3dfz3c5knwctwl5vcut2ahfrwe/lib:/cluster/apps/gcc-4.8.5/cudnn-7.6.4-3ddmfyxxx2gkzhrra44ir3h3ls6yeuwe/lib64:/cluster/apps/gcc-4.8.5/cuda-10.1.243-7tq43deb5x4dbs4oe427w4zszno23q6r/extras/CUPTI/lib64:/cluster/apps/gcc-4.8.5/cuda-10.1.243-7tq43deb5x4dbs4oe427w4zszno23q6r/lib64:/cluster/apps/gcc-4.8.5/openblas-0.2.19-w25ydbabttcfa6g76gejjkthcm3xcuv3/lib:/cluster/apps/python/3.7.4/x86_64/lib64:/cluster/apps/gcc-4.8.5/hdf5-1.10.1-z22q436tpg5j5mrbfk4xex6k2dg73tfo/lib
2020-04-25 14:37:12.167385: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /cluster/apps/lsf/10.1/linux3.10-glibc2.17-x86_64/lib:/cluster/apps/gcc-4.8.5/libpng-1.6.27-d6quyddan2eotsexesxufytusf27xxgz/lib:/cluster/apps/gcc-4.8.5/jpeg-9b-psjvucpx7xwkflb3meatuo6ugdtapkex/lib:/cluster/apps/gcc-4.8.5/nccl-2.4.8-1-xpkpjc3dfz3c5knwctwl5vcut2ahfrwe/lib:/cluster/apps/gcc-4.8.5/cudnn-7.6.4-3ddmfyxxx2gkzhrra44ir3h3ls6yeuwe/lib64:/cluster/apps/gcc-4.8.5/cuda-10.1.243-7tq43deb5x4dbs4oe427w4zszno23q6r/extras/CUPTI/lib64:/cluster/apps/gcc-4.8.5/cuda-10.1.243-7tq43deb5x4dbs4oe427w4zszno23q6r/lib64:/cluster/apps/gcc-4.8.5/openblas-0.2.19-w25ydbabttcfa6g76gejjkthcm3xcuv3/lib:/cluster/apps/python/3.7.4/x86_64/lib64:/cluster/apps/gcc-4.8.5/hdf5-1.10.1-z22q436tpg5j5mrbfk4xex6k2dg73tfo/lib
2020-04-25 14:37:12.167402: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-04-25 14:37:17.295297: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-04-25 14:37:17.351828: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1555] Found device 0 with properties: 
pciBusID: 0000:b2:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.73GiB deviceMemoryBandwidth: 573.69GiB/s
2020-04-25 14:37:17.354158: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-25 14:37:17.377760: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-25 14:37:17.394044: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-25 14:37:17.401846: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-25 14:37:17.431632: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-25 14:37:17.441956: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-25 14:37:17.453601: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-25 14:37:17.459132: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1697] Adding visible gpu devices: 0
2020-04-25 14:37:17.460254: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-04-25 14:37:17.472970: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2600000000 Hz
2020-04-25 14:37:17.474054: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x43c8910 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-04-25 14:37:17.474092: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-04-25 14:37:17.635154: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x442eab0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-04-25 14:37:17.635226: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-04-25 14:37:17.639093: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1555] Found device 0 with properties: 
pciBusID: 0000:b2:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.73GiB deviceMemoryBandwidth: 573.69GiB/s
2020-04-25 14:37:17.639210: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-25 14:37:17.639246: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-04-25 14:37:17.639277: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-04-25 14:37:17.639325: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-04-25 14:37:17.639360: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-04-25 14:37:17.639393: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-04-25 14:37:17.639424: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-25 14:37:17.646661: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1697] Adding visible gpu devices: 0
2020-04-25 14:37:17.648927: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-04-25 14:37:17.654395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1096] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-25 14:37:17.654433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102]      0 
2020-04-25 14:37:17.654451: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] 0:   N 
2020-04-25 14:37:17.661513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1241] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10284 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:b2:00.0, compute capability: 7.5)
2020-04-25 14:37:26.130410: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-04-25 14:37:27.758674: W tensorflow/stream_executor/gpu/redzone_allocator.cc:312] Not found: ./bin/ptxas not found
Relying on driver to perform ptx compilation. This message will be only logged once.
2020-04-25 14:37:27.827554: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
<itertools.product object at 0x2b440f69b2d0>
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 256, 256, 32) 320         input_1[0][0]                    
__________________________________________________________________________________________________
leaky_re_lu_1 (LeakyReLU)       (None, 256, 256, 32) 0           conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 256, 256, 32) 9248        leaky_re_lu_1[0][0]              
__________________________________________________________________________________________________
leaky_re_lu_2 (LeakyReLU)       (None, 256, 256, 32) 0           conv2d_2[0][0]                   
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 128, 128, 32) 0           leaky_re_lu_2[0][0]              
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 128, 128, 32) 0           max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 128, 128, 64) 18496       dropout_1[0][0]                  
__________________________________________________________________________________________________
leaky_re_lu_3 (LeakyReLU)       (None, 128, 128, 64) 0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 128, 128, 64) 36928       leaky_re_lu_3[0][0]              
__________________________________________________________________________________________________
leaky_re_lu_4 (LeakyReLU)       (None, 128, 128, 64) 0           conv2d_4[0][0]                   
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 64, 64, 64)   0           leaky_re_lu_4[0][0]              
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64, 64, 64)   0           max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 64, 64, 128)  73856       dropout_2[0][0]                  
__________________________________________________________________________________________________
leaky_re_lu_5 (LeakyReLU)       (None, 64, 64, 128)  0           conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 64, 64, 128)  147584      leaky_re_lu_5[0][0]              
__________________________________________________________________________________________________
leaky_re_lu_6 (LeakyReLU)       (None, 64, 64, 128)  0           conv2d_6[0][0]                   
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 32, 32, 128)  0           leaky_re_lu_6[0][0]              
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 32, 32, 128)  0           max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 32, 32, 256)  295168      dropout_3[0][0]                  
__________________________________________________________________________________________________
leaky_re_lu_7 (LeakyReLU)       (None, 32, 32, 256)  0           conv2d_7[0][0]                   
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 32, 32, 256)  590080      leaky_re_lu_7[0][0]              
__________________________________________________________________________________________________
leaky_re_lu_8 (LeakyReLU)       (None, 32, 32, 256)  0           conv2d_8[0][0]                   
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 16, 16, 256)  0           leaky_re_lu_8[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 16, 16, 256)  0           max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 16, 16, 512)  1180160     dropout_4[0][0]                  
__________________________________________________________________________________________________
leaky_re_lu_9 (LeakyReLU)       (None, 16, 16, 512)  0           conv2d_9[0][0]                   
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 16, 16, 512)  2359808     leaky_re_lu_9[0][0]              
__________________________________________________________________________________________________
leaky_re_lu_10 (LeakyReLU)      (None, 16, 16, 512)  0           conv2d_10[0][0]                  
__________________________________________________________________________________________________
conv2d_transpose_1 (Conv2DTrans (None, 32, 32, 256)  1179904     leaky_re_lu_10[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_11 (LeakyReLU)      (None, 32, 32, 256)  0           conv2d_transpose_1[0][0]         
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 32, 32, 512)  0           leaky_re_lu_11[0][0]             
                                                                 leaky_re_lu_8[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 32, 32, 512)  0           concatenate_1[0][0]              
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 32, 32, 256)  1179904     dropout_5[0][0]                  
__________________________________________________________________________________________________
leaky_re_lu_12 (LeakyReLU)      (None, 32, 32, 256)  0           conv2d_11[0][0]                  
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 32, 32, 256)  590080      leaky_re_lu_12[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_13 (LeakyReLU)      (None, 32, 32, 256)  0           conv2d_12[0][0]                  
__________________________________________________________________________________________________
conv2d_transpose_2 (Conv2DTrans (None, 64, 64, 128)  295040      leaky_re_lu_13[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_14 (LeakyReLU)      (None, 64, 64, 128)  0           conv2d_transpose_2[0][0]         
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 64, 256)  0           leaky_re_lu_14[0][0]             
                                                                 leaky_re_lu_6[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 64, 64, 256)  0           concatenate_2[0][0]              
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 64, 64, 128)  295040      dropout_6[0][0]                  
__________________________________________________________________________________________________
leaky_re_lu_15 (LeakyReLU)      (None, 64, 64, 128)  0           conv2d_13[0][0]                  
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 64, 64, 128)  147584      leaky_re_lu_15[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_16 (LeakyReLU)      (None, 64, 64, 128)  0           conv2d_14[0][0]                  
__________________________________________________________________________________________________
conv2d_transpose_3 (Conv2DTrans (None, 128, 128, 64) 73792       leaky_re_lu_16[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_17 (LeakyReLU)      (None, 128, 128, 64) 0           conv2d_transpose_3[0][0]         
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 128, 128, 128 0           leaky_re_lu_17[0][0]             
                                                                 leaky_re_lu_4[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 128, 128, 128 0           concatenate_3[0][0]              
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 128, 128, 64) 73792       dropout_7[0][0]                  
__________________________________________________________________________________________________
leaky_re_lu_18 (LeakyReLU)      (None, 128, 128, 64) 0           conv2d_15[0][0]                  
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 128, 128, 64) 36928       leaky_re_lu_18[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_19 (LeakyReLU)      (None, 128, 128, 64) 0           conv2d_16[0][0]                  
__________________________________________________________________________________________________
conv2d_transpose_4 (Conv2DTrans (None, 256, 256, 32) 18464       leaky_re_lu_19[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_20 (LeakyReLU)      (None, 256, 256, 32) 0           conv2d_transpose_4[0][0]         
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 256, 256, 64) 0           leaky_re_lu_20[0][0]             
                                                                 leaky_re_lu_2[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 256, 256, 64) 0           concatenate_4[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 256, 256, 64) 0           dropout_8[0][0]                  
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 256, 256, 32) 18464       dropout_9[0][0]                  
__________________________________________________________________________________________________
leaky_re_lu_21 (LeakyReLU)      (None, 256, 256, 32) 0           conv2d_17[0][0]                  
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 256, 256, 32) 9248        leaky_re_lu_21[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_22 (LeakyReLU)      (None, 256, 256, 32) 0           conv2d_18[0][0]                  
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 256, 256, 3)  99          leaky_re_lu_22[0][0]             
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 27s - loss: 0.4366 - acc: 0.9237 - val_loss: 0.2478 - val_acc: 0.9432

Epoch 00001: val_acc improved from -inf to 0.94323, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.2074 - acc: 0.9317 - val_loss: 0.1774 - val_acc: 0.9433

Epoch 00002: val_acc improved from 0.94323 to 0.94329, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.1858 - acc: 0.9324 - val_loss: 0.1769 - val_acc: 0.9433

Epoch 00003: val_acc did not improve from 0.94329
Epoch 4/1000
 - 19s - loss: 0.1800 - acc: 0.9326 - val_loss: 0.1767 - val_acc: 0.9433

Epoch 00004: val_acc did not improve from 0.94329

Epoch 00004: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 5/1000
 - 19s - loss: 0.1687 - acc: 0.9327 - val_loss: 0.1715 - val_acc: 0.9433

Epoch 00005: val_acc did not improve from 0.94329
Epoch 6/1000
 - 19s - loss: 0.1659 - acc: 0.9327 - val_loss: 0.1714 - val_acc: 0.9433

Epoch 00006: val_acc did not improve from 0.94329
Epoch 7/1000
 - 19s - loss: 0.1646 - acc: 0.9327 - val_loss: 0.1656 - val_acc: 0.9433

Epoch 00007: val_acc did not improve from 0.94329

Epoch 00007: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 00007: early stopping
Model: "model_2"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 256, 256, 32) 320         input_2[0][0]                    
__________________________________________________________________________________________________
leaky_re_lu_23 (LeakyReLU)      (None, 256, 256, 32) 0           conv2d_20[0][0]                  
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 256, 256, 32) 9248        leaky_re_lu_23[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_24 (LeakyReLU)      (None, 256, 256, 32) 0           conv2d_21[0][0]                  
__________________________________________________________________________________________________
max_pooling2d_5 (MaxPooling2D)  (None, 128, 128, 32) 0           leaky_re_lu_24[0][0]             
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 128, 128, 32) 0           max_pooling2d_5[0][0]            
__________________________________________________________________________________________________
conv2d_22 (Conv2D)              (None, 128, 128, 64) 18496       dropout_10[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_25 (LeakyReLU)      (None, 128, 128, 64) 0           conv2d_22[0][0]                  
__________________________________________________________________________________________________
conv2d_23 (Conv2D)              (None, 128, 128, 64) 36928       leaky_re_lu_25[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_26 (LeakyReLU)      (None, 128, 128, 64) 0           conv2d_23[0][0]                  
__________________________________________________________________________________________________
max_pooling2d_6 (MaxPooling2D)  (None, 64, 64, 64)   0           leaky_re_lu_26[0][0]             
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 64, 64, 64)   0           max_pooling2d_6[0][0]            
__________________________________________________________________________________________________
conv2d_24 (Conv2D)              (None, 64, 64, 128)  73856       dropout_11[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_27 (LeakyReLU)      (None, 64, 64, 128)  0           conv2d_24[0][0]                  
__________________________________________________________________________________________________
conv2d_25 (Conv2D)              (None, 64, 64, 128)  147584      leaky_re_lu_27[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_28 (LeakyReLU)      (None, 64, 64, 128)  0           conv2d_25[0][0]                  
__________________________________________________________________________________________________
max_pooling2d_7 (MaxPooling2D)  (None, 32, 32, 128)  0           leaky_re_lu_28[0][0]             
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 32, 32, 128)  0           max_pooling2d_7[0][0]            
__________________________________________________________________________________________________
conv2d_26 (Conv2D)              (None, 32, 32, 256)  295168      dropout_12[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_29 (LeakyReLU)      (None, 32, 32, 256)  0           conv2d_26[0][0]                  
__________________________________________________________________________________________________
conv2d_27 (Conv2D)              (None, 32, 32, 256)  590080      leaky_re_lu_29[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_30 (LeakyReLU)      (None, 32, 32, 256)  0           conv2d_27[0][0]                  
__________________________________________________________________________________________________
max_pooling2d_8 (MaxPooling2D)  (None, 16, 16, 256)  0           leaky_re_lu_30[0][0]             
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 16, 16, 256)  0           max_pooling2d_8[0][0]            
__________________________________________________________________________________________________
conv2d_28 (Conv2D)              (None, 16, 16, 512)  1180160     dropout_13[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_31 (LeakyReLU)      (None, 16, 16, 512)  0           conv2d_28[0][0]                  
__________________________________________________________________________________________________
conv2d_29 (Conv2D)              (None, 16, 16, 512)  2359808     leaky_re_lu_31[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_32 (LeakyReLU)      (None, 16, 16, 512)  0           conv2d_29[0][0]                  
__________________________________________________________________________________________________
conv2d_transpose_5 (Conv2DTrans (None, 32, 32, 256)  1179904     leaky_re_lu_32[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_33 (LeakyReLU)      (None, 32, 32, 256)  0           conv2d_transpose_5[0][0]         
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 32, 32, 512)  0           leaky_re_lu_33[0][0]             
                                                                 leaky_re_lu_30[0][0]             
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 32, 32, 512)  0           concatenate_5[0][0]              
__________________________________________________________________________________________________
conv2d_30 (Conv2D)              (None, 32, 32, 256)  1179904     dropout_14[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_34 (LeakyReLU)      (None, 32, 32, 256)  0           conv2d_30[0][0]                  
__________________________________________________________________________________________________
conv2d_31 (Conv2D)              (None, 32, 32, 256)  590080      leaky_re_lu_34[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_35 (LeakyReLU)      (None, 32, 32, 256)  0           conv2d_31[0][0]                  
__________________________________________________________________________________________________
conv2d_transpose_6 (Conv2DTrans (None, 64, 64, 128)  295040      leaky_re_lu_35[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_36 (LeakyReLU)      (None, 64, 64, 128)  0           conv2d_transpose_6[0][0]         
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 64, 64, 256)  0           leaky_re_lu_36[0][0]             
                                                                 leaky_re_lu_28[0][0]             
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 64, 64, 256)  0           concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_32 (Conv2D)              (None, 64, 64, 128)  295040      dropout_15[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_37 (LeakyReLU)      (None, 64, 64, 128)  0           conv2d_32[0][0]                  
__________________________________________________________________________________________________
conv2d_33 (Conv2D)              (None, 64, 64, 128)  147584      leaky_re_lu_37[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_38 (LeakyReLU)      (None, 64, 64, 128)  0           conv2d_33[0][0]                  
__________________________________________________________________________________________________
conv2d_transpose_7 (Conv2DTrans (None, 128, 128, 64) 73792       leaky_re_lu_38[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_39 (LeakyReLU)      (None, 128, 128, 64) 0           conv2d_transpose_7[0][0]         
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 128, 128 0           leaky_re_lu_39[0][0]             
                                                                 leaky_re_lu_26[0][0]             
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 128, 128, 128 0           concatenate_7[0][0]              
__________________________________________________________________________________________________
conv2d_34 (Conv2D)              (None, 128, 128, 64) 73792       dropout_16[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_40 (LeakyReLU)      (None, 128, 128, 64) 0           conv2d_34[0][0]                  
__________________________________________________________________________________________________
conv2d_35 (Conv2D)              (None, 128, 128, 64) 36928       leaky_re_lu_40[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_41 (LeakyReLU)      (None, 128, 128, 64) 0           conv2d_35[0][0]                  
__________________________________________________________________________________________________
conv2d_transpose_8 (Conv2DTrans (None, 256, 256, 32) 18464       leaky_re_lu_41[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_42 (LeakyReLU)      (None, 256, 256, 32) 0           conv2d_transpose_8[0][0]         
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 256, 256, 64) 0           leaky_re_lu_42[0][0]             
                                                                 leaky_re_lu_24[0][0]             
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 256, 256, 64) 0           concatenate_8[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 256, 256, 64) 0           dropout_17[0][0]                 
__________________________________________________________________________________________________
conv2d_36 (Conv2D)              (None, 256, 256, 32) 18464       dropout_18[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_43 (LeakyReLU)      (None, 256, 256, 32) 0           conv2d_36[0][0]                  
__________________________________________________________________________________________________
conv2d_37 (Conv2D)              (None, 256, 256, 32) 9248        leaky_re_lu_43[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_44 (LeakyReLU)      (None, 256, 256, 32) 0           conv2d_37[0][0]                  
__________________________________________________________________________________________________
conv2d_38 (Conv2D)              (None, 256, 256, 3)  99          leaky_re_lu_44[0][0]             
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 0.6157 - acc: 0.9097 - val_loss: 0.2659 - val_acc: 0.9401

Epoch 00001: val_acc improved from -inf to 0.94008, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.2006 - acc: 0.9340 - val_loss: 0.1850 - val_acc: 0.9426

Epoch 00002: val_acc improved from 0.94008 to 0.94259, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.1836 - acc: 0.9353 - val_loss: 0.1680 - val_acc: 0.9417

Epoch 00003: val_acc did not improve from 0.94259
Epoch 4/1000
 - 19s - loss: 0.1700 - acc: 0.9361 - val_loss: 0.1644 - val_acc: 0.9430

Epoch 00004: val_acc improved from 0.94259 to 0.94299, saving model to unn_grid.h5
Epoch 5/1000
 - 19s - loss: 0.1664 - acc: 0.9367 - val_loss: 0.1911 - val_acc: 0.9405

Epoch 00005: val_acc did not improve from 0.94299
Epoch 6/1000
 - 19s - loss: 0.1610 - acc: 0.9369 - val_loss: 0.1550 - val_acc: 0.9429

Epoch 00006: val_acc did not improve from 0.94299
Epoch 7/1000
 - 19s - loss: 0.1581 - acc: 0.9370 - val_loss: 0.1749 - val_acc: 0.9431

Epoch 00007: val_acc improved from 0.94299 to 0.94315, saving model to unn_grid.h5
Epoch 8/1000
 - 19s - loss: 0.1522 - acc: 0.9379 - val_loss: 0.1645 - val_acc: 0.9479

Epoch 00008: val_acc improved from 0.94315 to 0.94792, saving model to unn_grid.h5
Epoch 9/1000
 - 19s - loss: 0.1449 - acc: 0.9431 - val_loss: 0.1496 - val_acc: 0.9439

Epoch 00009: val_acc did not improve from 0.94792
Epoch 10/1000
 - 19s - loss: 0.1336 - acc: 0.9493 - val_loss: 0.1382 - val_acc: 0.9447

Epoch 00010: val_acc did not improve from 0.94792
Epoch 11/1000
 - 19s - loss: 0.1273 - acc: 0.9522 - val_loss: 0.1267 - val_acc: 0.9563

Epoch 00011: val_acc improved from 0.94792 to 0.95631, saving model to unn_grid.h5
Epoch 12/1000
 - 19s - loss: 0.1200 - acc: 0.9561 - val_loss: 0.1250 - val_acc: 0.9567

Epoch 00012: val_acc improved from 0.95631 to 0.95668, saving model to unn_grid.h5
Epoch 13/1000
 - 19s - loss: 0.1108 - acc: 0.9594 - val_loss: 0.1264 - val_acc: 0.9590

Epoch 00013: val_acc improved from 0.95668 to 0.95897, saving model to unn_grid.h5
Epoch 14/1000
 - 19s - loss: 0.1072 - acc: 0.9611 - val_loss: 0.1204 - val_acc: 0.9557

Epoch 00014: val_acc did not improve from 0.95897
Epoch 15/1000
 - 19s - loss: 0.0977 - acc: 0.9645 - val_loss: 0.1278 - val_acc: 0.9514

Epoch 00015: val_acc did not improve from 0.95897
Epoch 16/1000
 - 19s - loss: 0.0922 - acc: 0.9665 - val_loss: 0.1049 - val_acc: 0.9648

Epoch 00016: val_acc improved from 0.95897 to 0.96475, saving model to unn_grid.h5
Epoch 17/1000
 - 19s - loss: 0.0886 - acc: 0.9678 - val_loss: 0.1085 - val_acc: 0.9604

Epoch 00017: val_acc did not improve from 0.96475
Epoch 18/1000
 - 19s - loss: 0.0826 - acc: 0.9693 - val_loss: 0.1227 - val_acc: 0.9555

Epoch 00018: val_acc did not improve from 0.96475
Epoch 19/1000
 - 19s - loss: 0.0798 - acc: 0.9709 - val_loss: 0.1036 - val_acc: 0.9625

Epoch 00019: val_acc did not improve from 0.96475

Epoch 00019: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 20/1000
 - 19s - loss: 0.0694 - acc: 0.9739 - val_loss: 0.0963 - val_acc: 0.9650

Epoch 00020: val_acc improved from 0.96475 to 0.96496, saving model to unn_grid.h5
Epoch 21/1000
 - 19s - loss: 0.0664 - acc: 0.9751 - val_loss: 0.0946 - val_acc: 0.9649

Epoch 00021: val_acc did not improve from 0.96496
Epoch 22/1000
 - 19s - loss: 0.0652 - acc: 0.9755 - val_loss: 0.0972 - val_acc: 0.9640

Epoch 00022: val_acc did not improve from 0.96496
Epoch 23/1000
 - 19s - loss: 0.0641 - acc: 0.9758 - val_loss: 0.1016 - val_acc: 0.9627

Epoch 00023: val_acc did not improve from 0.96496

Epoch 00023: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 24/1000
 - 19s - loss: 0.0628 - acc: 0.9765 - val_loss: 0.0996 - val_acc: 0.9636

Epoch 00024: val_acc did not improve from 0.96496
Epoch 25/1000
 - 19s - loss: 0.0627 - acc: 0.9764 - val_loss: 0.0978 - val_acc: 0.9642

Epoch 00025: val_acc did not improve from 0.96496
Epoch 00025: early stopping
Model: "model_3"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_3 (InputLayer)            (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_39 (Conv2D)              (None, 256, 256, 32) 320         input_3[0][0]                    
__________________________________________________________________________________________________
leaky_re_lu_45 (LeakyReLU)      (None, 256, 256, 32) 0           conv2d_39[0][0]                  
__________________________________________________________________________________________________
conv2d_40 (Conv2D)              (None, 256, 256, 32) 9248        leaky_re_lu_45[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_46 (LeakyReLU)      (None, 256, 256, 32) 0           conv2d_40[0][0]                  
__________________________________________________________________________________________________
max_pooling2d_9 (MaxPooling2D)  (None, 128, 128, 32) 0           leaky_re_lu_46[0][0]             
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 128, 128, 32) 0           max_pooling2d_9[0][0]            
__________________________________________________________________________________________________
conv2d_41 (Conv2D)              (None, 128, 128, 64) 18496       dropout_19[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_47 (LeakyReLU)      (None, 128, 128, 64) 0           conv2d_41[0][0]                  
__________________________________________________________________________________________________
conv2d_42 (Conv2D)              (None, 128, 128, 64) 36928       leaky_re_lu_47[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_48 (LeakyReLU)      (None, 128, 128, 64) 0           conv2d_42[0][0]                  
__________________________________________________________________________________________________
max_pooling2d_10 (MaxPooling2D) (None, 64, 64, 64)   0           leaky_re_lu_48[0][0]             
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 64, 64, 64)   0           max_pooling2d_10[0][0]           
__________________________________________________________________________________________________
conv2d_43 (Conv2D)              (None, 64, 64, 128)  73856       dropout_20[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_49 (LeakyReLU)      (None, 64, 64, 128)  0           conv2d_43[0][0]                  
__________________________________________________________________________________________________
conv2d_44 (Conv2D)              (None, 64, 64, 128)  147584      leaky_re_lu_49[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_50 (LeakyReLU)      (None, 64, 64, 128)  0           conv2d_44[0][0]                  
__________________________________________________________________________________________________
max_pooling2d_11 (MaxPooling2D) (None, 32, 32, 128)  0           leaky_re_lu_50[0][0]             
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 32, 32, 128)  0           max_pooling2d_11[0][0]           
__________________________________________________________________________________________________
conv2d_45 (Conv2D)              (None, 32, 32, 256)  295168      dropout_21[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_51 (LeakyReLU)      (None, 32, 32, 256)  0           conv2d_45[0][0]                  
__________________________________________________________________________________________________
conv2d_46 (Conv2D)              (None, 32, 32, 256)  590080      leaky_re_lu_51[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_52 (LeakyReLU)      (None, 32, 32, 256)  0           conv2d_46[0][0]                  
__________________________________________________________________________________________________
max_pooling2d_12 (MaxPooling2D) (None, 16, 16, 256)  0           leaky_re_lu_52[0][0]             
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 16, 16, 256)  0           max_pooling2d_12[0][0]           
__________________________________________________________________________________________________
conv2d_47 (Conv2D)              (None, 16, 16, 512)  1180160     dropout_22[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_53 (LeakyReLU)      (None, 16, 16, 512)  0           conv2d_47[0][0]                  
__________________________________________________________________________________________________
conv2d_48 (Conv2D)              (None, 16, 16, 512)  2359808     leaky_re_lu_53[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_54 (LeakyReLU)      (None, 16, 16, 512)  0           conv2d_48[0][0]                  
__________________________________________________________________________________________________
conv2d_transpose_9 (Conv2DTrans (None, 32, 32, 256)  1179904     leaky_re_lu_54[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_55 (LeakyReLU)      (None, 32, 32, 256)  0           conv2d_transpose_9[0][0]         
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 32, 32, 512)  0           leaky_re_lu_55[0][0]             
                                                                 leaky_re_lu_52[0][0]             
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 32, 32, 512)  0           concatenate_9[0][0]              
__________________________________________________________________________________________________
conv2d_49 (Conv2D)              (None, 32, 32, 256)  1179904     dropout_23[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_56 (LeakyReLU)      (None, 32, 32, 256)  0           conv2d_49[0][0]                  
__________________________________________________________________________________________________
conv2d_50 (Conv2D)              (None, 32, 32, 256)  590080      leaky_re_lu_56[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_57 (LeakyReLU)      (None, 32, 32, 256)  0           conv2d_50[0][0]                  
__________________________________________________________________________________________________
conv2d_transpose_10 (Conv2DTran (None, 64, 64, 128)  295040      leaky_re_lu_57[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_58 (LeakyReLU)      (None, 64, 64, 128)  0           conv2d_transpose_10[0][0]        
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 64, 64, 256)  0           leaky_re_lu_58[0][0]             
                                                                 leaky_re_lu_50[0][0]             
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 64, 64, 256)  0           concatenate_10[0][0]             
__________________________________________________________________________________________________
conv2d_51 (Conv2D)              (None, 64, 64, 128)  295040      dropout_24[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_59 (LeakyReLU)      (None, 64, 64, 128)  0           conv2d_51[0][0]                  
__________________________________________________________________________________________________
conv2d_52 (Conv2D)              (None, 64, 64, 128)  147584      leaky_re_lu_59[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_60 (LeakyReLU)      (None, 64, 64, 128)  0           conv2d_52[0][0]                  
__________________________________________________________________________________________________
conv2d_transpose_11 (Conv2DTran (None, 128, 128, 64) 73792       leaky_re_lu_60[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_61 (LeakyReLU)      (None, 128, 128, 64) 0           conv2d_transpose_11[0][0]        
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 128, 128, 128 0           leaky_re_lu_61[0][0]             
                                                                 leaky_re_lu_48[0][0]             
__________________________________________________________________________________________________
dropout_25 (Dropout)            (None, 128, 128, 128 0           concatenate_11[0][0]             
__________________________________________________________________________________________________
conv2d_53 (Conv2D)              (None, 128, 128, 64) 73792       dropout_25[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_62 (LeakyReLU)      (None, 128, 128, 64) 0           conv2d_53[0][0]                  
__________________________________________________________________________________________________
conv2d_54 (Conv2D)              (None, 128, 128, 64) 36928       leaky_re_lu_62[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_63 (LeakyReLU)      (None, 128, 128, 64) 0           conv2d_54[0][0]                  
__________________________________________________________________________________________________
conv2d_transpose_12 (Conv2DTran (None, 256, 256, 32) 18464       leaky_re_lu_63[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_64 (LeakyReLU)      (None, 256, 256, 32) 0           conv2d_transpose_12[0][0]        
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 256, 256, 64) 0           leaky_re_lu_64[0][0]             
                                                                 leaky_re_lu_46[0][0]             
__________________________________________________________________________________________________
dropout_26 (Dropout)            (None, 256, 256, 64) 0           concatenate_12[0][0]             
__________________________________________________________________________________________________
dropout_27 (Dropout)            (None, 256, 256, 64) 0           dropout_26[0][0]                 
__________________________________________________________________________________________________
conv2d_55 (Conv2D)              (None, 256, 256, 32) 18464       dropout_27[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_65 (LeakyReLU)      (None, 256, 256, 32) 0           conv2d_55[0][0]                  
__________________________________________________________________________________________________
conv2d_56 (Conv2D)              (None, 256, 256, 32) 9248        leaky_re_lu_65[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_66 (LeakyReLU)      (None, 256, 256, 32) 0           conv2d_56[0][0]                  
__________________________________________________________________________________________________
conv2d_57 (Conv2D)              (None, 256, 256, 3)  99          leaky_re_lu_66[0][0]             
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 0.7491 - acc: 0.9098 - val_loss: 0.2689 - val_acc: 0.9422

Epoch 00001: val_acc improved from -inf to 0.94219, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.2368 - acc: 0.9249 - val_loss: 0.2015 - val_acc: 0.9432

Epoch 00002: val_acc improved from 0.94219 to 0.94316, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.2076 - acc: 0.9277 - val_loss: 0.2584 - val_acc: 0.9309

Epoch 00003: val_acc did not improve from 0.94316
Epoch 4/1000
 - 19s - loss: 0.1926 - acc: 0.9287 - val_loss: 0.1970 - val_acc: 0.9318

Epoch 00004: val_acc did not improve from 0.94316
Epoch 5/1000
 - 19s - loss: 0.1859 - acc: 0.9291 - val_loss: 0.2075 - val_acc: 0.9382

Epoch 00005: val_acc did not improve from 0.94316

Epoch 00005: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 6/1000
 - 19s - loss: 0.1754 - acc: 0.9296 - val_loss: 0.1871 - val_acc: 0.9378

Epoch 00006: val_acc did not improve from 0.94316
Epoch 7/1000
 - 19s - loss: 0.1739 - acc: 0.9297 - val_loss: 0.1882 - val_acc: 0.9325

Epoch 00007: val_acc did not improve from 0.94316
Epoch 00007: early stopping
Model: "model_4"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_4 (InputLayer)            (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_58 (Conv2D)              (None, 256, 256, 32) 320         input_4[0][0]                    
__________________________________________________________________________________________________
leaky_re_lu_67 (LeakyReLU)      (None, 256, 256, 32) 0           conv2d_58[0][0]                  
__________________________________________________________________________________________________
conv2d_59 (Conv2D)              (None, 256, 256, 32) 9248        leaky_re_lu_67[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_68 (LeakyReLU)      (None, 256, 256, 32) 0           conv2d_59[0][0]                  
__________________________________________________________________________________________________
max_pooling2d_13 (MaxPooling2D) (None, 128, 128, 32) 0           leaky_re_lu_68[0][0]             
__________________________________________________________________________________________________
dropout_28 (Dropout)            (None, 128, 128, 32) 0           max_pooling2d_13[0][0]           
__________________________________________________________________________________________________
conv2d_60 (Conv2D)              (None, 128, 128, 64) 18496       dropout_28[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_69 (LeakyReLU)      (None, 128, 128, 64) 0           conv2d_60[0][0]                  
__________________________________________________________________________________________________
conv2d_61 (Conv2D)              (None, 128, 128, 64) 36928       leaky_re_lu_69[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_70 (LeakyReLU)      (None, 128, 128, 64) 0           conv2d_61[0][0]                  
__________________________________________________________________________________________________
max_pooling2d_14 (MaxPooling2D) (None, 64, 64, 64)   0           leaky_re_lu_70[0][0]             
__________________________________________________________________________________________________
dropout_29 (Dropout)            (None, 64, 64, 64)   0           max_pooling2d_14[0][0]           
__________________________________________________________________________________________________
conv2d_62 (Conv2D)              (None, 64, 64, 128)  73856       dropout_29[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_71 (LeakyReLU)      (None, 64, 64, 128)  0           conv2d_62[0][0]                  
__________________________________________________________________________________________________
conv2d_63 (Conv2D)              (None, 64, 64, 128)  147584      leaky_re_lu_71[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_72 (LeakyReLU)      (None, 64, 64, 128)  0           conv2d_63[0][0]                  
__________________________________________________________________________________________________
max_pooling2d_15 (MaxPooling2D) (None, 32, 32, 128)  0           leaky_re_lu_72[0][0]             
__________________________________________________________________________________________________
dropout_30 (Dropout)            (None, 32, 32, 128)  0           max_pooling2d_15[0][0]           
__________________________________________________________________________________________________
conv2d_64 (Conv2D)              (None, 32, 32, 256)  295168      dropout_30[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_73 (LeakyReLU)      (None, 32, 32, 256)  0           conv2d_64[0][0]                  
__________________________________________________________________________________________________
conv2d_65 (Conv2D)              (None, 32, 32, 256)  590080      leaky_re_lu_73[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_74 (LeakyReLU)      (None, 32, 32, 256)  0           conv2d_65[0][0]                  
__________________________________________________________________________________________________
max_pooling2d_16 (MaxPooling2D) (None, 16, 16, 256)  0           leaky_re_lu_74[0][0]             
__________________________________________________________________________________________________
dropout_31 (Dropout)            (None, 16, 16, 256)  0           max_pooling2d_16[0][0]           
__________________________________________________________________________________________________
conv2d_66 (Conv2D)              (None, 16, 16, 512)  1180160     dropout_31[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_75 (LeakyReLU)      (None, 16, 16, 512)  0           conv2d_66[0][0]                  
__________________________________________________________________________________________________
conv2d_67 (Conv2D)              (None, 16, 16, 512)  2359808     leaky_re_lu_75[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_76 (LeakyReLU)      (None, 16, 16, 512)  0           conv2d_67[0][0]                  
__________________________________________________________________________________________________
conv2d_transpose_13 (Conv2DTran (None, 32, 32, 256)  1179904     leaky_re_lu_76[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_77 (LeakyReLU)      (None, 32, 32, 256)  0           conv2d_transpose_13[0][0]        
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 32, 32, 512)  0           leaky_re_lu_77[0][0]             
                                                                 leaky_re_lu_74[0][0]             
__________________________________________________________________________________________________
dropout_32 (Dropout)            (None, 32, 32, 512)  0           concatenate_13[0][0]             
__________________________________________________________________________________________________
conv2d_68 (Conv2D)              (None, 32, 32, 256)  1179904     dropout_32[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_78 (LeakyReLU)      (None, 32, 32, 256)  0           conv2d_68[0][0]                  
__________________________________________________________________________________________________
conv2d_69 (Conv2D)              (None, 32, 32, 256)  590080      leaky_re_lu_78[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_79 (LeakyReLU)      (None, 32, 32, 256)  0           conv2d_69[0][0]                  
__________________________________________________________________________________________________
conv2d_transpose_14 (Conv2DTran (None, 64, 64, 128)  295040      leaky_re_lu_79[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_80 (LeakyReLU)      (None, 64, 64, 128)  0           conv2d_transpose_14[0][0]        
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 64, 64, 256)  0           leaky_re_lu_80[0][0]             
                                                                 leaky_re_lu_72[0][0]             
__________________________________________________________________________________________________
dropout_33 (Dropout)            (None, 64, 64, 256)  0           concatenate_14[0][0]             
__________________________________________________________________________________________________
conv2d_70 (Conv2D)              (None, 64, 64, 128)  295040      dropout_33[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_81 (LeakyReLU)      (None, 64, 64, 128)  0           conv2d_70[0][0]                  
__________________________________________________________________________________________________
conv2d_71 (Conv2D)              (None, 64, 64, 128)  147584      leaky_re_lu_81[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_82 (LeakyReLU)      (None, 64, 64, 128)  0           conv2d_71[0][0]                  
__________________________________________________________________________________________________
conv2d_transpose_15 (Conv2DTran (None, 128, 128, 64) 73792       leaky_re_lu_82[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_83 (LeakyReLU)      (None, 128, 128, 64) 0           conv2d_transpose_15[0][0]        
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 128, 128, 128 0           leaky_re_lu_83[0][0]             
                                                                 leaky_re_lu_70[0][0]             
__________________________________________________________________________________________________
dropout_34 (Dropout)            (None, 128, 128, 128 0           concatenate_15[0][0]             
__________________________________________________________________________________________________
conv2d_72 (Conv2D)              (None, 128, 128, 64) 73792       dropout_34[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_84 (LeakyReLU)      (None, 128, 128, 64) 0           conv2d_72[0][0]                  
__________________________________________________________________________________________________
conv2d_73 (Conv2D)              (None, 128, 128, 64) 36928       leaky_re_lu_84[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_85 (LeakyReLU)      (None, 128, 128, 64) 0           conv2d_73[0][0]                  
__________________________________________________________________________________________________
conv2d_transpose_16 (Conv2DTran (None, 256, 256, 32) 18464       leaky_re_lu_85[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_86 (LeakyReLU)      (None, 256, 256, 32) 0           conv2d_transpose_16[0][0]        
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 256, 256, 64) 0           leaky_re_lu_86[0][0]             
                                                                 leaky_re_lu_68[0][0]             
__________________________________________________________________________________________________
dropout_35 (Dropout)            (None, 256, 256, 64) 0           concatenate_16[0][0]             
__________________________________________________________________________________________________
dropout_36 (Dropout)            (None, 256, 256, 64) 0           dropout_35[0][0]                 
__________________________________________________________________________________________________
conv2d_74 (Conv2D)              (None, 256, 256, 32) 18464       dropout_36[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_87 (LeakyReLU)      (None, 256, 256, 32) 0           conv2d_74[0][0]                  
__________________________________________________________________________________________________
conv2d_75 (Conv2D)              (None, 256, 256, 32) 9248        leaky_re_lu_87[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_88 (LeakyReLU)      (None, 256, 256, 32) 0           conv2d_75[0][0]                  
__________________________________________________________________________________________________
conv2d_76 (Conv2D)              (None, 256, 256, 3)  99          leaky_re_lu_88[0][0]             
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 0.7184 - acc: 0.9068 - val_loss: 0.2209 - val_acc: 0.9412

Epoch 00001: val_acc improved from -inf to 0.94124, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.2227 - acc: 0.9315 - val_loss: 0.2388 - val_acc: 0.9412

Epoch 00002: val_acc did not improve from 0.94124
Epoch 3/1000
 - 19s - loss: 0.1934 - acc: 0.9345 - val_loss: 0.2854 - val_acc: 0.9404

Epoch 00003: val_acc did not improve from 0.94124
Epoch 4/1000
 - 19s - loss: 0.1806 - acc: 0.9361 - val_loss: 0.1808 - val_acc: 0.9433

Epoch 00004: val_acc improved from 0.94124 to 0.94328, saving model to unn_grid.h5
Epoch 5/1000
 - 19s - loss: 0.1699 - acc: 0.9369 - val_loss: 0.2340 - val_acc: 0.9333

Epoch 00005: val_acc did not improve from 0.94328
Epoch 6/1000
 - 19s - loss: 0.1613 - acc: 0.9375 - val_loss: 0.1938 - val_acc: 0.9445

Epoch 00006: val_acc improved from 0.94328 to 0.94449, saving model to unn_grid.h5
Epoch 7/1000
 - 19s - loss: 0.1564 - acc: 0.9391 - val_loss: 0.1868 - val_acc: 0.9480

Epoch 00007: val_acc improved from 0.94449 to 0.94796, saving model to unn_grid.h5
Epoch 8/1000
 - 19s - loss: 0.1490 - acc: 0.9436 - val_loss: 0.1708 - val_acc: 0.9511

Epoch 00008: val_acc improved from 0.94796 to 0.95109, saving model to unn_grid.h5
Epoch 9/1000
 - 19s - loss: 0.1391 - acc: 0.9498 - val_loss: 0.1657 - val_acc: 0.9492

Epoch 00009: val_acc did not improve from 0.95109
Epoch 10/1000
 - 19s - loss: 0.1302 - acc: 0.9531 - val_loss: 0.1356 - val_acc: 0.9525

Epoch 00010: val_acc improved from 0.95109 to 0.95249, saving model to unn_grid.h5
Epoch 11/1000
 - 19s - loss: 0.1231 - acc: 0.9563 - val_loss: 0.1651 - val_acc: 0.9444

Epoch 00011: val_acc did not improve from 0.95249
Epoch 12/1000
 - 19s - loss: 0.1166 - acc: 0.9582 - val_loss: 0.1424 - val_acc: 0.9514

Epoch 00012: val_acc did not improve from 0.95249
Epoch 13/1000
 - 19s - loss: 0.1141 - acc: 0.9596 - val_loss: 0.1457 - val_acc: 0.9455

Epoch 00013: val_acc did not improve from 0.95249

Epoch 00013: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 14/1000
 - 19s - loss: 0.0995 - acc: 0.9632 - val_loss: 0.1303 - val_acc: 0.9518

Epoch 00014: val_acc did not improve from 0.95249
Epoch 15/1000
 - 19s - loss: 0.0969 - acc: 0.9636 - val_loss: 0.1345 - val_acc: 0.9512

Epoch 00015: val_acc did not improve from 0.95249
Epoch 00015: early stopping
Model: "model_5"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_5 (InputLayer)            (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_77 (Conv2D)              (None, 256, 256, 32) 320         input_5[0][0]                    
__________________________________________________________________________________________________
leaky_re_lu_89 (LeakyReLU)      (None, 256, 256, 32) 0           conv2d_77[0][0]                  
__________________________________________________________________________________________________
conv2d_78 (Conv2D)              (None, 256, 256, 32) 9248        leaky_re_lu_89[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_90 (LeakyReLU)      (None, 256, 256, 32) 0           conv2d_78[0][0]                  
__________________________________________________________________________________________________
max_pooling2d_17 (MaxPooling2D) (None, 128, 128, 32) 0           leaky_re_lu_90[0][0]             
__________________________________________________________________________________________________
dropout_37 (Dropout)            (None, 128, 128, 32) 0           max_pooling2d_17[0][0]           
__________________________________________________________________________________________________
conv2d_79 (Conv2D)              (None, 128, 128, 64) 18496       dropout_37[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_91 (LeakyReLU)      (None, 128, 128, 64) 0           conv2d_79[0][0]                  
__________________________________________________________________________________________________
conv2d_80 (Conv2D)              (None, 128, 128, 64) 36928       leaky_re_lu_91[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_92 (LeakyReLU)      (None, 128, 128, 64) 0           conv2d_80[0][0]                  
__________________________________________________________________________________________________
max_pooling2d_18 (MaxPooling2D) (None, 64, 64, 64)   0           leaky_re_lu_92[0][0]             
__________________________________________________________________________________________________
dropout_38 (Dropout)            (None, 64, 64, 64)   0           max_pooling2d_18[0][0]           
__________________________________________________________________________________________________
conv2d_81 (Conv2D)              (None, 64, 64, 128)  73856       dropout_38[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_93 (LeakyReLU)      (None, 64, 64, 128)  0           conv2d_81[0][0]                  
__________________________________________________________________________________________________
conv2d_82 (Conv2D)              (None, 64, 64, 128)  147584      leaky_re_lu_93[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_94 (LeakyReLU)      (None, 64, 64, 128)  0           conv2d_82[0][0]                  
__________________________________________________________________________________________________
max_pooling2d_19 (MaxPooling2D) (None, 32, 32, 128)  0           leaky_re_lu_94[0][0]             
__________________________________________________________________________________________________
dropout_39 (Dropout)            (None, 32, 32, 128)  0           max_pooling2d_19[0][0]           
__________________________________________________________________________________________________
conv2d_83 (Conv2D)              (None, 32, 32, 256)  295168      dropout_39[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_95 (LeakyReLU)      (None, 32, 32, 256)  0           conv2d_83[0][0]                  
__________________________________________________________________________________________________
conv2d_84 (Conv2D)              (None, 32, 32, 256)  590080      leaky_re_lu_95[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_96 (LeakyReLU)      (None, 32, 32, 256)  0           conv2d_84[0][0]                  
__________________________________________________________________________________________________
max_pooling2d_20 (MaxPooling2D) (None, 16, 16, 256)  0           leaky_re_lu_96[0][0]             
__________________________________________________________________________________________________
dropout_40 (Dropout)            (None, 16, 16, 256)  0           max_pooling2d_20[0][0]           
__________________________________________________________________________________________________
conv2d_85 (Conv2D)              (None, 16, 16, 512)  1180160     dropout_40[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_97 (LeakyReLU)      (None, 16, 16, 512)  0           conv2d_85[0][0]                  
__________________________________________________________________________________________________
conv2d_86 (Conv2D)              (None, 16, 16, 512)  2359808     leaky_re_lu_97[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_98 (LeakyReLU)      (None, 16, 16, 512)  0           conv2d_86[0][0]                  
__________________________________________________________________________________________________
conv2d_transpose_17 (Conv2DTran (None, 32, 32, 256)  1179904     leaky_re_lu_98[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_99 (LeakyReLU)      (None, 32, 32, 256)  0           conv2d_transpose_17[0][0]        
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 32, 32, 512)  0           leaky_re_lu_99[0][0]             
                                                                 leaky_re_lu_96[0][0]             
__________________________________________________________________________________________________
dropout_41 (Dropout)            (None, 32, 32, 512)  0           concatenate_17[0][0]             
__________________________________________________________________________________________________
conv2d_87 (Conv2D)              (None, 32, 32, 256)  1179904     dropout_41[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_100 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_87[0][0]                  
__________________________________________________________________________________________________
conv2d_88 (Conv2D)              (None, 32, 32, 256)  590080      leaky_re_lu_100[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_101 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_88[0][0]                  
__________________________________________________________________________________________________
conv2d_transpose_18 (Conv2DTran (None, 64, 64, 128)  295040      leaky_re_lu_101[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_102 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_18[0][0]        
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 64, 64, 256)  0           leaky_re_lu_102[0][0]            
                                                                 leaky_re_lu_94[0][0]             
__________________________________________________________________________________________________
dropout_42 (Dropout)            (None, 64, 64, 256)  0           concatenate_18[0][0]             
__________________________________________________________________________________________________
conv2d_89 (Conv2D)              (None, 64, 64, 128)  295040      dropout_42[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_103 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_89[0][0]                  
__________________________________________________________________________________________________
conv2d_90 (Conv2D)              (None, 64, 64, 128)  147584      leaky_re_lu_103[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_104 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_90[0][0]                  
__________________________________________________________________________________________________
conv2d_transpose_19 (Conv2DTran (None, 128, 128, 64) 73792       leaky_re_lu_104[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_105 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_19[0][0]        
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 128, 128, 128 0           leaky_re_lu_105[0][0]            
                                                                 leaky_re_lu_92[0][0]             
__________________________________________________________________________________________________
dropout_43 (Dropout)            (None, 128, 128, 128 0           concatenate_19[0][0]             
__________________________________________________________________________________________________
conv2d_91 (Conv2D)              (None, 128, 128, 64) 73792       dropout_43[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_106 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_91[0][0]                  
__________________________________________________________________________________________________
conv2d_92 (Conv2D)              (None, 128, 128, 64) 36928       leaky_re_lu_106[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_107 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_92[0][0]                  
__________________________________________________________________________________________________
conv2d_transpose_20 (Conv2DTran (None, 256, 256, 32) 18464       leaky_re_lu_107[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_108 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_20[0][0]        
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 256, 256, 64) 0           leaky_re_lu_108[0][0]            
                                                                 leaky_re_lu_90[0][0]             
__________________________________________________________________________________________________
dropout_44 (Dropout)            (None, 256, 256, 64) 0           concatenate_20[0][0]             
__________________________________________________________________________________________________
dropout_45 (Dropout)            (None, 256, 256, 64) 0           dropout_44[0][0]                 
__________________________________________________________________________________________________
conv2d_93 (Conv2D)              (None, 256, 256, 32) 18464       dropout_45[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_109 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_93[0][0]                  
__________________________________________________________________________________________________
conv2d_94 (Conv2D)              (None, 256, 256, 32) 9248        leaky_re_lu_109[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_110 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_94[0][0]                  
__________________________________________________________________________________________________
conv2d_95 (Conv2D)              (None, 256, 256, 3)  99          leaky_re_lu_110[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1213 samples, validate on 135 samples
Epoch 1/1000
 - 24s - loss: 0.5330 - acc: 0.9270 - val_loss: 0.3328 - val_acc: 0.9124

Epoch 00001: val_acc improved from -inf to 0.91241, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.1998 - acc: 0.9392 - val_loss: 0.3059 - val_acc: 0.9135

Epoch 00002: val_acc improved from 0.91241 to 0.91348, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.1768 - acc: 0.9404 - val_loss: 0.2343 - val_acc: 0.9135

Epoch 00003: val_acc improved from 0.91348 to 0.91348, saving model to unn_grid.h5
Epoch 4/1000
 - 19s - loss: 0.1744 - acc: 0.9405 - val_loss: 0.2851 - val_acc: 0.9135

Epoch 00004: val_acc improved from 0.91348 to 0.91348, saving model to unn_grid.h5
Epoch 5/1000
 - 19s - loss: 0.1665 - acc: 0.9405 - val_loss: 0.2715 - val_acc: 0.9135

Epoch 00005: val_acc improved from 0.91348 to 0.91348, saving model to unn_grid.h5

Epoch 00005: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 6/1000
 - 19s - loss: 0.1551 - acc: 0.9405 - val_loss: 0.2313 - val_acc: 0.9135

Epoch 00006: val_acc did not improve from 0.91348
Epoch 7/1000
 - 19s - loss: 0.1519 - acc: 0.9406 - val_loss: 0.2291 - val_acc: 0.9135

Epoch 00007: val_acc did not improve from 0.91348
Epoch 8/1000
 - 19s - loss: 0.1507 - acc: 0.9406 - val_loss: 0.2386 - val_acc: 0.9135

Epoch 00008: val_acc did not improve from 0.91348

Epoch 00008: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 9/1000
 - 19s - loss: 0.1494 - acc: 0.9405 - val_loss: 0.2256 - val_acc: 0.9135

Epoch 00009: val_acc did not improve from 0.91348
Epoch 10/1000
 - 19s - loss: 0.1488 - acc: 0.9406 - val_loss: 0.2235 - val_acc: 0.9135

Epoch 00010: val_acc did not improve from 0.91348
Epoch 00010: early stopping
scores= [[0.94593302 0.45337382 0.40869075]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]] parameters= (32, 'Adam', 0.5, 'glorot_uniform', 0.0001)
Model: "model_6"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_6 (InputLayer)            (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_96 (Conv2D)              (None, 256, 256, 32) 320         input_6[0][0]                    
__________________________________________________________________________________________________
leaky_re_lu_111 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_96[0][0]                  
__________________________________________________________________________________________________
conv2d_97 (Conv2D)              (None, 256, 256, 32) 9248        leaky_re_lu_111[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_112 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_97[0][0]                  
__________________________________________________________________________________________________
max_pooling2d_21 (MaxPooling2D) (None, 128, 128, 32) 0           leaky_re_lu_112[0][0]            
__________________________________________________________________________________________________
dropout_46 (Dropout)            (None, 128, 128, 32) 0           max_pooling2d_21[0][0]           
__________________________________________________________________________________________________
conv2d_98 (Conv2D)              (None, 128, 128, 64) 18496       dropout_46[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_113 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_98[0][0]                  
__________________________________________________________________________________________________
conv2d_99 (Conv2D)              (None, 128, 128, 64) 36928       leaky_re_lu_113[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_114 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_99[0][0]                  
__________________________________________________________________________________________________
max_pooling2d_22 (MaxPooling2D) (None, 64, 64, 64)   0           leaky_re_lu_114[0][0]            
__________________________________________________________________________________________________
dropout_47 (Dropout)            (None, 64, 64, 64)   0           max_pooling2d_22[0][0]           
__________________________________________________________________________________________________
conv2d_100 (Conv2D)             (None, 64, 64, 128)  73856       dropout_47[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_115 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_100[0][0]                 
__________________________________________________________________________________________________
conv2d_101 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_115[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_116 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_101[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_23 (MaxPooling2D) (None, 32, 32, 128)  0           leaky_re_lu_116[0][0]            
__________________________________________________________________________________________________
dropout_48 (Dropout)            (None, 32, 32, 128)  0           max_pooling2d_23[0][0]           
__________________________________________________________________________________________________
conv2d_102 (Conv2D)             (None, 32, 32, 256)  295168      dropout_48[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_117 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_102[0][0]                 
__________________________________________________________________________________________________
conv2d_103 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_117[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_118 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_103[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_24 (MaxPooling2D) (None, 16, 16, 256)  0           leaky_re_lu_118[0][0]            
__________________________________________________________________________________________________
dropout_49 (Dropout)            (None, 16, 16, 256)  0           max_pooling2d_24[0][0]           
__________________________________________________________________________________________________
conv2d_104 (Conv2D)             (None, 16, 16, 512)  1180160     dropout_49[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_119 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_104[0][0]                 
__________________________________________________________________________________________________
conv2d_105 (Conv2D)             (None, 16, 16, 512)  2359808     leaky_re_lu_119[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_120 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_105[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_21 (Conv2DTran (None, 32, 32, 256)  1179904     leaky_re_lu_120[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_121 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_transpose_21[0][0]        
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 32, 32, 512)  0           leaky_re_lu_121[0][0]            
                                                                 leaky_re_lu_118[0][0]            
__________________________________________________________________________________________________
dropout_50 (Dropout)            (None, 32, 32, 512)  0           concatenate_21[0][0]             
__________________________________________________________________________________________________
conv2d_106 (Conv2D)             (None, 32, 32, 256)  1179904     dropout_50[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_122 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_106[0][0]                 
__________________________________________________________________________________________________
conv2d_107 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_122[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_123 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_107[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_22 (Conv2DTran (None, 64, 64, 128)  295040      leaky_re_lu_123[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_124 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_22[0][0]        
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 64, 64, 256)  0           leaky_re_lu_124[0][0]            
                                                                 leaky_re_lu_116[0][0]            
__________________________________________________________________________________________________
dropout_51 (Dropout)            (None, 64, 64, 256)  0           concatenate_22[0][0]             
__________________________________________________________________________________________________
conv2d_108 (Conv2D)             (None, 64, 64, 128)  295040      dropout_51[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_125 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_108[0][0]                 
__________________________________________________________________________________________________
conv2d_109 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_125[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_126 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_109[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_23 (Conv2DTran (None, 128, 128, 64) 73792       leaky_re_lu_126[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_127 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_23[0][0]        
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 128, 128, 128 0           leaky_re_lu_127[0][0]            
                                                                 leaky_re_lu_114[0][0]            
__________________________________________________________________________________________________
dropout_52 (Dropout)            (None, 128, 128, 128 0           concatenate_23[0][0]             
__________________________________________________________________________________________________
conv2d_110 (Conv2D)             (None, 128, 128, 64) 73792       dropout_52[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_128 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_110[0][0]                 
__________________________________________________________________________________________________
conv2d_111 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_128[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_129 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_111[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_24 (Conv2DTran (None, 256, 256, 32) 18464       leaky_re_lu_129[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_130 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_24[0][0]        
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 256, 256, 64) 0           leaky_re_lu_130[0][0]            
                                                                 leaky_re_lu_112[0][0]            
__________________________________________________________________________________________________
dropout_53 (Dropout)            (None, 256, 256, 64) 0           concatenate_24[0][0]             
__________________________________________________________________________________________________
dropout_54 (Dropout)            (None, 256, 256, 64) 0           dropout_53[0][0]                 
__________________________________________________________________________________________________
conv2d_112 (Conv2D)             (None, 256, 256, 32) 18464       dropout_54[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_131 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_112[0][0]                 
__________________________________________________________________________________________________
conv2d_113 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_131[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_132 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_113[0][0]                 
__________________________________________________________________________________________________
conv2d_114 (Conv2D)             (None, 256, 256, 3)  99          leaky_re_lu_132[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 1.5057 - acc: 0.7989 - val_loss: 0.7294 - val_acc: 0.9415

Epoch 00001: val_acc improved from -inf to 0.94148, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.6460 - acc: 0.9218 - val_loss: 0.6524 - val_acc: 0.9431

Epoch 00002: val_acc improved from 0.94148 to 0.94314, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.5344 - acc: 0.9240 - val_loss: 0.5288 - val_acc: 0.9431

Epoch 00003: val_acc did not improve from 0.94314
Epoch 4/1000
 - 19s - loss: 0.4103 - acc: 0.9212 - val_loss: 0.3575 - val_acc: 0.9400

Epoch 00004: val_acc did not improve from 0.94314
Epoch 5/1000
 - 19s - loss: 0.3124 - acc: 0.9227 - val_loss: 0.3728 - val_acc: 0.8600

Epoch 00005: val_acc did not improve from 0.94314

Epoch 00005: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 6/1000
 - 19s - loss: 0.2764 - acc: 0.9245 - val_loss: 0.3679 - val_acc: 0.8570

Epoch 00006: val_acc did not improve from 0.94314
Epoch 7/1000
 - 19s - loss: 0.2720 - acc: 0.9249 - val_loss: 0.3725 - val_acc: 0.8513

Epoch 00007: val_acc did not improve from 0.94314
Epoch 00007: early stopping
Model: "model_7"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_7 (InputLayer)            (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_115 (Conv2D)             (None, 256, 256, 32) 320         input_7[0][0]                    
__________________________________________________________________________________________________
leaky_re_lu_133 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_115[0][0]                 
__________________________________________________________________________________________________
conv2d_116 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_133[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_134 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_116[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_25 (MaxPooling2D) (None, 128, 128, 32) 0           leaky_re_lu_134[0][0]            
__________________________________________________________________________________________________
dropout_55 (Dropout)            (None, 128, 128, 32) 0           max_pooling2d_25[0][0]           
__________________________________________________________________________________________________
conv2d_117 (Conv2D)             (None, 128, 128, 64) 18496       dropout_55[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_135 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_117[0][0]                 
__________________________________________________________________________________________________
conv2d_118 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_135[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_136 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_118[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_26 (MaxPooling2D) (None, 64, 64, 64)   0           leaky_re_lu_136[0][0]            
__________________________________________________________________________________________________
dropout_56 (Dropout)            (None, 64, 64, 64)   0           max_pooling2d_26[0][0]           
__________________________________________________________________________________________________
conv2d_119 (Conv2D)             (None, 64, 64, 128)  73856       dropout_56[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_137 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_119[0][0]                 
__________________________________________________________________________________________________
conv2d_120 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_137[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_138 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_120[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_27 (MaxPooling2D) (None, 32, 32, 128)  0           leaky_re_lu_138[0][0]            
__________________________________________________________________________________________________
dropout_57 (Dropout)            (None, 32, 32, 128)  0           max_pooling2d_27[0][0]           
__________________________________________________________________________________________________
conv2d_121 (Conv2D)             (None, 32, 32, 256)  295168      dropout_57[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_139 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_121[0][0]                 
__________________________________________________________________________________________________
conv2d_122 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_139[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_140 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_122[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_28 (MaxPooling2D) (None, 16, 16, 256)  0           leaky_re_lu_140[0][0]            
__________________________________________________________________________________________________
dropout_58 (Dropout)            (None, 16, 16, 256)  0           max_pooling2d_28[0][0]           
__________________________________________________________________________________________________
conv2d_123 (Conv2D)             (None, 16, 16, 512)  1180160     dropout_58[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_141 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_123[0][0]                 
__________________________________________________________________________________________________
conv2d_124 (Conv2D)             (None, 16, 16, 512)  2359808     leaky_re_lu_141[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_142 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_124[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_25 (Conv2DTran (None, 32, 32, 256)  1179904     leaky_re_lu_142[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_143 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_transpose_25[0][0]        
__________________________________________________________________________________________________
concatenate_25 (Concatenate)    (None, 32, 32, 512)  0           leaky_re_lu_143[0][0]            
                                                                 leaky_re_lu_140[0][0]            
__________________________________________________________________________________________________
dropout_59 (Dropout)            (None, 32, 32, 512)  0           concatenate_25[0][0]             
__________________________________________________________________________________________________
conv2d_125 (Conv2D)             (None, 32, 32, 256)  1179904     dropout_59[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_144 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_125[0][0]                 
__________________________________________________________________________________________________
conv2d_126 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_144[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_145 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_126[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_26 (Conv2DTran (None, 64, 64, 128)  295040      leaky_re_lu_145[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_146 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_26[0][0]        
__________________________________________________________________________________________________
concatenate_26 (Concatenate)    (None, 64, 64, 256)  0           leaky_re_lu_146[0][0]            
                                                                 leaky_re_lu_138[0][0]            
__________________________________________________________________________________________________
dropout_60 (Dropout)            (None, 64, 64, 256)  0           concatenate_26[0][0]             
__________________________________________________________________________________________________
conv2d_127 (Conv2D)             (None, 64, 64, 128)  295040      dropout_60[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_147 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_127[0][0]                 
__________________________________________________________________________________________________
conv2d_128 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_147[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_148 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_128[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_27 (Conv2DTran (None, 128, 128, 64) 73792       leaky_re_lu_148[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_149 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_27[0][0]        
__________________________________________________________________________________________________
concatenate_27 (Concatenate)    (None, 128, 128, 128 0           leaky_re_lu_149[0][0]            
                                                                 leaky_re_lu_136[0][0]            
__________________________________________________________________________________________________
dropout_61 (Dropout)            (None, 128, 128, 128 0           concatenate_27[0][0]             
__________________________________________________________________________________________________
conv2d_129 (Conv2D)             (None, 128, 128, 64) 73792       dropout_61[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_150 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_129[0][0]                 
__________________________________________________________________________________________________
conv2d_130 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_150[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_151 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_130[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_28 (Conv2DTran (None, 256, 256, 32) 18464       leaky_re_lu_151[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_152 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_28[0][0]        
__________________________________________________________________________________________________
concatenate_28 (Concatenate)    (None, 256, 256, 64) 0           leaky_re_lu_152[0][0]            
                                                                 leaky_re_lu_134[0][0]            
__________________________________________________________________________________________________
dropout_62 (Dropout)            (None, 256, 256, 64) 0           concatenate_28[0][0]             
__________________________________________________________________________________________________
dropout_63 (Dropout)            (None, 256, 256, 64) 0           dropout_62[0][0]                 
__________________________________________________________________________________________________
conv2d_131 (Conv2D)             (None, 256, 256, 32) 18464       dropout_63[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_153 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_131[0][0]                 
__________________________________________________________________________________________________
conv2d_132 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_153[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_154 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_132[0][0]                 
__________________________________________________________________________________________________
conv2d_133 (Conv2D)             (None, 256, 256, 3)  99          leaky_re_lu_154[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 20s - loss: 1.6154 - acc: 0.8333 - val_loss: 0.8115 - val_acc: 0.9431

Epoch 00001: val_acc improved from -inf to 0.94307, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.7609 - acc: 0.9272 - val_loss: 0.6767 - val_acc: 0.9432

Epoch 00002: val_acc improved from 0.94307 to 0.94321, saving model to unn_grid.h5
Epoch 3/1000
 - 18s - loss: 0.5640 - acc: 0.9307 - val_loss: 0.6057 - val_acc: 0.9433

Epoch 00003: val_acc improved from 0.94321 to 0.94325, saving model to unn_grid.h5
Epoch 4/1000
 - 18s - loss: 0.4144 - acc: 0.9277 - val_loss: 0.3404 - val_acc: 0.9415

Epoch 00004: val_acc did not improve from 0.94325
Epoch 5/1000
 - 19s - loss: 0.2984 - acc: 0.9268 - val_loss: 0.3254 - val_acc: 0.9370

Epoch 00005: val_acc did not improve from 0.94325

Epoch 00005: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 6/1000
 - 19s - loss: 0.2627 - acc: 0.9292 - val_loss: 0.3095 - val_acc: 0.9361

Epoch 00006: val_acc did not improve from 0.94325
Epoch 7/1000
 - 19s - loss: 0.2582 - acc: 0.9294 - val_loss: 0.3144 - val_acc: 0.9351

Epoch 00007: val_acc did not improve from 0.94325
Epoch 8/1000
 - 19s - loss: 0.2553 - acc: 0.9294 - val_loss: 0.3144 - val_acc: 0.9344

Epoch 00008: val_acc did not improve from 0.94325

Epoch 00008: ReduceLROnPlateau reducing learning rate to 9.999999974752428e-08.
Epoch 00008: early stopping
Model: "model_8"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_8 (InputLayer)            (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_134 (Conv2D)             (None, 256, 256, 32) 320         input_8[0][0]                    
__________________________________________________________________________________________________
leaky_re_lu_155 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_134[0][0]                 
__________________________________________________________________________________________________
conv2d_135 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_155[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_156 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_135[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_29 (MaxPooling2D) (None, 128, 128, 32) 0           leaky_re_lu_156[0][0]            
__________________________________________________________________________________________________
dropout_64 (Dropout)            (None, 128, 128, 32) 0           max_pooling2d_29[0][0]           
__________________________________________________________________________________________________
conv2d_136 (Conv2D)             (None, 128, 128, 64) 18496       dropout_64[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_157 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_136[0][0]                 
__________________________________________________________________________________________________
conv2d_137 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_157[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_158 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_137[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_30 (MaxPooling2D) (None, 64, 64, 64)   0           leaky_re_lu_158[0][0]            
__________________________________________________________________________________________________
dropout_65 (Dropout)            (None, 64, 64, 64)   0           max_pooling2d_30[0][0]           
__________________________________________________________________________________________________
conv2d_138 (Conv2D)             (None, 64, 64, 128)  73856       dropout_65[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_159 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_138[0][0]                 
__________________________________________________________________________________________________
conv2d_139 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_159[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_160 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_139[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_31 (MaxPooling2D) (None, 32, 32, 128)  0           leaky_re_lu_160[0][0]            
__________________________________________________________________________________________________
dropout_66 (Dropout)            (None, 32, 32, 128)  0           max_pooling2d_31[0][0]           
__________________________________________________________________________________________________
conv2d_140 (Conv2D)             (None, 32, 32, 256)  295168      dropout_66[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_161 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_140[0][0]                 
__________________________________________________________________________________________________
conv2d_141 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_161[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_162 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_141[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_32 (MaxPooling2D) (None, 16, 16, 256)  0           leaky_re_lu_162[0][0]            
__________________________________________________________________________________________________
dropout_67 (Dropout)            (None, 16, 16, 256)  0           max_pooling2d_32[0][0]           
__________________________________________________________________________________________________
conv2d_142 (Conv2D)             (None, 16, 16, 512)  1180160     dropout_67[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_163 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_142[0][0]                 
__________________________________________________________________________________________________
conv2d_143 (Conv2D)             (None, 16, 16, 512)  2359808     leaky_re_lu_163[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_164 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_143[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_29 (Conv2DTran (None, 32, 32, 256)  1179904     leaky_re_lu_164[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_165 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_transpose_29[0][0]        
__________________________________________________________________________________________________
concatenate_29 (Concatenate)    (None, 32, 32, 512)  0           leaky_re_lu_165[0][0]            
                                                                 leaky_re_lu_162[0][0]            
__________________________________________________________________________________________________
dropout_68 (Dropout)            (None, 32, 32, 512)  0           concatenate_29[0][0]             
__________________________________________________________________________________________________
conv2d_144 (Conv2D)             (None, 32, 32, 256)  1179904     dropout_68[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_166 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_144[0][0]                 
__________________________________________________________________________________________________
conv2d_145 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_166[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_167 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_145[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_30 (Conv2DTran (None, 64, 64, 128)  295040      leaky_re_lu_167[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_168 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_30[0][0]        
__________________________________________________________________________________________________
concatenate_30 (Concatenate)    (None, 64, 64, 256)  0           leaky_re_lu_168[0][0]            
                                                                 leaky_re_lu_160[0][0]            
__________________________________________________________________________________________________
dropout_69 (Dropout)            (None, 64, 64, 256)  0           concatenate_30[0][0]             
__________________________________________________________________________________________________
conv2d_146 (Conv2D)             (None, 64, 64, 128)  295040      dropout_69[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_169 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_146[0][0]                 
__________________________________________________________________________________________________
conv2d_147 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_169[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_170 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_147[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_31 (Conv2DTran (None, 128, 128, 64) 73792       leaky_re_lu_170[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_171 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_31[0][0]        
__________________________________________________________________________________________________
concatenate_31 (Concatenate)    (None, 128, 128, 128 0           leaky_re_lu_171[0][0]            
                                                                 leaky_re_lu_158[0][0]            
__________________________________________________________________________________________________
dropout_70 (Dropout)            (None, 128, 128, 128 0           concatenate_31[0][0]             
__________________________________________________________________________________________________
conv2d_148 (Conv2D)             (None, 128, 128, 64) 73792       dropout_70[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_172 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_148[0][0]                 
__________________________________________________________________________________________________
conv2d_149 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_172[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_173 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_149[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_32 (Conv2DTran (None, 256, 256, 32) 18464       leaky_re_lu_173[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_174 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_32[0][0]        
__________________________________________________________________________________________________
concatenate_32 (Concatenate)    (None, 256, 256, 64) 0           leaky_re_lu_174[0][0]            
                                                                 leaky_re_lu_156[0][0]            
__________________________________________________________________________________________________
dropout_71 (Dropout)            (None, 256, 256, 64) 0           concatenate_32[0][0]             
__________________________________________________________________________________________________
dropout_72 (Dropout)            (None, 256, 256, 64) 0           dropout_71[0][0]                 
__________________________________________________________________________________________________
conv2d_150 (Conv2D)             (None, 256, 256, 32) 18464       dropout_72[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_175 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_150[0][0]                 
__________________________________________________________________________________________________
conv2d_151 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_175[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_176 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_151[0][0]                 
__________________________________________________________________________________________________
conv2d_152 (Conv2D)             (None, 256, 256, 3)  99          leaky_re_lu_176[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 2.4641 - acc: 0.7183 - val_loss: 0.7418 - val_acc: 0.9421

Epoch 00001: val_acc improved from -inf to 0.94213, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.8839 - acc: 0.9131 - val_loss: 0.6690 - val_acc: 0.9431

Epoch 00002: val_acc improved from 0.94213 to 0.94306, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.7256 - acc: 0.9197 - val_loss: 0.6509 - val_acc: 0.9432

Epoch 00003: val_acc improved from 0.94306 to 0.94317, saving model to unn_grid.h5
Epoch 4/1000
 - 19s - loss: 0.6166 - acc: 0.9216 - val_loss: 0.6055 - val_acc: 0.9428

Epoch 00004: val_acc did not improve from 0.94317
Epoch 5/1000
 - 19s - loss: 0.5154 - acc: 0.9206 - val_loss: 0.4217 - val_acc: 0.9374

Epoch 00005: val_acc did not improve from 0.94317
Epoch 6/1000
 - 19s - loss: 0.3749 - acc: 0.9175 - val_loss: 0.3129 - val_acc: 0.9232

Epoch 00006: val_acc did not improve from 0.94317

Epoch 00006: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 7/1000
 - 19s - loss: 0.3138 - acc: 0.9199 - val_loss: 0.3312 - val_acc: 0.9181

Epoch 00007: val_acc did not improve from 0.94317
Epoch 8/1000
 - 19s - loss: 0.3083 - acc: 0.9202 - val_loss: 0.3218 - val_acc: 0.9161

Epoch 00008: val_acc did not improve from 0.94317
Epoch 00008: early stopping
Model: "model_9"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_9 (InputLayer)            (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_153 (Conv2D)             (None, 256, 256, 32) 320         input_9[0][0]                    
__________________________________________________________________________________________________
leaky_re_lu_177 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_153[0][0]                 
__________________________________________________________________________________________________
conv2d_154 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_177[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_178 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_154[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_33 (MaxPooling2D) (None, 128, 128, 32) 0           leaky_re_lu_178[0][0]            
__________________________________________________________________________________________________
dropout_73 (Dropout)            (None, 128, 128, 32) 0           max_pooling2d_33[0][0]           
__________________________________________________________________________________________________
conv2d_155 (Conv2D)             (None, 128, 128, 64) 18496       dropout_73[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_179 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_155[0][0]                 
__________________________________________________________________________________________________
conv2d_156 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_179[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_180 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_156[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_34 (MaxPooling2D) (None, 64, 64, 64)   0           leaky_re_lu_180[0][0]            
__________________________________________________________________________________________________
dropout_74 (Dropout)            (None, 64, 64, 64)   0           max_pooling2d_34[0][0]           
__________________________________________________________________________________________________
conv2d_157 (Conv2D)             (None, 64, 64, 128)  73856       dropout_74[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_181 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_157[0][0]                 
__________________________________________________________________________________________________
conv2d_158 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_181[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_182 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_158[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_35 (MaxPooling2D) (None, 32, 32, 128)  0           leaky_re_lu_182[0][0]            
__________________________________________________________________________________________________
dropout_75 (Dropout)            (None, 32, 32, 128)  0           max_pooling2d_35[0][0]           
__________________________________________________________________________________________________
conv2d_159 (Conv2D)             (None, 32, 32, 256)  295168      dropout_75[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_183 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_159[0][0]                 
__________________________________________________________________________________________________
conv2d_160 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_183[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_184 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_160[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_36 (MaxPooling2D) (None, 16, 16, 256)  0           leaky_re_lu_184[0][0]            
__________________________________________________________________________________________________
dropout_76 (Dropout)            (None, 16, 16, 256)  0           max_pooling2d_36[0][0]           
__________________________________________________________________________________________________
conv2d_161 (Conv2D)             (None, 16, 16, 512)  1180160     dropout_76[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_185 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_161[0][0]                 
__________________________________________________________________________________________________
conv2d_162 (Conv2D)             (None, 16, 16, 512)  2359808     leaky_re_lu_185[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_186 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_162[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_33 (Conv2DTran (None, 32, 32, 256)  1179904     leaky_re_lu_186[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_187 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_transpose_33[0][0]        
__________________________________________________________________________________________________
concatenate_33 (Concatenate)    (None, 32, 32, 512)  0           leaky_re_lu_187[0][0]            
                                                                 leaky_re_lu_184[0][0]            
__________________________________________________________________________________________________
dropout_77 (Dropout)            (None, 32, 32, 512)  0           concatenate_33[0][0]             
__________________________________________________________________________________________________
conv2d_163 (Conv2D)             (None, 32, 32, 256)  1179904     dropout_77[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_188 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_163[0][0]                 
__________________________________________________________________________________________________
conv2d_164 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_188[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_189 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_164[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_34 (Conv2DTran (None, 64, 64, 128)  295040      leaky_re_lu_189[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_190 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_34[0][0]        
__________________________________________________________________________________________________
concatenate_34 (Concatenate)    (None, 64, 64, 256)  0           leaky_re_lu_190[0][0]            
                                                                 leaky_re_lu_182[0][0]            
__________________________________________________________________________________________________
dropout_78 (Dropout)            (None, 64, 64, 256)  0           concatenate_34[0][0]             
__________________________________________________________________________________________________
conv2d_165 (Conv2D)             (None, 64, 64, 128)  295040      dropout_78[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_191 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_165[0][0]                 
__________________________________________________________________________________________________
conv2d_166 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_191[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_192 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_166[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_35 (Conv2DTran (None, 128, 128, 64) 73792       leaky_re_lu_192[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_193 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_35[0][0]        
__________________________________________________________________________________________________
concatenate_35 (Concatenate)    (None, 128, 128, 128 0           leaky_re_lu_193[0][0]            
                                                                 leaky_re_lu_180[0][0]            
__________________________________________________________________________________________________
dropout_79 (Dropout)            (None, 128, 128, 128 0           concatenate_35[0][0]             
__________________________________________________________________________________________________
conv2d_167 (Conv2D)             (None, 128, 128, 64) 73792       dropout_79[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_194 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_167[0][0]                 
__________________________________________________________________________________________________
conv2d_168 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_194[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_195 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_168[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_36 (Conv2DTran (None, 256, 256, 32) 18464       leaky_re_lu_195[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_196 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_36[0][0]        
__________________________________________________________________________________________________
concatenate_36 (Concatenate)    (None, 256, 256, 64) 0           leaky_re_lu_196[0][0]            
                                                                 leaky_re_lu_178[0][0]            
__________________________________________________________________________________________________
dropout_80 (Dropout)            (None, 256, 256, 64) 0           concatenate_36[0][0]             
__________________________________________________________________________________________________
dropout_81 (Dropout)            (None, 256, 256, 64) 0           dropout_80[0][0]                 
__________________________________________________________________________________________________
conv2d_169 (Conv2D)             (None, 256, 256, 32) 18464       dropout_81[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_197 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_169[0][0]                 
__________________________________________________________________________________________________
conv2d_170 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_197[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_198 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_170[0][0]                 
__________________________________________________________________________________________________
conv2d_171 (Conv2D)             (None, 256, 256, 3)  99          leaky_re_lu_198[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 1.4745 - acc: 0.8086 - val_loss: 0.7277 - val_acc: 0.9431

Epoch 00001: val_acc improved from -inf to 0.94305, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.6816 - acc: 0.9277 - val_loss: 0.6885 - val_acc: 0.9432

Epoch 00002: val_acc improved from 0.94305 to 0.94323, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.5808 - acc: 0.9298 - val_loss: 0.5646 - val_acc: 0.9433

Epoch 00003: val_acc improved from 0.94323 to 0.94325, saving model to unn_grid.h5
Epoch 4/1000
 - 19s - loss: 0.4943 - acc: 0.9277 - val_loss: 0.4292 - val_acc: 0.9255

Epoch 00004: val_acc did not improve from 0.94325
Epoch 5/1000
 - 19s - loss: 0.3691 - acc: 0.9237 - val_loss: 0.4215 - val_acc: 0.9150

Epoch 00005: val_acc did not improve from 0.94325

Epoch 00005: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 6/1000
 - 19s - loss: 0.3025 - acc: 0.9265 - val_loss: 0.3979 - val_acc: 0.9117

Epoch 00006: val_acc did not improve from 0.94325
Epoch 7/1000
 - 19s - loss: 0.2926 - acc: 0.9271 - val_loss: 0.3958 - val_acc: 0.9093

Epoch 00007: val_acc did not improve from 0.94325
Epoch 8/1000
 - 19s - loss: 0.2848 - acc: 0.9275 - val_loss: 0.4039 - val_acc: 0.9097

Epoch 00008: val_acc did not improve from 0.94325

Epoch 00008: ReduceLROnPlateau reducing learning rate to 9.999999974752428e-08.
Epoch 00008: early stopping
Model: "model_10"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_10 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_172 (Conv2D)             (None, 256, 256, 32) 320         input_10[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_199 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_172[0][0]                 
__________________________________________________________________________________________________
conv2d_173 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_199[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_200 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_173[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_37 (MaxPooling2D) (None, 128, 128, 32) 0           leaky_re_lu_200[0][0]            
__________________________________________________________________________________________________
dropout_82 (Dropout)            (None, 128, 128, 32) 0           max_pooling2d_37[0][0]           
__________________________________________________________________________________________________
conv2d_174 (Conv2D)             (None, 128, 128, 64) 18496       dropout_82[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_201 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_174[0][0]                 
__________________________________________________________________________________________________
conv2d_175 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_201[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_202 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_175[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_38 (MaxPooling2D) (None, 64, 64, 64)   0           leaky_re_lu_202[0][0]            
__________________________________________________________________________________________________
dropout_83 (Dropout)            (None, 64, 64, 64)   0           max_pooling2d_38[0][0]           
__________________________________________________________________________________________________
conv2d_176 (Conv2D)             (None, 64, 64, 128)  73856       dropout_83[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_203 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_176[0][0]                 
__________________________________________________________________________________________________
conv2d_177 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_203[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_204 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_177[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_39 (MaxPooling2D) (None, 32, 32, 128)  0           leaky_re_lu_204[0][0]            
__________________________________________________________________________________________________
dropout_84 (Dropout)            (None, 32, 32, 128)  0           max_pooling2d_39[0][0]           
__________________________________________________________________________________________________
conv2d_178 (Conv2D)             (None, 32, 32, 256)  295168      dropout_84[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_205 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_178[0][0]                 
__________________________________________________________________________________________________
conv2d_179 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_205[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_206 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_179[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_40 (MaxPooling2D) (None, 16, 16, 256)  0           leaky_re_lu_206[0][0]            
__________________________________________________________________________________________________
dropout_85 (Dropout)            (None, 16, 16, 256)  0           max_pooling2d_40[0][0]           
__________________________________________________________________________________________________
conv2d_180 (Conv2D)             (None, 16, 16, 512)  1180160     dropout_85[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_207 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_180[0][0]                 
__________________________________________________________________________________________________
conv2d_181 (Conv2D)             (None, 16, 16, 512)  2359808     leaky_re_lu_207[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_208 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_181[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_37 (Conv2DTran (None, 32, 32, 256)  1179904     leaky_re_lu_208[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_209 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_transpose_37[0][0]        
__________________________________________________________________________________________________
concatenate_37 (Concatenate)    (None, 32, 32, 512)  0           leaky_re_lu_209[0][0]            
                                                                 leaky_re_lu_206[0][0]            
__________________________________________________________________________________________________
dropout_86 (Dropout)            (None, 32, 32, 512)  0           concatenate_37[0][0]             
__________________________________________________________________________________________________
conv2d_182 (Conv2D)             (None, 32, 32, 256)  1179904     dropout_86[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_210 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_182[0][0]                 
__________________________________________________________________________________________________
conv2d_183 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_210[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_211 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_183[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_38 (Conv2DTran (None, 64, 64, 128)  295040      leaky_re_lu_211[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_212 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_38[0][0]        
__________________________________________________________________________________________________
concatenate_38 (Concatenate)    (None, 64, 64, 256)  0           leaky_re_lu_212[0][0]            
                                                                 leaky_re_lu_204[0][0]            
__________________________________________________________________________________________________
dropout_87 (Dropout)            (None, 64, 64, 256)  0           concatenate_38[0][0]             
__________________________________________________________________________________________________
conv2d_184 (Conv2D)             (None, 64, 64, 128)  295040      dropout_87[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_213 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_184[0][0]                 
__________________________________________________________________________________________________
conv2d_185 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_213[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_214 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_185[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_39 (Conv2DTran (None, 128, 128, 64) 73792       leaky_re_lu_214[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_215 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_39[0][0]        
__________________________________________________________________________________________________
concatenate_39 (Concatenate)    (None, 128, 128, 128 0           leaky_re_lu_215[0][0]            
                                                                 leaky_re_lu_202[0][0]            
__________________________________________________________________________________________________
dropout_88 (Dropout)            (None, 128, 128, 128 0           concatenate_39[0][0]             
__________________________________________________________________________________________________
conv2d_186 (Conv2D)             (None, 128, 128, 64) 73792       dropout_88[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_216 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_186[0][0]                 
__________________________________________________________________________________________________
conv2d_187 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_216[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_217 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_187[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_40 (Conv2DTran (None, 256, 256, 32) 18464       leaky_re_lu_217[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_218 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_40[0][0]        
__________________________________________________________________________________________________
concatenate_40 (Concatenate)    (None, 256, 256, 64) 0           leaky_re_lu_218[0][0]            
                                                                 leaky_re_lu_200[0][0]            
__________________________________________________________________________________________________
dropout_89 (Dropout)            (None, 256, 256, 64) 0           concatenate_40[0][0]             
__________________________________________________________________________________________________
dropout_90 (Dropout)            (None, 256, 256, 64) 0           dropout_89[0][0]                 
__________________________________________________________________________________________________
conv2d_188 (Conv2D)             (None, 256, 256, 32) 18464       dropout_90[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_219 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_188[0][0]                 
__________________________________________________________________________________________________
conv2d_189 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_219[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_220 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_189[0][0]                 
__________________________________________________________________________________________________
conv2d_190 (Conv2D)             (None, 256, 256, 3)  99          leaky_re_lu_220[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1213 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 1.2387 - acc: 0.8421 - val_loss: 0.7081 - val_acc: 0.9134

Epoch 00001: val_acc improved from -inf to 0.91337, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.6334 - acc: 0.9330 - val_loss: 0.4996 - val_acc: 0.9135

Epoch 00002: val_acc improved from 0.91337 to 0.91346, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.5302 - acc: 0.9357 - val_loss: 0.4088 - val_acc: 0.9135

Epoch 00003: val_acc improved from 0.91346 to 0.91347, saving model to unn_grid.h5
Epoch 4/1000
 - 19s - loss: 0.3830 - acc: 0.9317 - val_loss: 0.3785 - val_acc: 0.9105

Epoch 00004: val_acc did not improve from 0.91347
Epoch 5/1000
 - 19s - loss: 0.2605 - acc: 0.9320 - val_loss: 0.3461 - val_acc: 0.9024

Epoch 00005: val_acc did not improve from 0.91347
Epoch 6/1000
 - 19s - loss: 0.2313 - acc: 0.9339 - val_loss: 0.3566 - val_acc: 0.9078

Epoch 00006: val_acc did not improve from 0.91347

Epoch 00006: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 7/1000
 - 19s - loss: 0.2180 - acc: 0.9352 - val_loss: 0.3521 - val_acc: 0.9084

Epoch 00007: val_acc did not improve from 0.91347
Epoch 8/1000
 - 19s - loss: 0.2157 - acc: 0.9355 - val_loss: 0.3440 - val_acc: 0.9083

Epoch 00008: val_acc did not improve from 0.91347
Epoch 00008: early stopping
scores= [[0.94593302 0.45337382 0.40869075]
 [0.93582602 0.33330832 0.3119443 ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]] parameters= (32, 'Adam', 0.5, 'glorot_uniform', 1e-05)
Model: "model_11"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_11 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_191 (Conv2D)             (None, 256, 256, 32) 320         input_11[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_221 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_191[0][0]                 
__________________________________________________________________________________________________
conv2d_192 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_221[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_222 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_192[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_41 (MaxPooling2D) (None, 128, 128, 32) 0           leaky_re_lu_222[0][0]            
__________________________________________________________________________________________________
dropout_91 (Dropout)            (None, 128, 128, 32) 0           max_pooling2d_41[0][0]           
__________________________________________________________________________________________________
conv2d_193 (Conv2D)             (None, 128, 128, 64) 18496       dropout_91[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_223 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_193[0][0]                 
__________________________________________________________________________________________________
conv2d_194 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_223[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_224 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_194[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_42 (MaxPooling2D) (None, 64, 64, 64)   0           leaky_re_lu_224[0][0]            
__________________________________________________________________________________________________
dropout_92 (Dropout)            (None, 64, 64, 64)   0           max_pooling2d_42[0][0]           
__________________________________________________________________________________________________
conv2d_195 (Conv2D)             (None, 64, 64, 128)  73856       dropout_92[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_225 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_195[0][0]                 
__________________________________________________________________________________________________
conv2d_196 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_225[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_226 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_196[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_43 (MaxPooling2D) (None, 32, 32, 128)  0           leaky_re_lu_226[0][0]            
__________________________________________________________________________________________________
dropout_93 (Dropout)            (None, 32, 32, 128)  0           max_pooling2d_43[0][0]           
__________________________________________________________________________________________________
conv2d_197 (Conv2D)             (None, 32, 32, 256)  295168      dropout_93[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_227 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_197[0][0]                 
__________________________________________________________________________________________________
conv2d_198 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_227[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_228 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_198[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_44 (MaxPooling2D) (None, 16, 16, 256)  0           leaky_re_lu_228[0][0]            
__________________________________________________________________________________________________
dropout_94 (Dropout)            (None, 16, 16, 256)  0           max_pooling2d_44[0][0]           
__________________________________________________________________________________________________
conv2d_199 (Conv2D)             (None, 16, 16, 512)  1180160     dropout_94[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_229 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_199[0][0]                 
__________________________________________________________________________________________________
conv2d_200 (Conv2D)             (None, 16, 16, 512)  2359808     leaky_re_lu_229[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_230 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_200[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_41 (Conv2DTran (None, 32, 32, 256)  1179904     leaky_re_lu_230[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_231 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_transpose_41[0][0]        
__________________________________________________________________________________________________
concatenate_41 (Concatenate)    (None, 32, 32, 512)  0           leaky_re_lu_231[0][0]            
                                                                 leaky_re_lu_228[0][0]            
__________________________________________________________________________________________________
dropout_95 (Dropout)            (None, 32, 32, 512)  0           concatenate_41[0][0]             
__________________________________________________________________________________________________
conv2d_201 (Conv2D)             (None, 32, 32, 256)  1179904     dropout_95[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_232 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_201[0][0]                 
__________________________________________________________________________________________________
conv2d_202 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_232[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_233 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_202[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_42 (Conv2DTran (None, 64, 64, 128)  295040      leaky_re_lu_233[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_234 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_42[0][0]        
__________________________________________________________________________________________________
concatenate_42 (Concatenate)    (None, 64, 64, 256)  0           leaky_re_lu_234[0][0]            
                                                                 leaky_re_lu_226[0][0]            
__________________________________________________________________________________________________
dropout_96 (Dropout)            (None, 64, 64, 256)  0           concatenate_42[0][0]             
__________________________________________________________________________________________________
conv2d_203 (Conv2D)             (None, 64, 64, 128)  295040      dropout_96[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_235 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_203[0][0]                 
__________________________________________________________________________________________________
conv2d_204 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_235[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_236 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_204[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_43 (Conv2DTran (None, 128, 128, 64) 73792       leaky_re_lu_236[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_237 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_43[0][0]        
__________________________________________________________________________________________________
concatenate_43 (Concatenate)    (None, 128, 128, 128 0           leaky_re_lu_237[0][0]            
                                                                 leaky_re_lu_224[0][0]            
__________________________________________________________________________________________________
dropout_97 (Dropout)            (None, 128, 128, 128 0           concatenate_43[0][0]             
__________________________________________________________________________________________________
conv2d_205 (Conv2D)             (None, 128, 128, 64) 73792       dropout_97[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_238 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_205[0][0]                 
__________________________________________________________________________________________________
conv2d_206 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_238[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_239 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_206[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_44 (Conv2DTran (None, 256, 256, 32) 18464       leaky_re_lu_239[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_240 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_44[0][0]        
__________________________________________________________________________________________________
concatenate_44 (Concatenate)    (None, 256, 256, 64) 0           leaky_re_lu_240[0][0]            
                                                                 leaky_re_lu_222[0][0]            
__________________________________________________________________________________________________
dropout_98 (Dropout)            (None, 256, 256, 64) 0           concatenate_44[0][0]             
__________________________________________________________________________________________________
dropout_99 (Dropout)            (None, 256, 256, 64) 0           dropout_98[0][0]                 
__________________________________________________________________________________________________
conv2d_207 (Conv2D)             (None, 256, 256, 32) 18464       dropout_99[0][0]                 
__________________________________________________________________________________________________
leaky_re_lu_241 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_207[0][0]                 
__________________________________________________________________________________________________
conv2d_208 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_241[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_242 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_208[0][0]                 
__________________________________________________________________________________________________
conv2d_209 (Conv2D)             (None, 256, 256, 3)  99          leaky_re_lu_242[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 0.8349 - acc: 0.8932 - val_loss: 0.2709 - val_acc: 0.9371

Epoch 00001: val_acc improved from -inf to 0.93705, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.2218 - acc: 0.9287 - val_loss: 0.1790 - val_acc: 0.9432

Epoch 00002: val_acc improved from 0.93705 to 0.94324, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.1919 - acc: 0.9313 - val_loss: 0.1660 - val_acc: 0.9432

Epoch 00003: val_acc improved from 0.94324 to 0.94325, saving model to unn_grid.h5
Epoch 4/1000
 - 19s - loss: 0.1781 - acc: 0.9321 - val_loss: 0.1706 - val_acc: 0.9447

Epoch 00004: val_acc improved from 0.94325 to 0.94474, saving model to unn_grid.h5
Epoch 5/1000
 - 19s - loss: 0.1721 - acc: 0.9322 - val_loss: 0.1573 - val_acc: 0.9433

Epoch 00005: val_acc did not improve from 0.94474
Epoch 6/1000
 - 19s - loss: 0.1665 - acc: 0.9328 - val_loss: 0.1404 - val_acc: 0.9435

Epoch 00006: val_acc did not improve from 0.94474
Epoch 7/1000
 - 19s - loss: 0.1591 - acc: 0.9334 - val_loss: 0.1568 - val_acc: 0.9481

Epoch 00007: val_acc improved from 0.94474 to 0.94813, saving model to unn_grid.h5
Epoch 8/1000
 - 19s - loss: 0.1516 - acc: 0.9347 - val_loss: 0.1421 - val_acc: 0.9524

Epoch 00008: val_acc improved from 0.94813 to 0.95241, saving model to unn_grid.h5
Epoch 9/1000
 - 19s - loss: 0.1458 - acc: 0.9391 - val_loss: 0.1433 - val_acc: 0.9504

Epoch 00009: val_acc did not improve from 0.95241
Epoch 10/1000
 - 19s - loss: 0.1334 - acc: 0.9481 - val_loss: 0.1245 - val_acc: 0.9508

Epoch 00010: val_acc did not improve from 0.95241
Epoch 11/1000
 - 19s - loss: 0.1238 - acc: 0.9530 - val_loss: 0.1301 - val_acc: 0.9550

Epoch 00011: val_acc improved from 0.95241 to 0.95501, saving model to unn_grid.h5
Epoch 12/1000
 - 19s - loss: 0.1154 - acc: 0.9573 - val_loss: 0.1159 - val_acc: 0.9583

Epoch 00012: val_acc improved from 0.95501 to 0.95826, saving model to unn_grid.h5
Epoch 13/1000
 - 19s - loss: 0.1087 - acc: 0.9596 - val_loss: 0.1072 - val_acc: 0.9639

Epoch 00013: val_acc improved from 0.95826 to 0.96390, saving model to unn_grid.h5
Epoch 14/1000
 - 19s - loss: 0.1007 - acc: 0.9627 - val_loss: 0.1137 - val_acc: 0.9605

Epoch 00014: val_acc did not improve from 0.96390
Epoch 15/1000
 - 19s - loss: 0.0963 - acc: 0.9644 - val_loss: 0.1129 - val_acc: 0.9641

Epoch 00015: val_acc improved from 0.96390 to 0.96412, saving model to unn_grid.h5
Epoch 16/1000
 - 19s - loss: 0.0919 - acc: 0.9661 - val_loss: 0.0986 - val_acc: 0.9644

Epoch 00016: val_acc improved from 0.96412 to 0.96444, saving model to unn_grid.h5
Epoch 17/1000
 - 19s - loss: 0.0856 - acc: 0.9679 - val_loss: 0.0981 - val_acc: 0.9652

Epoch 00017: val_acc improved from 0.96444 to 0.96516, saving model to unn_grid.h5
Epoch 18/1000
 - 19s - loss: 0.0821 - acc: 0.9693 - val_loss: 0.1007 - val_acc: 0.9627

Epoch 00018: val_acc did not improve from 0.96516
Epoch 19/1000
 - 19s - loss: 0.0800 - acc: 0.9694 - val_loss: 0.0936 - val_acc: 0.9655

Epoch 00019: val_acc improved from 0.96516 to 0.96548, saving model to unn_grid.h5
Epoch 20/1000
 - 19s - loss: 0.0762 - acc: 0.9715 - val_loss: 0.0884 - val_acc: 0.9687

Epoch 00020: val_acc improved from 0.96548 to 0.96869, saving model to unn_grid.h5
Epoch 21/1000
 - 19s - loss: 0.0740 - acc: 0.9719 - val_loss: 0.0912 - val_acc: 0.9692

Epoch 00021: val_acc improved from 0.96869 to 0.96924, saving model to unn_grid.h5
Epoch 22/1000
 - 19s - loss: 0.0711 - acc: 0.9728 - val_loss: 0.0850 - val_acc: 0.9678

Epoch 00022: val_acc did not improve from 0.96924
Epoch 23/1000
 - 19s - loss: 0.0658 - acc: 0.9750 - val_loss: 0.0976 - val_acc: 0.9696

Epoch 00023: val_acc improved from 0.96924 to 0.96961, saving model to unn_grid.h5
Epoch 24/1000
 - 19s - loss: 0.0636 - acc: 0.9757 - val_loss: 0.0959 - val_acc: 0.9661

Epoch 00024: val_acc did not improve from 0.96961
Epoch 25/1000
 - 19s - loss: 0.0638 - acc: 0.9759 - val_loss: 0.0899 - val_acc: 0.9687

Epoch 00025: val_acc did not improve from 0.96961
Epoch 26/1000
 - 19s - loss: 0.0608 - acc: 0.9765 - val_loss: 0.0923 - val_acc: 0.9698

Epoch 00026: val_acc improved from 0.96961 to 0.96980, saving model to unn_grid.h5
Epoch 27/1000
 - 19s - loss: 0.0579 - acc: 0.9778 - val_loss: 0.0866 - val_acc: 0.9675

Epoch 00027: val_acc did not improve from 0.96980
Epoch 28/1000
 - 19s - loss: 0.0579 - acc: 0.9781 - val_loss: 0.1034 - val_acc: 0.9669

Epoch 00028: val_acc did not improve from 0.96980
Epoch 29/1000
 - 19s - loss: 0.0535 - acc: 0.9795 - val_loss: 0.0939 - val_acc: 0.9688

Epoch 00029: val_acc did not improve from 0.96980

Epoch 00029: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 30/1000
 - 19s - loss: 0.0441 - acc: 0.9830 - val_loss: 0.0912 - val_acc: 0.9711

Epoch 00030: val_acc improved from 0.96980 to 0.97107, saving model to unn_grid.h5
Epoch 31/1000
 - 19s - loss: 0.0415 - acc: 0.9838 - val_loss: 0.0924 - val_acc: 0.9710

Epoch 00031: val_acc did not improve from 0.97107
Epoch 32/1000
 - 19s - loss: 0.0406 - acc: 0.9843 - val_loss: 0.0966 - val_acc: 0.9710

Epoch 00032: val_acc did not improve from 0.97107
Epoch 33/1000
 - 19s - loss: 0.0397 - acc: 0.9846 - val_loss: 0.0946 - val_acc: 0.9714

Epoch 00033: val_acc improved from 0.97107 to 0.97137, saving model to unn_grid.h5
Epoch 34/1000
 - 19s - loss: 0.0391 - acc: 0.9848 - val_loss: 0.0952 - val_acc: 0.9702

Epoch 00034: val_acc did not improve from 0.97137
Epoch 35/1000
 - 19s - loss: 0.0384 - acc: 0.9851 - val_loss: 0.0977 - val_acc: 0.9704

Epoch 00035: val_acc did not improve from 0.97137
Epoch 36/1000
 - 19s - loss: 0.0379 - acc: 0.9852 - val_loss: 0.0958 - val_acc: 0.9707

Epoch 00036: val_acc did not improve from 0.97137

Epoch 00036: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 37/1000
 - 19s - loss: 0.0369 - acc: 0.9856 - val_loss: 0.0972 - val_acc: 0.9710

Epoch 00037: val_acc did not improve from 0.97137
Epoch 38/1000
 - 19s - loss: 0.0365 - acc: 0.9857 - val_loss: 0.0977 - val_acc: 0.9709

Epoch 00038: val_acc did not improve from 0.97137
Epoch 00038: early stopping
Model: "model_12"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_12 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_210 (Conv2D)             (None, 256, 256, 32) 320         input_12[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_243 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_210[0][0]                 
__________________________________________________________________________________________________
conv2d_211 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_243[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_244 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_211[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_45 (MaxPooling2D) (None, 128, 128, 32) 0           leaky_re_lu_244[0][0]            
__________________________________________________________________________________________________
dropout_100 (Dropout)           (None, 128, 128, 32) 0           max_pooling2d_45[0][0]           
__________________________________________________________________________________________________
conv2d_212 (Conv2D)             (None, 128, 128, 64) 18496       dropout_100[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_245 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_212[0][0]                 
__________________________________________________________________________________________________
conv2d_213 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_245[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_246 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_213[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_46 (MaxPooling2D) (None, 64, 64, 64)   0           leaky_re_lu_246[0][0]            
__________________________________________________________________________________________________
dropout_101 (Dropout)           (None, 64, 64, 64)   0           max_pooling2d_46[0][0]           
__________________________________________________________________________________________________
conv2d_214 (Conv2D)             (None, 64, 64, 128)  73856       dropout_101[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_247 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_214[0][0]                 
__________________________________________________________________________________________________
conv2d_215 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_247[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_248 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_215[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_47 (MaxPooling2D) (None, 32, 32, 128)  0           leaky_re_lu_248[0][0]            
__________________________________________________________________________________________________
dropout_102 (Dropout)           (None, 32, 32, 128)  0           max_pooling2d_47[0][0]           
__________________________________________________________________________________________________
conv2d_216 (Conv2D)             (None, 32, 32, 256)  295168      dropout_102[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_249 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_216[0][0]                 
__________________________________________________________________________________________________
conv2d_217 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_249[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_250 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_217[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_48 (MaxPooling2D) (None, 16, 16, 256)  0           leaky_re_lu_250[0][0]            
__________________________________________________________________________________________________
dropout_103 (Dropout)           (None, 16, 16, 256)  0           max_pooling2d_48[0][0]           
__________________________________________________________________________________________________
conv2d_218 (Conv2D)             (None, 16, 16, 512)  1180160     dropout_103[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_251 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_218[0][0]                 
__________________________________________________________________________________________________
conv2d_219 (Conv2D)             (None, 16, 16, 512)  2359808     leaky_re_lu_251[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_252 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_219[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_45 (Conv2DTran (None, 32, 32, 256)  1179904     leaky_re_lu_252[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_253 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_transpose_45[0][0]        
__________________________________________________________________________________________________
concatenate_45 (Concatenate)    (None, 32, 32, 512)  0           leaky_re_lu_253[0][0]            
                                                                 leaky_re_lu_250[0][0]            
__________________________________________________________________________________________________
dropout_104 (Dropout)           (None, 32, 32, 512)  0           concatenate_45[0][0]             
__________________________________________________________________________________________________
conv2d_220 (Conv2D)             (None, 32, 32, 256)  1179904     dropout_104[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_254 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_220[0][0]                 
__________________________________________________________________________________________________
conv2d_221 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_254[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_255 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_221[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_46 (Conv2DTran (None, 64, 64, 128)  295040      leaky_re_lu_255[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_256 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_46[0][0]        
__________________________________________________________________________________________________
concatenate_46 (Concatenate)    (None, 64, 64, 256)  0           leaky_re_lu_256[0][0]            
                                                                 leaky_re_lu_248[0][0]            
__________________________________________________________________________________________________
dropout_105 (Dropout)           (None, 64, 64, 256)  0           concatenate_46[0][0]             
__________________________________________________________________________________________________
conv2d_222 (Conv2D)             (None, 64, 64, 128)  295040      dropout_105[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_257 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_222[0][0]                 
__________________________________________________________________________________________________
conv2d_223 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_257[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_258 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_223[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_47 (Conv2DTran (None, 128, 128, 64) 73792       leaky_re_lu_258[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_259 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_47[0][0]        
__________________________________________________________________________________________________
concatenate_47 (Concatenate)    (None, 128, 128, 128 0           leaky_re_lu_259[0][0]            
                                                                 leaky_re_lu_246[0][0]            
__________________________________________________________________________________________________
dropout_106 (Dropout)           (None, 128, 128, 128 0           concatenate_47[0][0]             
__________________________________________________________________________________________________
conv2d_224 (Conv2D)             (None, 128, 128, 64) 73792       dropout_106[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_260 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_224[0][0]                 
__________________________________________________________________________________________________
conv2d_225 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_260[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_261 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_225[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_48 (Conv2DTran (None, 256, 256, 32) 18464       leaky_re_lu_261[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_262 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_48[0][0]        
__________________________________________________________________________________________________
concatenate_48 (Concatenate)    (None, 256, 256, 64) 0           leaky_re_lu_262[0][0]            
                                                                 leaky_re_lu_244[0][0]            
__________________________________________________________________________________________________
dropout_107 (Dropout)           (None, 256, 256, 64) 0           concatenate_48[0][0]             
__________________________________________________________________________________________________
dropout_108 (Dropout)           (None, 256, 256, 64) 0           dropout_107[0][0]                
__________________________________________________________________________________________________
conv2d_226 (Conv2D)             (None, 256, 256, 32) 18464       dropout_108[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_263 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_226[0][0]                 
__________________________________________________________________________________________________
conv2d_227 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_263[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_264 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_227[0][0]                 
__________________________________________________________________________________________________
conv2d_228 (Conv2D)             (None, 256, 256, 3)  99          leaky_re_lu_264[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 0.8510 - acc: 0.9033 - val_loss: 0.3037 - val_acc: 0.9408

Epoch 00001: val_acc improved from -inf to 0.94080, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.2154 - acc: 0.9324 - val_loss: 0.2001 - val_acc: 0.9429

Epoch 00002: val_acc improved from 0.94080 to 0.94289, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.1753 - acc: 0.9362 - val_loss: 0.1780 - val_acc: 0.9432

Epoch 00003: val_acc improved from 0.94289 to 0.94316, saving model to unn_grid.h5
Epoch 4/1000
 - 19s - loss: 0.1659 - acc: 0.9371 - val_loss: 0.1719 - val_acc: 0.9426

Epoch 00004: val_acc did not improve from 0.94316
Epoch 5/1000
 - 19s - loss: 0.1602 - acc: 0.9372 - val_loss: 0.1553 - val_acc: 0.9433

Epoch 00005: val_acc improved from 0.94316 to 0.94326, saving model to unn_grid.h5
Epoch 6/1000
 - 19s - loss: 0.1547 - acc: 0.9379 - val_loss: 0.1614 - val_acc: 0.9468

Epoch 00006: val_acc improved from 0.94326 to 0.94678, saving model to unn_grid.h5
Epoch 7/1000
 - 19s - loss: 0.1516 - acc: 0.9389 - val_loss: 0.1745 - val_acc: 0.9497

Epoch 00007: val_acc improved from 0.94678 to 0.94966, saving model to unn_grid.h5
Epoch 8/1000
 - 19s - loss: 0.1451 - acc: 0.9434 - val_loss: 0.1399 - val_acc: 0.9486

Epoch 00008: val_acc did not improve from 0.94966
Epoch 9/1000
 - 19s - loss: 0.1374 - acc: 0.9488 - val_loss: 0.1464 - val_acc: 0.9502

Epoch 00009: val_acc improved from 0.94966 to 0.95019, saving model to unn_grid.h5
Epoch 10/1000
 - 19s - loss: 0.1330 - acc: 0.9517 - val_loss: 0.1345 - val_acc: 0.9552

Epoch 00010: val_acc improved from 0.95019 to 0.95517, saving model to unn_grid.h5
Epoch 11/1000
 - 19s - loss: 0.1250 - acc: 0.9545 - val_loss: 0.1241 - val_acc: 0.9556

Epoch 00011: val_acc improved from 0.95517 to 0.95555, saving model to unn_grid.h5
Epoch 12/1000
 - 19s - loss: 0.1175 - acc: 0.9568 - val_loss: 0.1189 - val_acc: 0.9568

Epoch 00012: val_acc improved from 0.95555 to 0.95685, saving model to unn_grid.h5
Epoch 13/1000
 - 19s - loss: 0.1070 - acc: 0.9614 - val_loss: 0.1127 - val_acc: 0.9599

Epoch 00013: val_acc improved from 0.95685 to 0.95993, saving model to unn_grid.h5
Epoch 14/1000
 - 19s - loss: 0.1026 - acc: 0.9643 - val_loss: 0.1075 - val_acc: 0.9609

Epoch 00014: val_acc improved from 0.95993 to 0.96089, saving model to unn_grid.h5
Epoch 15/1000
 - 19s - loss: 0.0942 - acc: 0.9659 - val_loss: 0.0987 - val_acc: 0.9646

Epoch 00015: val_acc improved from 0.96089 to 0.96457, saving model to unn_grid.h5
Epoch 16/1000
 - 19s - loss: 0.0885 - acc: 0.9678 - val_loss: 0.1089 - val_acc: 0.9591

Epoch 00016: val_acc did not improve from 0.96457
Epoch 17/1000
 - 19s - loss: 0.0820 - acc: 0.9701 - val_loss: 0.1142 - val_acc: 0.9592

Epoch 00017: val_acc did not improve from 0.96457
Epoch 18/1000
 - 19s - loss: 0.0779 - acc: 0.9714 - val_loss: 0.1078 - val_acc: 0.9615

Epoch 00018: val_acc did not improve from 0.96457

Epoch 00018: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 19/1000
 - 19s - loss: 0.0647 - acc: 0.9758 - val_loss: 0.0959 - val_acc: 0.9649

Epoch 00019: val_acc improved from 0.96457 to 0.96495, saving model to unn_grid.h5
Epoch 20/1000
 - 19s - loss: 0.0623 - acc: 0.9762 - val_loss: 0.0975 - val_acc: 0.9655

Epoch 00020: val_acc improved from 0.96495 to 0.96550, saving model to unn_grid.h5
Epoch 21/1000
 - 19s - loss: 0.0608 - acc: 0.9769 - val_loss: 0.0939 - val_acc: 0.9672

Epoch 00021: val_acc improved from 0.96550 to 0.96716, saving model to unn_grid.h5
Epoch 22/1000
 - 19s - loss: 0.0603 - acc: 0.9772 - val_loss: 0.0972 - val_acc: 0.9650

Epoch 00022: val_acc did not improve from 0.96716
Epoch 23/1000
 - 19s - loss: 0.0592 - acc: 0.9775 - val_loss: 0.0978 - val_acc: 0.9656

Epoch 00023: val_acc did not improve from 0.96716
Epoch 24/1000
 - 19s - loss: 0.0584 - acc: 0.9778 - val_loss: 0.0955 - val_acc: 0.9656

Epoch 00024: val_acc did not improve from 0.96716

Epoch 00024: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 25/1000
 - 19s - loss: 0.0564 - acc: 0.9785 - val_loss: 0.0965 - val_acc: 0.9656

Epoch 00025: val_acc did not improve from 0.96716
Epoch 26/1000
 - 19s - loss: 0.0562 - acc: 0.9785 - val_loss: 0.0974 - val_acc: 0.9655

Epoch 00026: val_acc did not improve from 0.96716
Epoch 00026: early stopping
Model: "model_13"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_13 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_229 (Conv2D)             (None, 256, 256, 32) 320         input_13[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_265 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_229[0][0]                 
__________________________________________________________________________________________________
conv2d_230 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_265[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_266 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_230[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_49 (MaxPooling2D) (None, 128, 128, 32) 0           leaky_re_lu_266[0][0]            
__________________________________________________________________________________________________
dropout_109 (Dropout)           (None, 128, 128, 32) 0           max_pooling2d_49[0][0]           
__________________________________________________________________________________________________
conv2d_231 (Conv2D)             (None, 128, 128, 64) 18496       dropout_109[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_267 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_231[0][0]                 
__________________________________________________________________________________________________
conv2d_232 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_267[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_268 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_232[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_50 (MaxPooling2D) (None, 64, 64, 64)   0           leaky_re_lu_268[0][0]            
__________________________________________________________________________________________________
dropout_110 (Dropout)           (None, 64, 64, 64)   0           max_pooling2d_50[0][0]           
__________________________________________________________________________________________________
conv2d_233 (Conv2D)             (None, 64, 64, 128)  73856       dropout_110[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_269 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_233[0][0]                 
__________________________________________________________________________________________________
conv2d_234 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_269[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_270 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_234[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_51 (MaxPooling2D) (None, 32, 32, 128)  0           leaky_re_lu_270[0][0]            
__________________________________________________________________________________________________
dropout_111 (Dropout)           (None, 32, 32, 128)  0           max_pooling2d_51[0][0]           
__________________________________________________________________________________________________
conv2d_235 (Conv2D)             (None, 32, 32, 256)  295168      dropout_111[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_271 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_235[0][0]                 
__________________________________________________________________________________________________
conv2d_236 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_271[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_272 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_236[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_52 (MaxPooling2D) (None, 16, 16, 256)  0           leaky_re_lu_272[0][0]            
__________________________________________________________________________________________________
dropout_112 (Dropout)           (None, 16, 16, 256)  0           max_pooling2d_52[0][0]           
__________________________________________________________________________________________________
conv2d_237 (Conv2D)             (None, 16, 16, 512)  1180160     dropout_112[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_273 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_237[0][0]                 
__________________________________________________________________________________________________
conv2d_238 (Conv2D)             (None, 16, 16, 512)  2359808     leaky_re_lu_273[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_274 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_238[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_49 (Conv2DTran (None, 32, 32, 256)  1179904     leaky_re_lu_274[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_275 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_transpose_49[0][0]        
__________________________________________________________________________________________________
concatenate_49 (Concatenate)    (None, 32, 32, 512)  0           leaky_re_lu_275[0][0]            
                                                                 leaky_re_lu_272[0][0]            
__________________________________________________________________________________________________
dropout_113 (Dropout)           (None, 32, 32, 512)  0           concatenate_49[0][0]             
__________________________________________________________________________________________________
conv2d_239 (Conv2D)             (None, 32, 32, 256)  1179904     dropout_113[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_276 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_239[0][0]                 
__________________________________________________________________________________________________
conv2d_240 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_276[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_277 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_240[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_50 (Conv2DTran (None, 64, 64, 128)  295040      leaky_re_lu_277[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_278 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_50[0][0]        
__________________________________________________________________________________________________
concatenate_50 (Concatenate)    (None, 64, 64, 256)  0           leaky_re_lu_278[0][0]            
                                                                 leaky_re_lu_270[0][0]            
__________________________________________________________________________________________________
dropout_114 (Dropout)           (None, 64, 64, 256)  0           concatenate_50[0][0]             
__________________________________________________________________________________________________
conv2d_241 (Conv2D)             (None, 64, 64, 128)  295040      dropout_114[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_279 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_241[0][0]                 
__________________________________________________________________________________________________
conv2d_242 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_279[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_280 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_242[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_51 (Conv2DTran (None, 128, 128, 64) 73792       leaky_re_lu_280[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_281 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_51[0][0]        
__________________________________________________________________________________________________
concatenate_51 (Concatenate)    (None, 128, 128, 128 0           leaky_re_lu_281[0][0]            
                                                                 leaky_re_lu_268[0][0]            
__________________________________________________________________________________________________
dropout_115 (Dropout)           (None, 128, 128, 128 0           concatenate_51[0][0]             
__________________________________________________________________________________________________
conv2d_243 (Conv2D)             (None, 128, 128, 64) 73792       dropout_115[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_282 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_243[0][0]                 
__________________________________________________________________________________________________
conv2d_244 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_282[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_283 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_244[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_52 (Conv2DTran (None, 256, 256, 32) 18464       leaky_re_lu_283[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_284 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_52[0][0]        
__________________________________________________________________________________________________
concatenate_52 (Concatenate)    (None, 256, 256, 64) 0           leaky_re_lu_284[0][0]            
                                                                 leaky_re_lu_266[0][0]            
__________________________________________________________________________________________________
dropout_116 (Dropout)           (None, 256, 256, 64) 0           concatenate_52[0][0]             
__________________________________________________________________________________________________
dropout_117 (Dropout)           (None, 256, 256, 64) 0           dropout_116[0][0]                
__________________________________________________________________________________________________
conv2d_245 (Conv2D)             (None, 256, 256, 32) 18464       dropout_117[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_285 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_245[0][0]                 
__________________________________________________________________________________________________
conv2d_246 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_285[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_286 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_246[0][0]                 
__________________________________________________________________________________________________
conv2d_247 (Conv2D)             (None, 256, 256, 3)  99          leaky_re_lu_286[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 0.4383 - acc: 0.9177 - val_loss: 0.2171 - val_acc: 0.9421

Epoch 00001: val_acc improved from -inf to 0.94208, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.2108 - acc: 0.9287 - val_loss: 0.1824 - val_acc: 0.9429

Epoch 00002: val_acc improved from 0.94208 to 0.94295, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.1928 - acc: 0.9293 - val_loss: 0.1618 - val_acc: 0.9433

Epoch 00003: val_acc improved from 0.94295 to 0.94328, saving model to unn_grid.h5
Epoch 4/1000
 - 19s - loss: 0.1815 - acc: 0.9295 - val_loss: 0.1874 - val_acc: 0.9429

Epoch 00004: val_acc did not improve from 0.94328
Epoch 5/1000
 - 19s - loss: 0.1764 - acc: 0.9297 - val_loss: 0.1622 - val_acc: 0.9433

Epoch 00005: val_acc did not improve from 0.94328
Epoch 6/1000
 - 19s - loss: 0.1682 - acc: 0.9301 - val_loss: 0.1652 - val_acc: 0.9440

Epoch 00006: val_acc improved from 0.94328 to 0.94396, saving model to unn_grid.h5
Epoch 7/1000
 - 19s - loss: 0.1569 - acc: 0.9359 - val_loss: 0.1351 - val_acc: 0.9485

Epoch 00007: val_acc improved from 0.94396 to 0.94848, saving model to unn_grid.h5
Epoch 8/1000
 - 19s - loss: 0.1485 - acc: 0.9437 - val_loss: 0.1327 - val_acc: 0.9508

Epoch 00008: val_acc improved from 0.94848 to 0.95077, saving model to unn_grid.h5
Epoch 9/1000
 - 19s - loss: 0.1347 - acc: 0.9485 - val_loss: 0.1398 - val_acc: 0.9511

Epoch 00009: val_acc improved from 0.95077 to 0.95107, saving model to unn_grid.h5
Epoch 10/1000
 - 19s - loss: 0.1255 - acc: 0.9531 - val_loss: 0.1076 - val_acc: 0.9605

Epoch 00010: val_acc improved from 0.95107 to 0.96050, saving model to unn_grid.h5
Epoch 11/1000
 - 19s - loss: 0.1142 - acc: 0.9580 - val_loss: 0.1088 - val_acc: 0.9598

Epoch 00011: val_acc did not improve from 0.96050
Epoch 12/1000
 - 19s - loss: 0.1075 - acc: 0.9600 - val_loss: 0.1091 - val_acc: 0.9624

Epoch 00012: val_acc improved from 0.96050 to 0.96244, saving model to unn_grid.h5
Epoch 13/1000
 - 19s - loss: 0.1048 - acc: 0.9618 - val_loss: 0.0997 - val_acc: 0.9622

Epoch 00013: val_acc did not improve from 0.96244
Epoch 14/1000
 - 19s - loss: 0.0940 - acc: 0.9654 - val_loss: 0.1260 - val_acc: 0.9586

Epoch 00014: val_acc did not improve from 0.96244
Epoch 15/1000
 - 19s - loss: 0.0902 - acc: 0.9668 - val_loss: 0.1050 - val_acc: 0.9633

Epoch 00015: val_acc improved from 0.96244 to 0.96326, saving model to unn_grid.h5
Epoch 16/1000
 - 19s - loss: 0.0864 - acc: 0.9684 - val_loss: 0.1127 - val_acc: 0.9603

Epoch 00016: val_acc did not improve from 0.96326
Epoch 17/1000
 - 19s - loss: 0.0802 - acc: 0.9706 - val_loss: 0.1091 - val_acc: 0.9605

Epoch 00017: val_acc did not improve from 0.96326
Epoch 18/1000
 - 19s - loss: 0.0769 - acc: 0.9715 - val_loss: 0.0935 - val_acc: 0.9644

Epoch 00018: val_acc improved from 0.96326 to 0.96440, saving model to unn_grid.h5
Epoch 19/1000
 - 19s - loss: 0.0718 - acc: 0.9733 - val_loss: 0.0965 - val_acc: 0.9655

Epoch 00019: val_acc improved from 0.96440 to 0.96546, saving model to unn_grid.h5
Epoch 20/1000
 - 19s - loss: 0.0695 - acc: 0.9743 - val_loss: 0.0931 - val_acc: 0.9662

Epoch 00020: val_acc improved from 0.96546 to 0.96621, saving model to unn_grid.h5
Epoch 21/1000
 - 19s - loss: 0.0666 - acc: 0.9753 - val_loss: 0.1043 - val_acc: 0.9649

Epoch 00021: val_acc did not improve from 0.96621
Epoch 22/1000
 - 19s - loss: 0.0637 - acc: 0.9759 - val_loss: 0.0910 - val_acc: 0.9654

Epoch 00022: val_acc did not improve from 0.96621
Epoch 23/1000
 - 19s - loss: 0.0588 - acc: 0.9776 - val_loss: 0.0974 - val_acc: 0.9666

Epoch 00023: val_acc improved from 0.96621 to 0.96658, saving model to unn_grid.h5
Epoch 24/1000
 - 19s - loss: 0.0581 - acc: 0.9781 - val_loss: 0.1269 - val_acc: 0.9600

Epoch 00024: val_acc did not improve from 0.96658
Epoch 25/1000
 - 19s - loss: 0.0551 - acc: 0.9793 - val_loss: 0.1044 - val_acc: 0.9641

Epoch 00025: val_acc did not improve from 0.96658
Epoch 26/1000
 - 19s - loss: 0.0563 - acc: 0.9790 - val_loss: 0.0968 - val_acc: 0.9642

Epoch 00026: val_acc did not improve from 0.96658

Epoch 00026: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 27/1000
 - 19s - loss: 0.0462 - acc: 0.9823 - val_loss: 0.1036 - val_acc: 0.9665

Epoch 00027: val_acc did not improve from 0.96658
Epoch 28/1000
 - 19s - loss: 0.0430 - acc: 0.9834 - val_loss: 0.1044 - val_acc: 0.9669

Epoch 00028: val_acc improved from 0.96658 to 0.96688, saving model to unn_grid.h5
Epoch 29/1000
 - 19s - loss: 0.0410 - acc: 0.9840 - val_loss: 0.1050 - val_acc: 0.9672

Epoch 00029: val_acc improved from 0.96688 to 0.96725, saving model to unn_grid.h5
Epoch 30/1000
 - 19s - loss: 0.0405 - acc: 0.9843 - val_loss: 0.1096 - val_acc: 0.9658

Epoch 00030: val_acc did not improve from 0.96725
Epoch 31/1000
 - 19s - loss: 0.0395 - acc: 0.9846 - val_loss: 0.1047 - val_acc: 0.9666

Epoch 00031: val_acc did not improve from 0.96725
Epoch 32/1000
 - 19s - loss: 0.0391 - acc: 0.9848 - val_loss: 0.1038 - val_acc: 0.9670

Epoch 00032: val_acc did not improve from 0.96725

Epoch 00032: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 33/1000
 - 19s - loss: 0.0377 - acc: 0.9853 - val_loss: 0.1073 - val_acc: 0.9670

Epoch 00033: val_acc did not improve from 0.96725
Epoch 34/1000
 - 19s - loss: 0.0376 - acc: 0.9854 - val_loss: 0.1085 - val_acc: 0.9668

Epoch 00034: val_acc did not improve from 0.96725
Epoch 00034: early stopping
Model: "model_14"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_14 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_248 (Conv2D)             (None, 256, 256, 32) 320         input_14[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_287 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_248[0][0]                 
__________________________________________________________________________________________________
conv2d_249 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_287[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_288 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_249[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_53 (MaxPooling2D) (None, 128, 128, 32) 0           leaky_re_lu_288[0][0]            
__________________________________________________________________________________________________
dropout_118 (Dropout)           (None, 128, 128, 32) 0           max_pooling2d_53[0][0]           
__________________________________________________________________________________________________
conv2d_250 (Conv2D)             (None, 128, 128, 64) 18496       dropout_118[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_289 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_250[0][0]                 
__________________________________________________________________________________________________
conv2d_251 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_289[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_290 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_251[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_54 (MaxPooling2D) (None, 64, 64, 64)   0           leaky_re_lu_290[0][0]            
__________________________________________________________________________________________________
dropout_119 (Dropout)           (None, 64, 64, 64)   0           max_pooling2d_54[0][0]           
__________________________________________________________________________________________________
conv2d_252 (Conv2D)             (None, 64, 64, 128)  73856       dropout_119[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_291 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_252[0][0]                 
__________________________________________________________________________________________________
conv2d_253 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_291[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_292 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_253[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_55 (MaxPooling2D) (None, 32, 32, 128)  0           leaky_re_lu_292[0][0]            
__________________________________________________________________________________________________
dropout_120 (Dropout)           (None, 32, 32, 128)  0           max_pooling2d_55[0][0]           
__________________________________________________________________________________________________
conv2d_254 (Conv2D)             (None, 32, 32, 256)  295168      dropout_120[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_293 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_254[0][0]                 
__________________________________________________________________________________________________
conv2d_255 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_293[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_294 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_255[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_56 (MaxPooling2D) (None, 16, 16, 256)  0           leaky_re_lu_294[0][0]            
__________________________________________________________________________________________________
dropout_121 (Dropout)           (None, 16, 16, 256)  0           max_pooling2d_56[0][0]           
__________________________________________________________________________________________________
conv2d_256 (Conv2D)             (None, 16, 16, 512)  1180160     dropout_121[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_295 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_256[0][0]                 
__________________________________________________________________________________________________
conv2d_257 (Conv2D)             (None, 16, 16, 512)  2359808     leaky_re_lu_295[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_296 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_257[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_53 (Conv2DTran (None, 32, 32, 256)  1179904     leaky_re_lu_296[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_297 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_transpose_53[0][0]        
__________________________________________________________________________________________________
concatenate_53 (Concatenate)    (None, 32, 32, 512)  0           leaky_re_lu_297[0][0]            
                                                                 leaky_re_lu_294[0][0]            
__________________________________________________________________________________________________
dropout_122 (Dropout)           (None, 32, 32, 512)  0           concatenate_53[0][0]             
__________________________________________________________________________________________________
conv2d_258 (Conv2D)             (None, 32, 32, 256)  1179904     dropout_122[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_298 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_258[0][0]                 
__________________________________________________________________________________________________
conv2d_259 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_298[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_299 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_259[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_54 (Conv2DTran (None, 64, 64, 128)  295040      leaky_re_lu_299[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_300 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_54[0][0]        
__________________________________________________________________________________________________
concatenate_54 (Concatenate)    (None, 64, 64, 256)  0           leaky_re_lu_300[0][0]            
                                                                 leaky_re_lu_292[0][0]            
__________________________________________________________________________________________________
dropout_123 (Dropout)           (None, 64, 64, 256)  0           concatenate_54[0][0]             
__________________________________________________________________________________________________
conv2d_260 (Conv2D)             (None, 64, 64, 128)  295040      dropout_123[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_301 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_260[0][0]                 
__________________________________________________________________________________________________
conv2d_261 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_301[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_302 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_261[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_55 (Conv2DTran (None, 128, 128, 64) 73792       leaky_re_lu_302[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_303 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_55[0][0]        
__________________________________________________________________________________________________
concatenate_55 (Concatenate)    (None, 128, 128, 128 0           leaky_re_lu_303[0][0]            
                                                                 leaky_re_lu_290[0][0]            
__________________________________________________________________________________________________
dropout_124 (Dropout)           (None, 128, 128, 128 0           concatenate_55[0][0]             
__________________________________________________________________________________________________
conv2d_262 (Conv2D)             (None, 128, 128, 64) 73792       dropout_124[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_304 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_262[0][0]                 
__________________________________________________________________________________________________
conv2d_263 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_304[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_305 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_263[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_56 (Conv2DTran (None, 256, 256, 32) 18464       leaky_re_lu_305[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_306 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_56[0][0]        
__________________________________________________________________________________________________
concatenate_56 (Concatenate)    (None, 256, 256, 64) 0           leaky_re_lu_306[0][0]            
                                                                 leaky_re_lu_288[0][0]            
__________________________________________________________________________________________________
dropout_125 (Dropout)           (None, 256, 256, 64) 0           concatenate_56[0][0]             
__________________________________________________________________________________________________
dropout_126 (Dropout)           (None, 256, 256, 64) 0           dropout_125[0][0]                
__________________________________________________________________________________________________
conv2d_264 (Conv2D)             (None, 256, 256, 32) 18464       dropout_126[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_307 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_264[0][0]                 
__________________________________________________________________________________________________
conv2d_265 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_307[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_308 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_265[0][0]                 
__________________________________________________________________________________________________
conv2d_266 (Conv2D)             (None, 256, 256, 3)  99          leaky_re_lu_308[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 0.5033 - acc: 0.9314 - val_loss: 0.2521 - val_acc: 0.9432

Epoch 00001: val_acc improved from -inf to 0.94318, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.2213 - acc: 0.9369 - val_loss: 0.2252 - val_acc: 0.9432

Epoch 00002: val_acc improved from 0.94318 to 0.94319, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.1785 - acc: 0.9375 - val_loss: 0.1688 - val_acc: 0.9432

Epoch 00003: val_acc improved from 0.94319 to 0.94321, saving model to unn_grid.h5
Epoch 4/1000
 - 19s - loss: 0.1702 - acc: 0.9375 - val_loss: 0.1774 - val_acc: 0.9433

Epoch 00004: val_acc improved from 0.94321 to 0.94329, saving model to unn_grid.h5
Epoch 5/1000
 - 19s - loss: 0.1627 - acc: 0.9378 - val_loss: 0.1441 - val_acc: 0.9434

Epoch 00005: val_acc improved from 0.94329 to 0.94335, saving model to unn_grid.h5
Epoch 6/1000
 - 19s - loss: 0.1510 - acc: 0.9430 - val_loss: 0.1356 - val_acc: 0.9457

Epoch 00006: val_acc improved from 0.94335 to 0.94568, saving model to unn_grid.h5
Epoch 7/1000
 - 19s - loss: 0.1431 - acc: 0.9474 - val_loss: 0.1810 - val_acc: 0.9313

Epoch 00007: val_acc did not improve from 0.94568
Epoch 8/1000
 - 19s - loss: 0.1393 - acc: 0.9481 - val_loss: 0.1386 - val_acc: 0.9514

Epoch 00008: val_acc improved from 0.94568 to 0.95135, saving model to unn_grid.h5
Epoch 9/1000
 - 19s - loss: 0.1279 - acc: 0.9536 - val_loss: 0.1258 - val_acc: 0.9551

Epoch 00009: val_acc improved from 0.95135 to 0.95513, saving model to unn_grid.h5
Epoch 10/1000
 - 19s - loss: 0.1194 - acc: 0.9565 - val_loss: 0.1638 - val_acc: 0.9448

Epoch 00010: val_acc did not improve from 0.95513
Epoch 11/1000
 - 19s - loss: 0.1104 - acc: 0.9596 - val_loss: 0.1249 - val_acc: 0.9530

Epoch 00011: val_acc did not improve from 0.95513
Epoch 12/1000
 - 19s - loss: 0.1054 - acc: 0.9611 - val_loss: 0.1126 - val_acc: 0.9572

Epoch 00012: val_acc improved from 0.95513 to 0.95722, saving model to unn_grid.h5
Epoch 13/1000
 - 19s - loss: 0.1024 - acc: 0.9628 - val_loss: 0.1086 - val_acc: 0.9596

Epoch 00013: val_acc improved from 0.95722 to 0.95957, saving model to unn_grid.h5
Epoch 14/1000
 - 19s - loss: 0.0930 - acc: 0.9668 - val_loss: 0.1139 - val_acc: 0.9590

Epoch 00014: val_acc did not improve from 0.95957
Epoch 15/1000
 - 19s - loss: 0.0867 - acc: 0.9684 - val_loss: 0.1153 - val_acc: 0.9600

Epoch 00015: val_acc improved from 0.95957 to 0.96003, saving model to unn_grid.h5
Epoch 16/1000
 - 19s - loss: 0.0822 - acc: 0.9696 - val_loss: 0.1229 - val_acc: 0.9571

Epoch 00016: val_acc did not improve from 0.96003
Epoch 17/1000
 - 19s - loss: 0.0779 - acc: 0.9712 - val_loss: 0.1180 - val_acc: 0.9553

Epoch 00017: val_acc did not improve from 0.96003
Epoch 18/1000
 - 19s - loss: 0.0752 - acc: 0.9721 - val_loss: 0.0987 - val_acc: 0.9641

Epoch 00018: val_acc improved from 0.96003 to 0.96411, saving model to unn_grid.h5
Epoch 19/1000
 - 19s - loss: 0.0707 - acc: 0.9736 - val_loss: 0.1167 - val_acc: 0.9607

Epoch 00019: val_acc did not improve from 0.96411
Epoch 20/1000
 - 19s - loss: 0.0681 - acc: 0.9745 - val_loss: 0.1080 - val_acc: 0.9632

Epoch 00020: val_acc did not improve from 0.96411
Epoch 21/1000
 - 19s - loss: 0.0644 - acc: 0.9759 - val_loss: 0.1001 - val_acc: 0.9650

Epoch 00021: val_acc improved from 0.96411 to 0.96501, saving model to unn_grid.h5
Epoch 22/1000
 - 19s - loss: 0.0618 - acc: 0.9767 - val_loss: 0.0957 - val_acc: 0.9676

Epoch 00022: val_acc improved from 0.96501 to 0.96764, saving model to unn_grid.h5
Epoch 23/1000
 - 19s - loss: 0.0593 - acc: 0.9778 - val_loss: 0.1070 - val_acc: 0.9651

Epoch 00023: val_acc did not improve from 0.96764
Epoch 24/1000
 - 19s - loss: 0.0550 - acc: 0.9790 - val_loss: 0.0930 - val_acc: 0.9680

Epoch 00024: val_acc improved from 0.96764 to 0.96798, saving model to unn_grid.h5
Epoch 25/1000
 - 19s - loss: 0.0542 - acc: 0.9795 - val_loss: 0.1030 - val_acc: 0.9661

Epoch 00025: val_acc did not improve from 0.96798
Epoch 26/1000
 - 19s - loss: 0.0491 - acc: 0.9812 - val_loss: 0.0989 - val_acc: 0.9671

Epoch 00026: val_acc did not improve from 0.96798
Epoch 27/1000
 - 19s - loss: 0.0481 - acc: 0.9816 - val_loss: 0.0967 - val_acc: 0.9685

Epoch 00027: val_acc improved from 0.96798 to 0.96848, saving model to unn_grid.h5
Epoch 28/1000
 - 19s - loss: 0.0468 - acc: 0.9822 - val_loss: 0.1194 - val_acc: 0.9644

Epoch 00028: val_acc did not improve from 0.96848
Epoch 29/1000
 - 19s - loss: 0.0447 - acc: 0.9828 - val_loss: 0.1005 - val_acc: 0.9683

Epoch 00029: val_acc did not improve from 0.96848
Epoch 30/1000
 - 19s - loss: 0.0423 - acc: 0.9837 - val_loss: 0.1053 - val_acc: 0.9670

Epoch 00030: val_acc did not improve from 0.96848

Epoch 00030: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 31/1000
 - 19s - loss: 0.0350 - acc: 0.9864 - val_loss: 0.1078 - val_acc: 0.9687

Epoch 00031: val_acc improved from 0.96848 to 0.96872, saving model to unn_grid.h5
Epoch 32/1000
 - 19s - loss: 0.0322 - acc: 0.9874 - val_loss: 0.1114 - val_acc: 0.9692

Epoch 00032: val_acc improved from 0.96872 to 0.96916, saving model to unn_grid.h5
Epoch 33/1000
 - 19s - loss: 0.0310 - acc: 0.9878 - val_loss: 0.1144 - val_acc: 0.9687

Epoch 00033: val_acc did not improve from 0.96916
Epoch 34/1000
 - 19s - loss: 0.0304 - acc: 0.9880 - val_loss: 0.1152 - val_acc: 0.9693

Epoch 00034: val_acc improved from 0.96916 to 0.96932, saving model to unn_grid.h5
Epoch 35/1000
 - 19s - loss: 0.0301 - acc: 0.9881 - val_loss: 0.1180 - val_acc: 0.9689

Epoch 00035: val_acc did not improve from 0.96932
Epoch 36/1000
 - 19s - loss: 0.0293 - acc: 0.9883 - val_loss: 0.1184 - val_acc: 0.9689

Epoch 00036: val_acc did not improve from 0.96932
Epoch 37/1000
 - 19s - loss: 0.0287 - acc: 0.9886 - val_loss: 0.1190 - val_acc: 0.9686

Epoch 00037: val_acc did not improve from 0.96932

Epoch 00037: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 38/1000
 - 19s - loss: 0.0282 - acc: 0.9888 - val_loss: 0.1197 - val_acc: 0.9689

Epoch 00038: val_acc did not improve from 0.96932
Epoch 39/1000
 - 19s - loss: 0.0278 - acc: 0.9889 - val_loss: 0.1193 - val_acc: 0.9690

Epoch 00039: val_acc did not improve from 0.96932
Epoch 00039: early stopping
Model: "model_15"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_15 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_267 (Conv2D)             (None, 256, 256, 32) 320         input_15[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_309 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_267[0][0]                 
__________________________________________________________________________________________________
conv2d_268 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_309[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_310 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_268[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_57 (MaxPooling2D) (None, 128, 128, 32) 0           leaky_re_lu_310[0][0]            
__________________________________________________________________________________________________
dropout_127 (Dropout)           (None, 128, 128, 32) 0           max_pooling2d_57[0][0]           
__________________________________________________________________________________________________
conv2d_269 (Conv2D)             (None, 128, 128, 64) 18496       dropout_127[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_311 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_269[0][0]                 
__________________________________________________________________________________________________
conv2d_270 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_311[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_312 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_270[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_58 (MaxPooling2D) (None, 64, 64, 64)   0           leaky_re_lu_312[0][0]            
__________________________________________________________________________________________________
dropout_128 (Dropout)           (None, 64, 64, 64)   0           max_pooling2d_58[0][0]           
__________________________________________________________________________________________________
conv2d_271 (Conv2D)             (None, 64, 64, 128)  73856       dropout_128[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_313 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_271[0][0]                 
__________________________________________________________________________________________________
conv2d_272 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_313[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_314 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_272[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_59 (MaxPooling2D) (None, 32, 32, 128)  0           leaky_re_lu_314[0][0]            
__________________________________________________________________________________________________
dropout_129 (Dropout)           (None, 32, 32, 128)  0           max_pooling2d_59[0][0]           
__________________________________________________________________________________________________
conv2d_273 (Conv2D)             (None, 32, 32, 256)  295168      dropout_129[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_315 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_273[0][0]                 
__________________________________________________________________________________________________
conv2d_274 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_315[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_316 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_274[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_60 (MaxPooling2D) (None, 16, 16, 256)  0           leaky_re_lu_316[0][0]            
__________________________________________________________________________________________________
dropout_130 (Dropout)           (None, 16, 16, 256)  0           max_pooling2d_60[0][0]           
__________________________________________________________________________________________________
conv2d_275 (Conv2D)             (None, 16, 16, 512)  1180160     dropout_130[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_317 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_275[0][0]                 
__________________________________________________________________________________________________
conv2d_276 (Conv2D)             (None, 16, 16, 512)  2359808     leaky_re_lu_317[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_318 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_276[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_57 (Conv2DTran (None, 32, 32, 256)  1179904     leaky_re_lu_318[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_319 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_transpose_57[0][0]        
__________________________________________________________________________________________________
concatenate_57 (Concatenate)    (None, 32, 32, 512)  0           leaky_re_lu_319[0][0]            
                                                                 leaky_re_lu_316[0][0]            
__________________________________________________________________________________________________
dropout_131 (Dropout)           (None, 32, 32, 512)  0           concatenate_57[0][0]             
__________________________________________________________________________________________________
conv2d_277 (Conv2D)             (None, 32, 32, 256)  1179904     dropout_131[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_320 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_277[0][0]                 
__________________________________________________________________________________________________
conv2d_278 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_320[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_321 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_278[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_58 (Conv2DTran (None, 64, 64, 128)  295040      leaky_re_lu_321[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_322 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_58[0][0]        
__________________________________________________________________________________________________
concatenate_58 (Concatenate)    (None, 64, 64, 256)  0           leaky_re_lu_322[0][0]            
                                                                 leaky_re_lu_314[0][0]            
__________________________________________________________________________________________________
dropout_132 (Dropout)           (None, 64, 64, 256)  0           concatenate_58[0][0]             
__________________________________________________________________________________________________
conv2d_279 (Conv2D)             (None, 64, 64, 128)  295040      dropout_132[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_323 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_279[0][0]                 
__________________________________________________________________________________________________
conv2d_280 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_323[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_324 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_280[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_59 (Conv2DTran (None, 128, 128, 64) 73792       leaky_re_lu_324[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_325 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_59[0][0]        
__________________________________________________________________________________________________
concatenate_59 (Concatenate)    (None, 128, 128, 128 0           leaky_re_lu_325[0][0]            
                                                                 leaky_re_lu_312[0][0]            
__________________________________________________________________________________________________
dropout_133 (Dropout)           (None, 128, 128, 128 0           concatenate_59[0][0]             
__________________________________________________________________________________________________
conv2d_281 (Conv2D)             (None, 128, 128, 64) 73792       dropout_133[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_326 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_281[0][0]                 
__________________________________________________________________________________________________
conv2d_282 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_326[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_327 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_282[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_60 (Conv2DTran (None, 256, 256, 32) 18464       leaky_re_lu_327[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_328 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_60[0][0]        
__________________________________________________________________________________________________
concatenate_60 (Concatenate)    (None, 256, 256, 64) 0           leaky_re_lu_328[0][0]            
                                                                 leaky_re_lu_310[0][0]            
__________________________________________________________________________________________________
dropout_134 (Dropout)           (None, 256, 256, 64) 0           concatenate_60[0][0]             
__________________________________________________________________________________________________
dropout_135 (Dropout)           (None, 256, 256, 64) 0           dropout_134[0][0]                
__________________________________________________________________________________________________
conv2d_283 (Conv2D)             (None, 256, 256, 32) 18464       dropout_135[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_329 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_283[0][0]                 
__________________________________________________________________________________________________
conv2d_284 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_329[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_330 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_284[0][0]                 
__________________________________________________________________________________________________
conv2d_285 (Conv2D)             (None, 256, 256, 3)  99          leaky_re_lu_330[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1213 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 0.6204 - acc: 0.9165 - val_loss: 0.2615 - val_acc: 0.9117

Epoch 00001: val_acc improved from -inf to 0.91168, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.2086 - acc: 0.9377 - val_loss: 0.2437 - val_acc: 0.9134

Epoch 00002: val_acc improved from 0.91168 to 0.91338, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.1804 - acc: 0.9400 - val_loss: 0.3037 - val_acc: 0.9134

Epoch 00003: val_acc improved from 0.91338 to 0.91344, saving model to unn_grid.h5
Epoch 4/1000
 - 19s - loss: 0.1695 - acc: 0.9403 - val_loss: 0.2245 - val_acc: 0.9135

Epoch 00004: val_acc improved from 0.91344 to 0.91348, saving model to unn_grid.h5
Epoch 5/1000
 - 19s - loss: 0.1628 - acc: 0.9404 - val_loss: 0.2132 - val_acc: 0.9135

Epoch 00005: val_acc improved from 0.91348 to 0.91348, saving model to unn_grid.h5

Epoch 00005: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 6/1000
 - 19s - loss: 0.1525 - acc: 0.9406 - val_loss: 0.2031 - val_acc: 0.9135

Epoch 00006: val_acc did not improve from 0.91348
Epoch 7/1000
 - 19s - loss: 0.1494 - acc: 0.9407 - val_loss: 0.2098 - val_acc: 0.9125

Epoch 00007: val_acc did not improve from 0.91348
Epoch 8/1000
 - 19s - loss: 0.1479 - acc: 0.9410 - val_loss: 0.2153 - val_acc: 0.9111

Epoch 00008: val_acc did not improve from 0.91348

Epoch 00008: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 9/1000
 - 19s - loss: 0.1462 - acc: 0.9413 - val_loss: 0.2060 - val_acc: 0.9124

Epoch 00009: val_acc did not improve from 0.91348
Epoch 10/1000
 - 19s - loss: 0.1459 - acc: 0.9414 - val_loss: 0.2034 - val_acc: 0.9127

Epoch 00010: val_acc did not improve from 0.91348
Epoch 00010: early stopping
scores= [[0.94593302 0.45337382 0.40869075]
 [0.93582602 0.33330832 0.3119443 ]
 [0.95986734 0.64962314 0.57892187]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]] parameters= (32, 'Adam', 0.35, 'glorot_uniform', 0.0001)
Model: "model_16"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_16 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_286 (Conv2D)             (None, 256, 256, 32) 320         input_16[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_331 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_286[0][0]                 
__________________________________________________________________________________________________
conv2d_287 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_331[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_332 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_287[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_61 (MaxPooling2D) (None, 128, 128, 32) 0           leaky_re_lu_332[0][0]            
__________________________________________________________________________________________________
dropout_136 (Dropout)           (None, 128, 128, 32) 0           max_pooling2d_61[0][0]           
__________________________________________________________________________________________________
conv2d_288 (Conv2D)             (None, 128, 128, 64) 18496       dropout_136[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_333 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_288[0][0]                 
__________________________________________________________________________________________________
conv2d_289 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_333[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_334 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_289[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_62 (MaxPooling2D) (None, 64, 64, 64)   0           leaky_re_lu_334[0][0]            
__________________________________________________________________________________________________
dropout_137 (Dropout)           (None, 64, 64, 64)   0           max_pooling2d_62[0][0]           
__________________________________________________________________________________________________
conv2d_290 (Conv2D)             (None, 64, 64, 128)  73856       dropout_137[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_335 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_290[0][0]                 
__________________________________________________________________________________________________
conv2d_291 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_335[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_336 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_291[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_63 (MaxPooling2D) (None, 32, 32, 128)  0           leaky_re_lu_336[0][0]            
__________________________________________________________________________________________________
dropout_138 (Dropout)           (None, 32, 32, 128)  0           max_pooling2d_63[0][0]           
__________________________________________________________________________________________________
conv2d_292 (Conv2D)             (None, 32, 32, 256)  295168      dropout_138[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_337 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_292[0][0]                 
__________________________________________________________________________________________________
conv2d_293 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_337[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_338 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_293[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_64 (MaxPooling2D) (None, 16, 16, 256)  0           leaky_re_lu_338[0][0]            
__________________________________________________________________________________________________
dropout_139 (Dropout)           (None, 16, 16, 256)  0           max_pooling2d_64[0][0]           
__________________________________________________________________________________________________
conv2d_294 (Conv2D)             (None, 16, 16, 512)  1180160     dropout_139[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_339 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_294[0][0]                 
__________________________________________________________________________________________________
conv2d_295 (Conv2D)             (None, 16, 16, 512)  2359808     leaky_re_lu_339[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_340 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_295[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_61 (Conv2DTran (None, 32, 32, 256)  1179904     leaky_re_lu_340[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_341 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_transpose_61[0][0]        
__________________________________________________________________________________________________
concatenate_61 (Concatenate)    (None, 32, 32, 512)  0           leaky_re_lu_341[0][0]            
                                                                 leaky_re_lu_338[0][0]            
__________________________________________________________________________________________________
dropout_140 (Dropout)           (None, 32, 32, 512)  0           concatenate_61[0][0]             
__________________________________________________________________________________________________
conv2d_296 (Conv2D)             (None, 32, 32, 256)  1179904     dropout_140[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_342 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_296[0][0]                 
__________________________________________________________________________________________________
conv2d_297 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_342[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_343 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_297[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_62 (Conv2DTran (None, 64, 64, 128)  295040      leaky_re_lu_343[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_344 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_62[0][0]        
__________________________________________________________________________________________________
concatenate_62 (Concatenate)    (None, 64, 64, 256)  0           leaky_re_lu_344[0][0]            
                                                                 leaky_re_lu_336[0][0]            
__________________________________________________________________________________________________
dropout_141 (Dropout)           (None, 64, 64, 256)  0           concatenate_62[0][0]             
__________________________________________________________________________________________________
conv2d_298 (Conv2D)             (None, 64, 64, 128)  295040      dropout_141[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_345 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_298[0][0]                 
__________________________________________________________________________________________________
conv2d_299 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_345[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_346 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_299[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_63 (Conv2DTran (None, 128, 128, 64) 73792       leaky_re_lu_346[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_347 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_63[0][0]        
__________________________________________________________________________________________________
concatenate_63 (Concatenate)    (None, 128, 128, 128 0           leaky_re_lu_347[0][0]            
                                                                 leaky_re_lu_334[0][0]            
__________________________________________________________________________________________________
dropout_142 (Dropout)           (None, 128, 128, 128 0           concatenate_63[0][0]             
__________________________________________________________________________________________________
conv2d_300 (Conv2D)             (None, 128, 128, 64) 73792       dropout_142[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_348 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_300[0][0]                 
__________________________________________________________________________________________________
conv2d_301 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_348[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_349 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_301[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_64 (Conv2DTran (None, 256, 256, 32) 18464       leaky_re_lu_349[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_350 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_64[0][0]        
__________________________________________________________________________________________________
concatenate_64 (Concatenate)    (None, 256, 256, 64) 0           leaky_re_lu_350[0][0]            
                                                                 leaky_re_lu_332[0][0]            
__________________________________________________________________________________________________
dropout_143 (Dropout)           (None, 256, 256, 64) 0           concatenate_64[0][0]             
__________________________________________________________________________________________________
dropout_144 (Dropout)           (None, 256, 256, 64) 0           dropout_143[0][0]                
__________________________________________________________________________________________________
conv2d_302 (Conv2D)             (None, 256, 256, 32) 18464       dropout_144[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_351 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_302[0][0]                 
__________________________________________________________________________________________________
conv2d_303 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_351[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_352 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_303[0][0]                 
__________________________________________________________________________________________________
conv2d_304 (Conv2D)             (None, 256, 256, 3)  99          leaky_re_lu_352[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 0.8389 - acc: 0.9181 - val_loss: 0.6778 - val_acc: 0.9432

Epoch 00001: val_acc improved from -inf to 0.94316, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.6170 - acc: 0.9275 - val_loss: 0.5582 - val_acc: 0.9420

Epoch 00002: val_acc did not improve from 0.94316
Epoch 3/1000
 - 19s - loss: 0.5093 - acc: 0.9263 - val_loss: 0.4624 - val_acc: 0.8950

Epoch 00003: val_acc did not improve from 0.94316
Epoch 4/1000
 - 19s - loss: 0.3644 - acc: 0.9206 - val_loss: 0.3603 - val_acc: 0.8831

Epoch 00004: val_acc did not improve from 0.94316

Epoch 00004: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 5/1000
 - 19s - loss: 0.2709 - acc: 0.9226 - val_loss: 0.3694 - val_acc: 0.8730

Epoch 00005: val_acc did not improve from 0.94316
Epoch 6/1000
 - 19s - loss: 0.2628 - acc: 0.9228 - val_loss: 0.3839 - val_acc: 0.8640

Epoch 00006: val_acc did not improve from 0.94316
Epoch 00006: early stopping
Model: "model_17"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_17 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_305 (Conv2D)             (None, 256, 256, 32) 320         input_17[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_353 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_305[0][0]                 
__________________________________________________________________________________________________
conv2d_306 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_353[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_354 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_306[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_65 (MaxPooling2D) (None, 128, 128, 32) 0           leaky_re_lu_354[0][0]            
__________________________________________________________________________________________________
dropout_145 (Dropout)           (None, 128, 128, 32) 0           max_pooling2d_65[0][0]           
__________________________________________________________________________________________________
conv2d_307 (Conv2D)             (None, 128, 128, 64) 18496       dropout_145[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_355 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_307[0][0]                 
__________________________________________________________________________________________________
conv2d_308 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_355[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_356 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_308[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_66 (MaxPooling2D) (None, 64, 64, 64)   0           leaky_re_lu_356[0][0]            
__________________________________________________________________________________________________
dropout_146 (Dropout)           (None, 64, 64, 64)   0           max_pooling2d_66[0][0]           
__________________________________________________________________________________________________
conv2d_309 (Conv2D)             (None, 64, 64, 128)  73856       dropout_146[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_357 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_309[0][0]                 
__________________________________________________________________________________________________
conv2d_310 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_357[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_358 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_310[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_67 (MaxPooling2D) (None, 32, 32, 128)  0           leaky_re_lu_358[0][0]            
__________________________________________________________________________________________________
dropout_147 (Dropout)           (None, 32, 32, 128)  0           max_pooling2d_67[0][0]           
__________________________________________________________________________________________________
conv2d_311 (Conv2D)             (None, 32, 32, 256)  295168      dropout_147[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_359 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_311[0][0]                 
__________________________________________________________________________________________________
conv2d_312 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_359[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_360 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_312[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_68 (MaxPooling2D) (None, 16, 16, 256)  0           leaky_re_lu_360[0][0]            
__________________________________________________________________________________________________
dropout_148 (Dropout)           (None, 16, 16, 256)  0           max_pooling2d_68[0][0]           
__________________________________________________________________________________________________
conv2d_313 (Conv2D)             (None, 16, 16, 512)  1180160     dropout_148[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_361 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_313[0][0]                 
__________________________________________________________________________________________________
conv2d_314 (Conv2D)             (None, 16, 16, 512)  2359808     leaky_re_lu_361[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_362 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_314[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_65 (Conv2DTran (None, 32, 32, 256)  1179904     leaky_re_lu_362[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_363 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_transpose_65[0][0]        
__________________________________________________________________________________________________
concatenate_65 (Concatenate)    (None, 32, 32, 512)  0           leaky_re_lu_363[0][0]            
                                                                 leaky_re_lu_360[0][0]            
__________________________________________________________________________________________________
dropout_149 (Dropout)           (None, 32, 32, 512)  0           concatenate_65[0][0]             
__________________________________________________________________________________________________
conv2d_315 (Conv2D)             (None, 32, 32, 256)  1179904     dropout_149[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_364 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_315[0][0]                 
__________________________________________________________________________________________________
conv2d_316 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_364[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_365 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_316[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_66 (Conv2DTran (None, 64, 64, 128)  295040      leaky_re_lu_365[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_366 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_66[0][0]        
__________________________________________________________________________________________________
concatenate_66 (Concatenate)    (None, 64, 64, 256)  0           leaky_re_lu_366[0][0]            
                                                                 leaky_re_lu_358[0][0]            
__________________________________________________________________________________________________
dropout_150 (Dropout)           (None, 64, 64, 256)  0           concatenate_66[0][0]             
__________________________________________________________________________________________________
conv2d_317 (Conv2D)             (None, 64, 64, 128)  295040      dropout_150[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_367 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_317[0][0]                 
__________________________________________________________________________________________________
conv2d_318 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_367[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_368 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_318[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_67 (Conv2DTran (None, 128, 128, 64) 73792       leaky_re_lu_368[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_369 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_67[0][0]        
__________________________________________________________________________________________________
concatenate_67 (Concatenate)    (None, 128, 128, 128 0           leaky_re_lu_369[0][0]            
                                                                 leaky_re_lu_356[0][0]            
__________________________________________________________________________________________________
dropout_151 (Dropout)           (None, 128, 128, 128 0           concatenate_67[0][0]             
__________________________________________________________________________________________________
conv2d_319 (Conv2D)             (None, 128, 128, 64) 73792       dropout_151[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_370 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_319[0][0]                 
__________________________________________________________________________________________________
conv2d_320 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_370[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_371 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_320[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_68 (Conv2DTran (None, 256, 256, 32) 18464       leaky_re_lu_371[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_372 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_68[0][0]        
__________________________________________________________________________________________________
concatenate_68 (Concatenate)    (None, 256, 256, 64) 0           leaky_re_lu_372[0][0]            
                                                                 leaky_re_lu_354[0][0]            
__________________________________________________________________________________________________
dropout_152 (Dropout)           (None, 256, 256, 64) 0           concatenate_68[0][0]             
__________________________________________________________________________________________________
dropout_153 (Dropout)           (None, 256, 256, 64) 0           dropout_152[0][0]                
__________________________________________________________________________________________________
conv2d_321 (Conv2D)             (None, 256, 256, 32) 18464       dropout_153[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_373 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_321[0][0]                 
__________________________________________________________________________________________________
conv2d_322 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_373[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_374 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_322[0][0]                 
__________________________________________________________________________________________________
conv2d_323 (Conv2D)             (None, 256, 256, 3)  99          leaky_re_lu_374[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 1.1700 - acc: 0.8608 - val_loss: 0.7425 - val_acc: 0.9430

Epoch 00001: val_acc improved from -inf to 0.94296, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.6618 - acc: 0.9294 - val_loss: 0.6306 - val_acc: 0.9433

Epoch 00002: val_acc improved from 0.94296 to 0.94326, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.5437 - acc: 0.9303 - val_loss: 0.5062 - val_acc: 0.9432

Epoch 00003: val_acc did not improve from 0.94326
Epoch 4/1000
 - 19s - loss: 0.4225 - acc: 0.9268 - val_loss: 0.3548 - val_acc: 0.9411

Epoch 00004: val_acc did not improve from 0.94326
Epoch 5/1000
 - 19s - loss: 0.2888 - acc: 0.9265 - val_loss: 0.3223 - val_acc: 0.9377

Epoch 00005: val_acc did not improve from 0.94326

Epoch 00005: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 6/1000
 - 19s - loss: 0.2469 - acc: 0.9294 - val_loss: 0.2971 - val_acc: 0.9387

Epoch 00006: val_acc did not improve from 0.94326
Epoch 7/1000
 - 19s - loss: 0.2419 - acc: 0.9305 - val_loss: 0.3028 - val_acc: 0.9380

Epoch 00007: val_acc did not improve from 0.94326
Epoch 00007: early stopping
Model: "model_18"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_18 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_324 (Conv2D)             (None, 256, 256, 32) 320         input_18[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_375 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_324[0][0]                 
__________________________________________________________________________________________________
conv2d_325 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_375[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_376 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_325[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_69 (MaxPooling2D) (None, 128, 128, 32) 0           leaky_re_lu_376[0][0]            
__________________________________________________________________________________________________
dropout_154 (Dropout)           (None, 128, 128, 32) 0           max_pooling2d_69[0][0]           
__________________________________________________________________________________________________
conv2d_326 (Conv2D)             (None, 128, 128, 64) 18496       dropout_154[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_377 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_326[0][0]                 
__________________________________________________________________________________________________
conv2d_327 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_377[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_378 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_327[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_70 (MaxPooling2D) (None, 64, 64, 64)   0           leaky_re_lu_378[0][0]            
__________________________________________________________________________________________________
dropout_155 (Dropout)           (None, 64, 64, 64)   0           max_pooling2d_70[0][0]           
__________________________________________________________________________________________________
conv2d_328 (Conv2D)             (None, 64, 64, 128)  73856       dropout_155[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_379 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_328[0][0]                 
__________________________________________________________________________________________________
conv2d_329 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_379[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_380 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_329[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_71 (MaxPooling2D) (None, 32, 32, 128)  0           leaky_re_lu_380[0][0]            
__________________________________________________________________________________________________
dropout_156 (Dropout)           (None, 32, 32, 128)  0           max_pooling2d_71[0][0]           
__________________________________________________________________________________________________
conv2d_330 (Conv2D)             (None, 32, 32, 256)  295168      dropout_156[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_381 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_330[0][0]                 
__________________________________________________________________________________________________
conv2d_331 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_381[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_382 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_331[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_72 (MaxPooling2D) (None, 16, 16, 256)  0           leaky_re_lu_382[0][0]            
__________________________________________________________________________________________________
dropout_157 (Dropout)           (None, 16, 16, 256)  0           max_pooling2d_72[0][0]           
__________________________________________________________________________________________________
conv2d_332 (Conv2D)             (None, 16, 16, 512)  1180160     dropout_157[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_383 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_332[0][0]                 
__________________________________________________________________________________________________
conv2d_333 (Conv2D)             (None, 16, 16, 512)  2359808     leaky_re_lu_383[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_384 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_333[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_69 (Conv2DTran (None, 32, 32, 256)  1179904     leaky_re_lu_384[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_385 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_transpose_69[0][0]        
__________________________________________________________________________________________________
concatenate_69 (Concatenate)    (None, 32, 32, 512)  0           leaky_re_lu_385[0][0]            
                                                                 leaky_re_lu_382[0][0]            
__________________________________________________________________________________________________
dropout_158 (Dropout)           (None, 32, 32, 512)  0           concatenate_69[0][0]             
__________________________________________________________________________________________________
conv2d_334 (Conv2D)             (None, 32, 32, 256)  1179904     dropout_158[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_386 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_334[0][0]                 
__________________________________________________________________________________________________
conv2d_335 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_386[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_387 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_335[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_70 (Conv2DTran (None, 64, 64, 128)  295040      leaky_re_lu_387[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_388 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_70[0][0]        
__________________________________________________________________________________________________
concatenate_70 (Concatenate)    (None, 64, 64, 256)  0           leaky_re_lu_388[0][0]            
                                                                 leaky_re_lu_380[0][0]            
__________________________________________________________________________________________________
dropout_159 (Dropout)           (None, 64, 64, 256)  0           concatenate_70[0][0]             
__________________________________________________________________________________________________
conv2d_336 (Conv2D)             (None, 64, 64, 128)  295040      dropout_159[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_389 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_336[0][0]                 
__________________________________________________________________________________________________
conv2d_337 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_389[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_390 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_337[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_71 (Conv2DTran (None, 128, 128, 64) 73792       leaky_re_lu_390[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_391 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_71[0][0]        
__________________________________________________________________________________________________
concatenate_71 (Concatenate)    (None, 128, 128, 128 0           leaky_re_lu_391[0][0]            
                                                                 leaky_re_lu_378[0][0]            
__________________________________________________________________________________________________
dropout_160 (Dropout)           (None, 128, 128, 128 0           concatenate_71[0][0]             
__________________________________________________________________________________________________
conv2d_338 (Conv2D)             (None, 128, 128, 64) 73792       dropout_160[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_392 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_338[0][0]                 
__________________________________________________________________________________________________
conv2d_339 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_392[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_393 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_339[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_72 (Conv2DTran (None, 256, 256, 32) 18464       leaky_re_lu_393[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_394 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_72[0][0]        
__________________________________________________________________________________________________
concatenate_72 (Concatenate)    (None, 256, 256, 64) 0           leaky_re_lu_394[0][0]            
                                                                 leaky_re_lu_376[0][0]            
__________________________________________________________________________________________________
dropout_161 (Dropout)           (None, 256, 256, 64) 0           concatenate_72[0][0]             
__________________________________________________________________________________________________
dropout_162 (Dropout)           (None, 256, 256, 64) 0           dropout_161[0][0]                
__________________________________________________________________________________________________
conv2d_340 (Conv2D)             (None, 256, 256, 32) 18464       dropout_162[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_395 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_340[0][0]                 
__________________________________________________________________________________________________
conv2d_341 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_395[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_396 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_341[0][0]                 
__________________________________________________________________________________________________
conv2d_342 (Conv2D)             (None, 256, 256, 3)  99          leaky_re_lu_396[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 2.1104 - acc: 0.7407 - val_loss: 0.7257 - val_acc: 0.9374

Epoch 00001: val_acc improved from -inf to 0.93741, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.7577 - acc: 0.9180 - val_loss: 0.6600 - val_acc: 0.9419

Epoch 00002: val_acc improved from 0.93741 to 0.94193, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.5940 - acc: 0.9232 - val_loss: 0.6164 - val_acc: 0.9431

Epoch 00003: val_acc improved from 0.94193 to 0.94310, saving model to unn_grid.h5
Epoch 4/1000
 - 19s - loss: 0.5289 - acc: 0.9233 - val_loss: 0.5432 - val_acc: 0.9430

Epoch 00004: val_acc did not improve from 0.94310
Epoch 5/1000
 - 19s - loss: 0.4481 - acc: 0.9209 - val_loss: 0.3611 - val_acc: 0.9410

Epoch 00005: val_acc did not improve from 0.94310
Epoch 6/1000
 - 19s - loss: 0.3347 - acc: 0.9203 - val_loss: 0.2849 - val_acc: 0.9355

Epoch 00006: val_acc did not improve from 0.94310

Epoch 00006: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 7/1000
 - 19s - loss: 0.2877 - acc: 0.9221 - val_loss: 0.2749 - val_acc: 0.9324

Epoch 00007: val_acc did not improve from 0.94310
Epoch 8/1000
 - 19s - loss: 0.2825 - acc: 0.9220 - val_loss: 0.2684 - val_acc: 0.9310

Epoch 00008: val_acc did not improve from 0.94310
Epoch 00008: early stopping
Model: "model_19"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_19 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_343 (Conv2D)             (None, 256, 256, 32) 320         input_19[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_397 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_343[0][0]                 
__________________________________________________________________________________________________
conv2d_344 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_397[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_398 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_344[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_73 (MaxPooling2D) (None, 128, 128, 32) 0           leaky_re_lu_398[0][0]            
__________________________________________________________________________________________________
dropout_163 (Dropout)           (None, 128, 128, 32) 0           max_pooling2d_73[0][0]           
__________________________________________________________________________________________________
conv2d_345 (Conv2D)             (None, 128, 128, 64) 18496       dropout_163[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_399 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_345[0][0]                 
__________________________________________________________________________________________________
conv2d_346 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_399[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_400 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_346[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_74 (MaxPooling2D) (None, 64, 64, 64)   0           leaky_re_lu_400[0][0]            
__________________________________________________________________________________________________
dropout_164 (Dropout)           (None, 64, 64, 64)   0           max_pooling2d_74[0][0]           
__________________________________________________________________________________________________
conv2d_347 (Conv2D)             (None, 64, 64, 128)  73856       dropout_164[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_401 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_347[0][0]                 
__________________________________________________________________________________________________
conv2d_348 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_401[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_402 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_348[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_75 (MaxPooling2D) (None, 32, 32, 128)  0           leaky_re_lu_402[0][0]            
__________________________________________________________________________________________________
dropout_165 (Dropout)           (None, 32, 32, 128)  0           max_pooling2d_75[0][0]           
__________________________________________________________________________________________________
conv2d_349 (Conv2D)             (None, 32, 32, 256)  295168      dropout_165[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_403 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_349[0][0]                 
__________________________________________________________________________________________________
conv2d_350 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_403[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_404 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_350[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_76 (MaxPooling2D) (None, 16, 16, 256)  0           leaky_re_lu_404[0][0]            
__________________________________________________________________________________________________
dropout_166 (Dropout)           (None, 16, 16, 256)  0           max_pooling2d_76[0][0]           
__________________________________________________________________________________________________
conv2d_351 (Conv2D)             (None, 16, 16, 512)  1180160     dropout_166[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_405 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_351[0][0]                 
__________________________________________________________________________________________________
conv2d_352 (Conv2D)             (None, 16, 16, 512)  2359808     leaky_re_lu_405[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_406 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_352[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_73 (Conv2DTran (None, 32, 32, 256)  1179904     leaky_re_lu_406[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_407 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_transpose_73[0][0]        
__________________________________________________________________________________________________
concatenate_73 (Concatenate)    (None, 32, 32, 512)  0           leaky_re_lu_407[0][0]            
                                                                 leaky_re_lu_404[0][0]            
__________________________________________________________________________________________________
dropout_167 (Dropout)           (None, 32, 32, 512)  0           concatenate_73[0][0]             
__________________________________________________________________________________________________
conv2d_353 (Conv2D)             (None, 32, 32, 256)  1179904     dropout_167[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_408 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_353[0][0]                 
__________________________________________________________________________________________________
conv2d_354 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_408[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_409 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_354[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_74 (Conv2DTran (None, 64, 64, 128)  295040      leaky_re_lu_409[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_410 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_74[0][0]        
__________________________________________________________________________________________________
concatenate_74 (Concatenate)    (None, 64, 64, 256)  0           leaky_re_lu_410[0][0]            
                                                                 leaky_re_lu_402[0][0]            
__________________________________________________________________________________________________
dropout_168 (Dropout)           (None, 64, 64, 256)  0           concatenate_74[0][0]             
__________________________________________________________________________________________________
conv2d_355 (Conv2D)             (None, 64, 64, 128)  295040      dropout_168[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_411 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_355[0][0]                 
__________________________________________________________________________________________________
conv2d_356 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_411[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_412 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_356[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_75 (Conv2DTran (None, 128, 128, 64) 73792       leaky_re_lu_412[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_413 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_75[0][0]        
__________________________________________________________________________________________________
concatenate_75 (Concatenate)    (None, 128, 128, 128 0           leaky_re_lu_413[0][0]            
                                                                 leaky_re_lu_400[0][0]            
__________________________________________________________________________________________________
dropout_169 (Dropout)           (None, 128, 128, 128 0           concatenate_75[0][0]             
__________________________________________________________________________________________________
conv2d_357 (Conv2D)             (None, 128, 128, 64) 73792       dropout_169[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_414 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_357[0][0]                 
__________________________________________________________________________________________________
conv2d_358 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_414[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_415 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_358[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_76 (Conv2DTran (None, 256, 256, 32) 18464       leaky_re_lu_415[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_416 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_76[0][0]        
__________________________________________________________________________________________________
concatenate_76 (Concatenate)    (None, 256, 256, 64) 0           leaky_re_lu_416[0][0]            
                                                                 leaky_re_lu_398[0][0]            
__________________________________________________________________________________________________
dropout_170 (Dropout)           (None, 256, 256, 64) 0           concatenate_76[0][0]             
__________________________________________________________________________________________________
dropout_171 (Dropout)           (None, 256, 256, 64) 0           dropout_170[0][0]                
__________________________________________________________________________________________________
conv2d_359 (Conv2D)             (None, 256, 256, 32) 18464       dropout_171[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_417 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_359[0][0]                 
__________________________________________________________________________________________________
conv2d_360 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_417[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_418 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_360[0][0]                 
__________________________________________________________________________________________________
conv2d_361 (Conv2D)             (None, 256, 256, 3)  99          leaky_re_lu_418[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 0.9500 - acc: 0.8970 - val_loss: 0.7232 - val_acc: 0.9407

Epoch 00001: val_acc improved from -inf to 0.94068, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.6404 - acc: 0.9331 - val_loss: 0.6108 - val_acc: 0.9421

Epoch 00002: val_acc improved from 0.94068 to 0.94210, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.5617 - acc: 0.9324 - val_loss: 0.4930 - val_acc: 0.9404

Epoch 00003: val_acc did not improve from 0.94210
Epoch 4/1000
 - 19s - loss: 0.4603 - acc: 0.9275 - val_loss: 0.3770 - val_acc: 0.8837

Epoch 00004: val_acc did not improve from 0.94210
Epoch 5/1000
 - 19s - loss: 0.3079 - acc: 0.9267 - val_loss: 0.2934 - val_acc: 0.9074

Epoch 00005: val_acc did not improve from 0.94210

Epoch 00005: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 6/1000
 - 19s - loss: 0.2546 - acc: 0.9292 - val_loss: 0.3038 - val_acc: 0.9033

Epoch 00006: val_acc did not improve from 0.94210
Epoch 7/1000
 - 19s - loss: 0.2487 - acc: 0.9298 - val_loss: 0.3046 - val_acc: 0.9011

Epoch 00007: val_acc did not improve from 0.94210
Epoch 00007: early stopping
Model: "model_20"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_20 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_362 (Conv2D)             (None, 256, 256, 32) 320         input_20[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_419 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_362[0][0]                 
__________________________________________________________________________________________________
conv2d_363 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_419[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_420 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_363[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_77 (MaxPooling2D) (None, 128, 128, 32) 0           leaky_re_lu_420[0][0]            
__________________________________________________________________________________________________
dropout_172 (Dropout)           (None, 128, 128, 32) 0           max_pooling2d_77[0][0]           
__________________________________________________________________________________________________
conv2d_364 (Conv2D)             (None, 128, 128, 64) 18496       dropout_172[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_421 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_364[0][0]                 
__________________________________________________________________________________________________
conv2d_365 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_421[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_422 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_365[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_78 (MaxPooling2D) (None, 64, 64, 64)   0           leaky_re_lu_422[0][0]            
__________________________________________________________________________________________________
dropout_173 (Dropout)           (None, 64, 64, 64)   0           max_pooling2d_78[0][0]           
__________________________________________________________________________________________________
conv2d_366 (Conv2D)             (None, 64, 64, 128)  73856       dropout_173[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_423 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_366[0][0]                 
__________________________________________________________________________________________________
conv2d_367 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_423[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_424 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_367[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_79 (MaxPooling2D) (None, 32, 32, 128)  0           leaky_re_lu_424[0][0]            
__________________________________________________________________________________________________
dropout_174 (Dropout)           (None, 32, 32, 128)  0           max_pooling2d_79[0][0]           
__________________________________________________________________________________________________
conv2d_368 (Conv2D)             (None, 32, 32, 256)  295168      dropout_174[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_425 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_368[0][0]                 
__________________________________________________________________________________________________
conv2d_369 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_425[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_426 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_369[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_80 (MaxPooling2D) (None, 16, 16, 256)  0           leaky_re_lu_426[0][0]            
__________________________________________________________________________________________________
dropout_175 (Dropout)           (None, 16, 16, 256)  0           max_pooling2d_80[0][0]           
__________________________________________________________________________________________________
conv2d_370 (Conv2D)             (None, 16, 16, 512)  1180160     dropout_175[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_427 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_370[0][0]                 
__________________________________________________________________________________________________
conv2d_371 (Conv2D)             (None, 16, 16, 512)  2359808     leaky_re_lu_427[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_428 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_371[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_77 (Conv2DTran (None, 32, 32, 256)  1179904     leaky_re_lu_428[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_429 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_transpose_77[0][0]        
__________________________________________________________________________________________________
concatenate_77 (Concatenate)    (None, 32, 32, 512)  0           leaky_re_lu_429[0][0]            
                                                                 leaky_re_lu_426[0][0]            
__________________________________________________________________________________________________
dropout_176 (Dropout)           (None, 32, 32, 512)  0           concatenate_77[0][0]             
__________________________________________________________________________________________________
conv2d_372 (Conv2D)             (None, 32, 32, 256)  1179904     dropout_176[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_430 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_372[0][0]                 
__________________________________________________________________________________________________
conv2d_373 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_430[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_431 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_373[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_78 (Conv2DTran (None, 64, 64, 128)  295040      leaky_re_lu_431[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_432 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_78[0][0]        
__________________________________________________________________________________________________
concatenate_78 (Concatenate)    (None, 64, 64, 256)  0           leaky_re_lu_432[0][0]            
                                                                 leaky_re_lu_424[0][0]            
__________________________________________________________________________________________________
dropout_177 (Dropout)           (None, 64, 64, 256)  0           concatenate_78[0][0]             
__________________________________________________________________________________________________
conv2d_374 (Conv2D)             (None, 64, 64, 128)  295040      dropout_177[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_433 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_374[0][0]                 
__________________________________________________________________________________________________
conv2d_375 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_433[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_434 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_375[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_79 (Conv2DTran (None, 128, 128, 64) 73792       leaky_re_lu_434[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_435 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_79[0][0]        
__________________________________________________________________________________________________
concatenate_79 (Concatenate)    (None, 128, 128, 128 0           leaky_re_lu_435[0][0]            
                                                                 leaky_re_lu_422[0][0]            
__________________________________________________________________________________________________
dropout_178 (Dropout)           (None, 128, 128, 128 0           concatenate_79[0][0]             
__________________________________________________________________________________________________
conv2d_376 (Conv2D)             (None, 128, 128, 64) 73792       dropout_178[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_436 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_376[0][0]                 
__________________________________________________________________________________________________
conv2d_377 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_436[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_437 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_377[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_80 (Conv2DTran (None, 256, 256, 32) 18464       leaky_re_lu_437[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_438 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_80[0][0]        
__________________________________________________________________________________________________
concatenate_80 (Concatenate)    (None, 256, 256, 64) 0           leaky_re_lu_438[0][0]            
                                                                 leaky_re_lu_420[0][0]            
__________________________________________________________________________________________________
dropout_179 (Dropout)           (None, 256, 256, 64) 0           concatenate_80[0][0]             
__________________________________________________________________________________________________
dropout_180 (Dropout)           (None, 256, 256, 64) 0           dropout_179[0][0]                
__________________________________________________________________________________________________
conv2d_378 (Conv2D)             (None, 256, 256, 32) 18464       dropout_180[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_439 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_378[0][0]                 
__________________________________________________________________________________________________
conv2d_379 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_439[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_440 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_379[0][0]                 
__________________________________________________________________________________________________
conv2d_380 (Conv2D)             (None, 256, 256, 3)  99          leaky_re_lu_440[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1213 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 2.3900 - acc: 0.6950 - val_loss: 0.6198 - val_acc: 0.9126

Epoch 00001: val_acc improved from -inf to 0.91264, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.6546 - acc: 0.9292 - val_loss: 0.4713 - val_acc: 0.9130

Epoch 00002: val_acc improved from 0.91264 to 0.91297, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.5633 - acc: 0.9337 - val_loss: 0.4059 - val_acc: 0.9134

Epoch 00003: val_acc improved from 0.91297 to 0.91343, saving model to unn_grid.h5
Epoch 4/1000
 - 19s - loss: 0.5100 - acc: 0.9335 - val_loss: 0.3952 - val_acc: 0.9134

Epoch 00004: val_acc did not improve from 0.91343
Epoch 5/1000
 - 19s - loss: 0.4482 - acc: 0.9328 - val_loss: 0.3733 - val_acc: 0.9120

Epoch 00005: val_acc did not improve from 0.91343
Epoch 6/1000
 - 19s - loss: 0.3827 - acc: 0.9321 - val_loss: 0.3923 - val_acc: 0.9095

Epoch 00006: val_acc did not improve from 0.91343

Epoch 00006: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 7/1000
 - 19s - loss: 0.3343 - acc: 0.9343 - val_loss: 0.3963 - val_acc: 0.9037

Epoch 00007: val_acc did not improve from 0.91343
Epoch 8/1000
 - 19s - loss: 0.3274 - acc: 0.9345 - val_loss: 0.3997 - val_acc: 0.9010

Epoch 00008: val_acc did not improve from 0.91343
Epoch 00008: early stopping
scores= [[0.94593302 0.45337382 0.40869075]
 [0.93582602 0.33330832 0.3119443 ]
 [0.95986734 0.64962314 0.57892187]
 [0.93558513 0.33322472 0.31186717]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]] parameters= (32, 'Adam', 0.35, 'glorot_uniform', 1e-05)
Model: "model_21"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_21 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_381 (Conv2D)             (None, 256, 256, 32) 320         input_21[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_441 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_381[0][0]                 
__________________________________________________________________________________________________
conv2d_382 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_441[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_442 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_382[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_81 (MaxPooling2D) (None, 128, 128, 32) 0           leaky_re_lu_442[0][0]            
__________________________________________________________________________________________________
dropout_181 (Dropout)           (None, 128, 128, 32) 0           max_pooling2d_81[0][0]           
__________________________________________________________________________________________________
conv2d_383 (Conv2D)             (None, 128, 128, 64) 18496       dropout_181[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_443 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_383[0][0]                 
__________________________________________________________________________________________________
conv2d_384 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_443[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_444 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_384[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_82 (MaxPooling2D) (None, 64, 64, 64)   0           leaky_re_lu_444[0][0]            
__________________________________________________________________________________________________
dropout_182 (Dropout)           (None, 64, 64, 64)   0           max_pooling2d_82[0][0]           
__________________________________________________________________________________________________
conv2d_385 (Conv2D)             (None, 64, 64, 128)  73856       dropout_182[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_445 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_385[0][0]                 
__________________________________________________________________________________________________
conv2d_386 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_445[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_446 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_386[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_83 (MaxPooling2D) (None, 32, 32, 128)  0           leaky_re_lu_446[0][0]            
__________________________________________________________________________________________________
dropout_183 (Dropout)           (None, 32, 32, 128)  0           max_pooling2d_83[0][0]           
__________________________________________________________________________________________________
conv2d_387 (Conv2D)             (None, 32, 32, 256)  295168      dropout_183[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_447 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_387[0][0]                 
__________________________________________________________________________________________________
conv2d_388 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_447[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_448 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_388[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_84 (MaxPooling2D) (None, 16, 16, 256)  0           leaky_re_lu_448[0][0]            
__________________________________________________________________________________________________
dropout_184 (Dropout)           (None, 16, 16, 256)  0           max_pooling2d_84[0][0]           
__________________________________________________________________________________________________
conv2d_389 (Conv2D)             (None, 16, 16, 512)  1180160     dropout_184[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_449 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_389[0][0]                 
__________________________________________________________________________________________________
conv2d_390 (Conv2D)             (None, 16, 16, 512)  2359808     leaky_re_lu_449[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_450 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_390[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_81 (Conv2DTran (None, 32, 32, 256)  1179904     leaky_re_lu_450[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_451 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_transpose_81[0][0]        
__________________________________________________________________________________________________
concatenate_81 (Concatenate)    (None, 32, 32, 512)  0           leaky_re_lu_451[0][0]            
                                                                 leaky_re_lu_448[0][0]            
__________________________________________________________________________________________________
dropout_185 (Dropout)           (None, 32, 32, 512)  0           concatenate_81[0][0]             
__________________________________________________________________________________________________
conv2d_391 (Conv2D)             (None, 32, 32, 256)  1179904     dropout_185[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_452 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_391[0][0]                 
__________________________________________________________________________________________________
conv2d_392 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_452[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_453 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_392[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_82 (Conv2DTran (None, 64, 64, 128)  295040      leaky_re_lu_453[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_454 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_82[0][0]        
__________________________________________________________________________________________________
concatenate_82 (Concatenate)    (None, 64, 64, 256)  0           leaky_re_lu_454[0][0]            
                                                                 leaky_re_lu_446[0][0]            
__________________________________________________________________________________________________
dropout_186 (Dropout)           (None, 64, 64, 256)  0           concatenate_82[0][0]             
__________________________________________________________________________________________________
conv2d_393 (Conv2D)             (None, 64, 64, 128)  295040      dropout_186[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_455 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_393[0][0]                 
__________________________________________________________________________________________________
conv2d_394 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_455[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_456 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_394[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_83 (Conv2DTran (None, 128, 128, 64) 73792       leaky_re_lu_456[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_457 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_83[0][0]        
__________________________________________________________________________________________________
concatenate_83 (Concatenate)    (None, 128, 128, 128 0           leaky_re_lu_457[0][0]            
                                                                 leaky_re_lu_444[0][0]            
__________________________________________________________________________________________________
dropout_187 (Dropout)           (None, 128, 128, 128 0           concatenate_83[0][0]             
__________________________________________________________________________________________________
conv2d_395 (Conv2D)             (None, 128, 128, 64) 73792       dropout_187[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_458 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_395[0][0]                 
__________________________________________________________________________________________________
conv2d_396 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_458[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_459 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_396[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_84 (Conv2DTran (None, 256, 256, 32) 18464       leaky_re_lu_459[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_460 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_84[0][0]        
__________________________________________________________________________________________________
concatenate_84 (Concatenate)    (None, 256, 256, 64) 0           leaky_re_lu_460[0][0]            
                                                                 leaky_re_lu_442[0][0]            
__________________________________________________________________________________________________
dropout_188 (Dropout)           (None, 256, 256, 64) 0           concatenate_84[0][0]             
__________________________________________________________________________________________________
dropout_189 (Dropout)           (None, 256, 256, 64) 0           dropout_188[0][0]                
__________________________________________________________________________________________________
conv2d_397 (Conv2D)             (None, 256, 256, 32) 18464       dropout_189[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_461 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_397[0][0]                 
__________________________________________________________________________________________________
conv2d_398 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_461[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_462 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_398[0][0]                 
__________________________________________________________________________________________________
conv2d_399 (Conv2D)             (None, 256, 256, 3)  99          leaky_re_lu_462[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 0.4137 - acc: 0.9265 - val_loss: 0.2026 - val_acc: 0.9429

Epoch 00001: val_acc improved from -inf to 0.94293, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.1979 - acc: 0.9319 - val_loss: 0.1669 - val_acc: 0.9433

Epoch 00002: val_acc improved from 0.94293 to 0.94327, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.1772 - acc: 0.9327 - val_loss: 0.2064 - val_acc: 0.9433

Epoch 00003: val_acc did not improve from 0.94327
Epoch 4/1000
 - 19s - loss: 0.1766 - acc: 0.9328 - val_loss: 0.1527 - val_acc: 0.9433

Epoch 00004: val_acc improved from 0.94327 to 0.94328, saving model to unn_grid.h5
Epoch 5/1000
 - 19s - loss: 0.1685 - acc: 0.9328 - val_loss: 0.1641 - val_acc: 0.9433

Epoch 00005: val_acc did not improve from 0.94328

Epoch 00005: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 6/1000
 - 19s - loss: 0.1594 - acc: 0.9328 - val_loss: 0.1502 - val_acc: 0.9433

Epoch 00006: val_acc did not improve from 0.94328
Epoch 7/1000
 - 19s - loss: 0.1567 - acc: 0.9328 - val_loss: 0.1464 - val_acc: 0.9433

Epoch 00007: val_acc improved from 0.94328 to 0.94328, saving model to unn_grid.h5
Epoch 8/1000
 - 19s - loss: 0.1548 - acc: 0.9329 - val_loss: 0.1464 - val_acc: 0.9433

Epoch 00008: val_acc improved from 0.94328 to 0.94328, saving model to unn_grid.h5

Epoch 00008: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 9/1000
 - 19s - loss: 0.1530 - acc: 0.9329 - val_loss: 0.1459 - val_acc: 0.9433

Epoch 00009: val_acc did not improve from 0.94328
Epoch 10/1000
 - 19s - loss: 0.1526 - acc: 0.9329 - val_loss: 0.1448 - val_acc: 0.9433

Epoch 00010: val_acc did not improve from 0.94328
Epoch 11/1000
 - 19s - loss: 0.1524 - acc: 0.9329 - val_loss: 0.1442 - val_acc: 0.9433

Epoch 00011: val_acc did not improve from 0.94328

Epoch 00011: ReduceLROnPlateau reducing learning rate to 9.999999974752428e-08.
Epoch 12/1000
 - 19s - loss: 0.1523 - acc: 0.9329 - val_loss: 0.1444 - val_acc: 0.9433

Epoch 00012: val_acc did not improve from 0.94328
Epoch 13/1000
 - 19s - loss: 0.1522 - acc: 0.9329 - val_loss: 0.1446 - val_acc: 0.9433

Epoch 00013: val_acc did not improve from 0.94328
Epoch 00013: early stopping
Model: "model_22"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_22 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_400 (Conv2D)             (None, 256, 256, 32) 320         input_22[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_463 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_400[0][0]                 
__________________________________________________________________________________________________
conv2d_401 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_463[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_464 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_401[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_85 (MaxPooling2D) (None, 128, 128, 32) 0           leaky_re_lu_464[0][0]            
__________________________________________________________________________________________________
dropout_190 (Dropout)           (None, 128, 128, 32) 0           max_pooling2d_85[0][0]           
__________________________________________________________________________________________________
conv2d_402 (Conv2D)             (None, 128, 128, 64) 18496       dropout_190[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_465 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_402[0][0]                 
__________________________________________________________________________________________________
conv2d_403 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_465[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_466 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_403[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_86 (MaxPooling2D) (None, 64, 64, 64)   0           leaky_re_lu_466[0][0]            
__________________________________________________________________________________________________
dropout_191 (Dropout)           (None, 64, 64, 64)   0           max_pooling2d_86[0][0]           
__________________________________________________________________________________________________
conv2d_404 (Conv2D)             (None, 64, 64, 128)  73856       dropout_191[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_467 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_404[0][0]                 
__________________________________________________________________________________________________
conv2d_405 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_467[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_468 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_405[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_87 (MaxPooling2D) (None, 32, 32, 128)  0           leaky_re_lu_468[0][0]            
__________________________________________________________________________________________________
dropout_192 (Dropout)           (None, 32, 32, 128)  0           max_pooling2d_87[0][0]           
__________________________________________________________________________________________________
conv2d_406 (Conv2D)             (None, 32, 32, 256)  295168      dropout_192[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_469 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_406[0][0]                 
__________________________________________________________________________________________________
conv2d_407 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_469[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_470 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_407[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_88 (MaxPooling2D) (None, 16, 16, 256)  0           leaky_re_lu_470[0][0]            
__________________________________________________________________________________________________
dropout_193 (Dropout)           (None, 16, 16, 256)  0           max_pooling2d_88[0][0]           
__________________________________________________________________________________________________
conv2d_408 (Conv2D)             (None, 16, 16, 512)  1180160     dropout_193[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_471 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_408[0][0]                 
__________________________________________________________________________________________________
conv2d_409 (Conv2D)             (None, 16, 16, 512)  2359808     leaky_re_lu_471[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_472 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_409[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_85 (Conv2DTran (None, 32, 32, 256)  1179904     leaky_re_lu_472[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_473 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_transpose_85[0][0]        
__________________________________________________________________________________________________
concatenate_85 (Concatenate)    (None, 32, 32, 512)  0           leaky_re_lu_473[0][0]            
                                                                 leaky_re_lu_470[0][0]            
__________________________________________________________________________________________________
dropout_194 (Dropout)           (None, 32, 32, 512)  0           concatenate_85[0][0]             
__________________________________________________________________________________________________
conv2d_410 (Conv2D)             (None, 32, 32, 256)  1179904     dropout_194[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_474 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_410[0][0]                 
__________________________________________________________________________________________________
conv2d_411 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_474[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_475 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_411[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_86 (Conv2DTran (None, 64, 64, 128)  295040      leaky_re_lu_475[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_476 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_86[0][0]        
__________________________________________________________________________________________________
concatenate_86 (Concatenate)    (None, 64, 64, 256)  0           leaky_re_lu_476[0][0]            
                                                                 leaky_re_lu_468[0][0]            
__________________________________________________________________________________________________
dropout_195 (Dropout)           (None, 64, 64, 256)  0           concatenate_86[0][0]             
__________________________________________________________________________________________________
conv2d_412 (Conv2D)             (None, 64, 64, 128)  295040      dropout_195[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_477 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_412[0][0]                 
__________________________________________________________________________________________________
conv2d_413 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_477[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_478 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_413[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_87 (Conv2DTran (None, 128, 128, 64) 73792       leaky_re_lu_478[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_479 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_87[0][0]        
__________________________________________________________________________________________________
concatenate_87 (Concatenate)    (None, 128, 128, 128 0           leaky_re_lu_479[0][0]            
                                                                 leaky_re_lu_466[0][0]            
__________________________________________________________________________________________________
dropout_196 (Dropout)           (None, 128, 128, 128 0           concatenate_87[0][0]             
__________________________________________________________________________________________________
conv2d_414 (Conv2D)             (None, 128, 128, 64) 73792       dropout_196[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_480 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_414[0][0]                 
__________________________________________________________________________________________________
conv2d_415 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_480[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_481 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_415[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_88 (Conv2DTran (None, 256, 256, 32) 18464       leaky_re_lu_481[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_482 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_88[0][0]        
__________________________________________________________________________________________________
concatenate_88 (Concatenate)    (None, 256, 256, 64) 0           leaky_re_lu_482[0][0]            
                                                                 leaky_re_lu_464[0][0]            
__________________________________________________________________________________________________
dropout_197 (Dropout)           (None, 256, 256, 64) 0           concatenate_88[0][0]             
__________________________________________________________________________________________________
dropout_198 (Dropout)           (None, 256, 256, 64) 0           dropout_197[0][0]                
__________________________________________________________________________________________________
conv2d_416 (Conv2D)             (None, 256, 256, 32) 18464       dropout_198[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_483 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_416[0][0]                 
__________________________________________________________________________________________________
conv2d_417 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_483[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_484 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_417[0][0]                 
__________________________________________________________________________________________________
conv2d_418 (Conv2D)             (None, 256, 256, 3)  99          leaky_re_lu_484[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 0.5293 - acc: 0.9270 - val_loss: 0.2310 - val_acc: 0.9338

Epoch 00001: val_acc improved from -inf to 0.93382, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.1914 - acc: 0.9345 - val_loss: 0.1565 - val_acc: 0.9433

Epoch 00002: val_acc improved from 0.93382 to 0.94327, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.1647 - acc: 0.9374 - val_loss: 0.1673 - val_acc: 0.9433

Epoch 00003: val_acc improved from 0.94327 to 0.94328, saving model to unn_grid.h5
Epoch 4/1000
 - 19s - loss: 0.1613 - acc: 0.9376 - val_loss: 0.1650 - val_acc: 0.9432

Epoch 00004: val_acc did not improve from 0.94328
Epoch 5/1000
 - 19s - loss: 0.1536 - acc: 0.9377 - val_loss: 0.1431 - val_acc: 0.9433

Epoch 00005: val_acc did not improve from 0.94328

Epoch 00005: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 6/1000
 - 19s - loss: 0.1456 - acc: 0.9383 - val_loss: 0.1453 - val_acc: 0.9432

Epoch 00006: val_acc did not improve from 0.94328
Epoch 7/1000
 - 19s - loss: 0.1438 - acc: 0.9388 - val_loss: 0.1417 - val_acc: 0.9441

Epoch 00007: val_acc improved from 0.94328 to 0.94410, saving model to unn_grid.h5
Epoch 8/1000
 - 19s - loss: 0.1429 - acc: 0.9393 - val_loss: 0.1400 - val_acc: 0.9467

Epoch 00008: val_acc improved from 0.94410 to 0.94669, saving model to unn_grid.h5
Epoch 9/1000
 - 19s - loss: 0.1414 - acc: 0.9397 - val_loss: 0.1446 - val_acc: 0.9512

Epoch 00009: val_acc improved from 0.94669 to 0.95122, saving model to unn_grid.h5
Epoch 10/1000
 - 19s - loss: 0.1402 - acc: 0.9402 - val_loss: 0.1381 - val_acc: 0.9518

Epoch 00010: val_acc improved from 0.95122 to 0.95176, saving model to unn_grid.h5
Epoch 11/1000
 - 19s - loss: 0.1388 - acc: 0.9409 - val_loss: 0.1355 - val_acc: 0.9522

Epoch 00011: val_acc improved from 0.95176 to 0.95225, saving model to unn_grid.h5
Epoch 12/1000
 - 19s - loss: 0.1377 - acc: 0.9415 - val_loss: 0.1340 - val_acc: 0.9526

Epoch 00012: val_acc improved from 0.95225 to 0.95264, saving model to unn_grid.h5
Epoch 13/1000
 - 19s - loss: 0.1367 - acc: 0.9420 - val_loss: 0.1323 - val_acc: 0.9524

Epoch 00013: val_acc did not improve from 0.95264
Epoch 14/1000
 - 19s - loss: 0.1350 - acc: 0.9430 - val_loss: 0.1381 - val_acc: 0.9524

Epoch 00014: val_acc did not improve from 0.95264
Epoch 15/1000
 - 19s - loss: 0.1334 - acc: 0.9436 - val_loss: 0.1310 - val_acc: 0.9533

Epoch 00015: val_acc improved from 0.95264 to 0.95326, saving model to unn_grid.h5
Epoch 16/1000
 - 19s - loss: 0.1316 - acc: 0.9444 - val_loss: 0.1330 - val_acc: 0.9532

Epoch 00016: val_acc did not improve from 0.95326
Epoch 17/1000
 - 19s - loss: 0.1303 - acc: 0.9454 - val_loss: 0.1339 - val_acc: 0.9537

Epoch 00017: val_acc improved from 0.95326 to 0.95370, saving model to unn_grid.h5
Epoch 18/1000
 - 19s - loss: 0.1283 - acc: 0.9458 - val_loss: 0.1258 - val_acc: 0.9540

Epoch 00018: val_acc improved from 0.95370 to 0.95399, saving model to unn_grid.h5
Epoch 19/1000
 - 19s - loss: 0.1272 - acc: 0.9463 - val_loss: 0.1253 - val_acc: 0.9543

Epoch 00019: val_acc improved from 0.95399 to 0.95435, saving model to unn_grid.h5
Epoch 20/1000
 - 19s - loss: 0.1255 - acc: 0.9473 - val_loss: 0.1268 - val_acc: 0.9546

Epoch 00020: val_acc improved from 0.95435 to 0.95461, saving model to unn_grid.h5
Epoch 21/1000
 - 19s - loss: 0.1234 - acc: 0.9482 - val_loss: 0.1245 - val_acc: 0.9548

Epoch 00021: val_acc improved from 0.95461 to 0.95482, saving model to unn_grid.h5
Epoch 22/1000
 - 19s - loss: 0.1211 - acc: 0.9492 - val_loss: 0.1225 - val_acc: 0.9562

Epoch 00022: val_acc improved from 0.95482 to 0.95618, saving model to unn_grid.h5
Epoch 23/1000
 - 19s - loss: 0.1190 - acc: 0.9510 - val_loss: 0.1220 - val_acc: 0.9569

Epoch 00023: val_acc improved from 0.95618 to 0.95692, saving model to unn_grid.h5
Epoch 24/1000
 - 19s - loss: 0.1173 - acc: 0.9527 - val_loss: 0.1230 - val_acc: 0.9578

Epoch 00024: val_acc improved from 0.95692 to 0.95775, saving model to unn_grid.h5
Epoch 25/1000
 - 19s - loss: 0.1141 - acc: 0.9544 - val_loss: 0.1219 - val_acc: 0.9581

Epoch 00025: val_acc improved from 0.95775 to 0.95806, saving model to unn_grid.h5
Epoch 26/1000
 - 19s - loss: 0.1128 - acc: 0.9554 - val_loss: 0.1221 - val_acc: 0.9585

Epoch 00026: val_acc improved from 0.95806 to 0.95850, saving model to unn_grid.h5
Epoch 27/1000
 - 19s - loss: 0.1103 - acc: 0.9570 - val_loss: 0.1181 - val_acc: 0.9602

Epoch 00027: val_acc improved from 0.95850 to 0.96021, saving model to unn_grid.h5
Epoch 28/1000
 - 19s - loss: 0.1067 - acc: 0.9590 - val_loss: 0.1167 - val_acc: 0.9607

Epoch 00028: val_acc improved from 0.96021 to 0.96067, saving model to unn_grid.h5
Epoch 29/1000
 - 19s - loss: 0.1042 - acc: 0.9602 - val_loss: 0.1156 - val_acc: 0.9603

Epoch 00029: val_acc did not improve from 0.96067
Epoch 30/1000
 - 19s - loss: 0.1022 - acc: 0.9611 - val_loss: 0.1120 - val_acc: 0.9615

Epoch 00030: val_acc improved from 0.96067 to 0.96149, saving model to unn_grid.h5
Epoch 31/1000
 - 19s - loss: 0.0998 - acc: 0.9620 - val_loss: 0.1236 - val_acc: 0.9585

Epoch 00031: val_acc did not improve from 0.96149
Epoch 32/1000
 - 19s - loss: 0.0974 - acc: 0.9631 - val_loss: 0.1092 - val_acc: 0.9623

Epoch 00032: val_acc improved from 0.96149 to 0.96227, saving model to unn_grid.h5
Epoch 33/1000
 - 19s - loss: 0.0972 - acc: 0.9631 - val_loss: 0.1114 - val_acc: 0.9608

Epoch 00033: val_acc did not improve from 0.96227
Epoch 34/1000
 - 19s - loss: 0.0933 - acc: 0.9646 - val_loss: 0.1062 - val_acc: 0.9636

Epoch 00034: val_acc improved from 0.96227 to 0.96356, saving model to unn_grid.h5
Epoch 35/1000
 - 19s - loss: 0.0928 - acc: 0.9649 - val_loss: 0.1119 - val_acc: 0.9612

Epoch 00035: val_acc did not improve from 0.96356
Epoch 36/1000
 - 19s - loss: 0.0918 - acc: 0.9651 - val_loss: 0.1078 - val_acc: 0.9623

Epoch 00036: val_acc did not improve from 0.96356
Epoch 37/1000
 - 19s - loss: 0.0891 - acc: 0.9662 - val_loss: 0.1075 - val_acc: 0.9624

Epoch 00037: val_acc did not improve from 0.96356

Epoch 00037: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 38/1000
 - 19s - loss: 0.0851 - acc: 0.9677 - val_loss: 0.1072 - val_acc: 0.9625

Epoch 00038: val_acc did not improve from 0.96356
Epoch 39/1000
 - 19s - loss: 0.0842 - acc: 0.9679 - val_loss: 0.1066 - val_acc: 0.9630

Epoch 00039: val_acc did not improve from 0.96356
Epoch 00039: early stopping
Model: "model_23"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_23 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_419 (Conv2D)             (None, 256, 256, 32) 320         input_23[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_485 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_419[0][0]                 
__________________________________________________________________________________________________
conv2d_420 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_485[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_486 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_420[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_89 (MaxPooling2D) (None, 128, 128, 32) 0           leaky_re_lu_486[0][0]            
__________________________________________________________________________________________________
dropout_199 (Dropout)           (None, 128, 128, 32) 0           max_pooling2d_89[0][0]           
__________________________________________________________________________________________________
conv2d_421 (Conv2D)             (None, 128, 128, 64) 18496       dropout_199[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_487 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_421[0][0]                 
__________________________________________________________________________________________________
conv2d_422 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_487[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_488 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_422[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_90 (MaxPooling2D) (None, 64, 64, 64)   0           leaky_re_lu_488[0][0]            
__________________________________________________________________________________________________
dropout_200 (Dropout)           (None, 64, 64, 64)   0           max_pooling2d_90[0][0]           
__________________________________________________________________________________________________
conv2d_423 (Conv2D)             (None, 64, 64, 128)  73856       dropout_200[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_489 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_423[0][0]                 
__________________________________________________________________________________________________
conv2d_424 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_489[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_490 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_424[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_91 (MaxPooling2D) (None, 32, 32, 128)  0           leaky_re_lu_490[0][0]            
__________________________________________________________________________________________________
dropout_201 (Dropout)           (None, 32, 32, 128)  0           max_pooling2d_91[0][0]           
__________________________________________________________________________________________________
conv2d_425 (Conv2D)             (None, 32, 32, 256)  295168      dropout_201[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_491 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_425[0][0]                 
__________________________________________________________________________________________________
conv2d_426 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_491[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_492 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_426[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_92 (MaxPooling2D) (None, 16, 16, 256)  0           leaky_re_lu_492[0][0]            
__________________________________________________________________________________________________
dropout_202 (Dropout)           (None, 16, 16, 256)  0           max_pooling2d_92[0][0]           
__________________________________________________________________________________________________
conv2d_427 (Conv2D)             (None, 16, 16, 512)  1180160     dropout_202[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_493 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_427[0][0]                 
__________________________________________________________________________________________________
conv2d_428 (Conv2D)             (None, 16, 16, 512)  2359808     leaky_re_lu_493[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_494 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_428[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_89 (Conv2DTran (None, 32, 32, 256)  1179904     leaky_re_lu_494[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_495 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_transpose_89[0][0]        
__________________________________________________________________________________________________
concatenate_89 (Concatenate)    (None, 32, 32, 512)  0           leaky_re_lu_495[0][0]            
                                                                 leaky_re_lu_492[0][0]            
__________________________________________________________________________________________________
dropout_203 (Dropout)           (None, 32, 32, 512)  0           concatenate_89[0][0]             
__________________________________________________________________________________________________
conv2d_429 (Conv2D)             (None, 32, 32, 256)  1179904     dropout_203[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_496 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_429[0][0]                 
__________________________________________________________________________________________________
conv2d_430 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_496[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_497 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_430[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_90 (Conv2DTran (None, 64, 64, 128)  295040      leaky_re_lu_497[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_498 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_90[0][0]        
__________________________________________________________________________________________________
concatenate_90 (Concatenate)    (None, 64, 64, 256)  0           leaky_re_lu_498[0][0]            
                                                                 leaky_re_lu_490[0][0]            
__________________________________________________________________________________________________
dropout_204 (Dropout)           (None, 64, 64, 256)  0           concatenate_90[0][0]             
__________________________________________________________________________________________________
conv2d_431 (Conv2D)             (None, 64, 64, 128)  295040      dropout_204[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_499 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_431[0][0]                 
__________________________________________________________________________________________________
conv2d_432 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_499[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_500 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_432[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_91 (Conv2DTran (None, 128, 128, 64) 73792       leaky_re_lu_500[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_501 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_91[0][0]        
__________________________________________________________________________________________________
concatenate_91 (Concatenate)    (None, 128, 128, 128 0           leaky_re_lu_501[0][0]            
                                                                 leaky_re_lu_488[0][0]            
__________________________________________________________________________________________________
dropout_205 (Dropout)           (None, 128, 128, 128 0           concatenate_91[0][0]             
__________________________________________________________________________________________________
conv2d_433 (Conv2D)             (None, 128, 128, 64) 73792       dropout_205[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_502 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_433[0][0]                 
__________________________________________________________________________________________________
conv2d_434 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_502[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_503 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_434[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_92 (Conv2DTran (None, 256, 256, 32) 18464       leaky_re_lu_503[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_504 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_92[0][0]        
__________________________________________________________________________________________________
concatenate_92 (Concatenate)    (None, 256, 256, 64) 0           leaky_re_lu_504[0][0]            
                                                                 leaky_re_lu_486[0][0]            
__________________________________________________________________________________________________
dropout_206 (Dropout)           (None, 256, 256, 64) 0           concatenate_92[0][0]             
__________________________________________________________________________________________________
dropout_207 (Dropout)           (None, 256, 256, 64) 0           dropout_206[0][0]                
__________________________________________________________________________________________________
conv2d_435 (Conv2D)             (None, 256, 256, 32) 18464       dropout_207[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_505 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_435[0][0]                 
__________________________________________________________________________________________________
conv2d_436 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_505[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_506 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_436[0][0]                 
__________________________________________________________________________________________________
conv2d_437 (Conv2D)             (None, 256, 256, 3)  99          leaky_re_lu_506[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 0.3685 - acc: 0.9258 - val_loss: 0.2012 - val_acc: 0.9432

Epoch 00001: val_acc improved from -inf to 0.94319, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.2019 - acc: 0.9290 - val_loss: 0.1695 - val_acc: 0.9433

Epoch 00002: val_acc improved from 0.94319 to 0.94328, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.1858 - acc: 0.9294 - val_loss: 0.1713 - val_acc: 0.9428

Epoch 00003: val_acc did not improve from 0.94328
Epoch 4/1000
 - 19s - loss: 0.1803 - acc: 0.9294 - val_loss: 0.1698 - val_acc: 0.9432

Epoch 00004: val_acc did not improve from 0.94328

Epoch 00004: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 5/1000
 - 19s - loss: 0.1681 - acc: 0.9300 - val_loss: 0.1574 - val_acc: 0.9433

Epoch 00005: val_acc did not improve from 0.94328
Epoch 6/1000
 - 19s - loss: 0.1658 - acc: 0.9303 - val_loss: 0.1462 - val_acc: 0.9450

Epoch 00006: val_acc improved from 0.94328 to 0.94502, saving model to unn_grid.h5
Epoch 7/1000
 - 19s - loss: 0.1638 - acc: 0.9308 - val_loss: 0.1476 - val_acc: 0.9456

Epoch 00007: val_acc improved from 0.94502 to 0.94558, saving model to unn_grid.h5
Epoch 8/1000
 - 19s - loss: 0.1623 - acc: 0.9314 - val_loss: 0.1497 - val_acc: 0.9480

Epoch 00008: val_acc improved from 0.94558 to 0.94803, saving model to unn_grid.h5
Epoch 9/1000
 - 19s - loss: 0.1604 - acc: 0.9318 - val_loss: 0.1415 - val_acc: 0.9483

Epoch 00009: val_acc improved from 0.94803 to 0.94830, saving model to unn_grid.h5
Epoch 10/1000
 - 19s - loss: 0.1589 - acc: 0.9325 - val_loss: 0.1448 - val_acc: 0.9477

Epoch 00010: val_acc did not improve from 0.94830
Epoch 11/1000
 - 19s - loss: 0.1571 - acc: 0.9324 - val_loss: 0.1480 - val_acc: 0.9490

Epoch 00011: val_acc improved from 0.94830 to 0.94905, saving model to unn_grid.h5
Epoch 12/1000
 - 19s - loss: 0.1548 - acc: 0.9332 - val_loss: 0.1373 - val_acc: 0.9492

Epoch 00012: val_acc improved from 0.94905 to 0.94925, saving model to unn_grid.h5
Epoch 13/1000
 - 19s - loss: 0.1525 - acc: 0.9337 - val_loss: 0.1391 - val_acc: 0.9501

Epoch 00013: val_acc improved from 0.94925 to 0.95006, saving model to unn_grid.h5
Epoch 14/1000
 - 19s - loss: 0.1501 - acc: 0.9341 - val_loss: 0.1351 - val_acc: 0.9479

Epoch 00014: val_acc did not improve from 0.95006
Epoch 15/1000
 - 19s - loss: 0.1484 - acc: 0.9343 - val_loss: 0.1298 - val_acc: 0.9506

Epoch 00015: val_acc improved from 0.95006 to 0.95057, saving model to unn_grid.h5
Epoch 16/1000
 - 19s - loss: 0.1451 - acc: 0.9350 - val_loss: 0.1297 - val_acc: 0.9501

Epoch 00016: val_acc did not improve from 0.95057
Epoch 17/1000
 - 19s - loss: 0.1423 - acc: 0.9360 - val_loss: 0.1275 - val_acc: 0.9504

Epoch 00017: val_acc did not improve from 0.95057
Epoch 18/1000
 - 19s - loss: 0.1392 - acc: 0.9382 - val_loss: 0.1255 - val_acc: 0.9519

Epoch 00018: val_acc improved from 0.95057 to 0.95187, saving model to unn_grid.h5
Epoch 19/1000
 - 19s - loss: 0.1359 - acc: 0.9413 - val_loss: 0.1197 - val_acc: 0.9533

Epoch 00019: val_acc improved from 0.95187 to 0.95328, saving model to unn_grid.h5
Epoch 20/1000
 - 19s - loss: 0.1335 - acc: 0.9445 - val_loss: 0.1254 - val_acc: 0.9563

Epoch 00020: val_acc improved from 0.95328 to 0.95633, saving model to unn_grid.h5
Epoch 21/1000
 - 19s - loss: 0.1283 - acc: 0.9507 - val_loss: 0.1166 - val_acc: 0.9585

Epoch 00021: val_acc improved from 0.95633 to 0.95849, saving model to unn_grid.h5
Epoch 22/1000
 - 19s - loss: 0.1216 - acc: 0.9549 - val_loss: 0.1159 - val_acc: 0.9587

Epoch 00022: val_acc improved from 0.95849 to 0.95872, saving model to unn_grid.h5
Epoch 23/1000
 - 19s - loss: 0.1172 - acc: 0.9570 - val_loss: 0.1115 - val_acc: 0.9603

Epoch 00023: val_acc improved from 0.95872 to 0.96029, saving model to unn_grid.h5
Epoch 24/1000
 - 19s - loss: 0.1138 - acc: 0.9580 - val_loss: 0.1075 - val_acc: 0.9604

Epoch 00024: val_acc improved from 0.96029 to 0.96039, saving model to unn_grid.h5
Epoch 25/1000
 - 19s - loss: 0.1103 - acc: 0.9593 - val_loss: 0.1076 - val_acc: 0.9604

Epoch 00025: val_acc improved from 0.96039 to 0.96044, saving model to unn_grid.h5
Epoch 26/1000
 - 19s - loss: 0.1079 - acc: 0.9602 - val_loss: 0.1121 - val_acc: 0.9608

Epoch 00026: val_acc improved from 0.96044 to 0.96080, saving model to unn_grid.h5
Epoch 27/1000
 - 19s - loss: 0.1057 - acc: 0.9609 - val_loss: 0.1053 - val_acc: 0.9613

Epoch 00027: val_acc improved from 0.96080 to 0.96128, saving model to unn_grid.h5
Epoch 28/1000
 - 19s - loss: 0.1044 - acc: 0.9616 - val_loss: 0.1109 - val_acc: 0.9577

Epoch 00028: val_acc did not improve from 0.96128
Epoch 29/1000
 - 19s - loss: 0.1010 - acc: 0.9627 - val_loss: 0.1111 - val_acc: 0.9585

Epoch 00029: val_acc did not improve from 0.96128
Epoch 30/1000
 - 19s - loss: 0.1000 - acc: 0.9629 - val_loss: 0.1106 - val_acc: 0.9606

Epoch 00030: val_acc did not improve from 0.96128

Epoch 00030: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 31/1000
 - 19s - loss: 0.0949 - acc: 0.9650 - val_loss: 0.1087 - val_acc: 0.9601

Epoch 00031: val_acc did not improve from 0.96128
Epoch 32/1000
 - 19s - loss: 0.0944 - acc: 0.9651 - val_loss: 0.1046 - val_acc: 0.9622

Epoch 00032: val_acc improved from 0.96128 to 0.96218, saving model to unn_grid.h5
Epoch 33/1000
 - 19s - loss: 0.0934 - acc: 0.9654 - val_loss: 0.1080 - val_acc: 0.9600

Epoch 00033: val_acc did not improve from 0.96218
Epoch 34/1000
 - 19s - loss: 0.0939 - acc: 0.9653 - val_loss: 0.1051 - val_acc: 0.9612

Epoch 00034: val_acc did not improve from 0.96218
Epoch 35/1000
 - 19s - loss: 0.0932 - acc: 0.9655 - val_loss: 0.1048 - val_acc: 0.9620

Epoch 00035: val_acc did not improve from 0.96218

Epoch 00035: ReduceLROnPlateau reducing learning rate to 9.999999974752428e-08.
Epoch 36/1000
 - 19s - loss: 0.0924 - acc: 0.9658 - val_loss: 0.1051 - val_acc: 0.9615

Epoch 00036: val_acc did not improve from 0.96218
Epoch 37/1000
 - 19s - loss: 0.0923 - acc: 0.9656 - val_loss: 0.1053 - val_acc: 0.9613

Epoch 00037: val_acc did not improve from 0.96218
Epoch 00037: early stopping
Model: "model_24"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_24 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_438 (Conv2D)             (None, 256, 256, 32) 320         input_24[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_507 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_438[0][0]                 
__________________________________________________________________________________________________
conv2d_439 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_507[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_508 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_439[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_93 (MaxPooling2D) (None, 128, 128, 32) 0           leaky_re_lu_508[0][0]            
__________________________________________________________________________________________________
dropout_208 (Dropout)           (None, 128, 128, 32) 0           max_pooling2d_93[0][0]           
__________________________________________________________________________________________________
conv2d_440 (Conv2D)             (None, 128, 128, 64) 18496       dropout_208[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_509 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_440[0][0]                 
__________________________________________________________________________________________________
conv2d_441 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_509[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_510 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_441[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_94 (MaxPooling2D) (None, 64, 64, 64)   0           leaky_re_lu_510[0][0]            
__________________________________________________________________________________________________
dropout_209 (Dropout)           (None, 64, 64, 64)   0           max_pooling2d_94[0][0]           
__________________________________________________________________________________________________
conv2d_442 (Conv2D)             (None, 64, 64, 128)  73856       dropout_209[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_511 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_442[0][0]                 
__________________________________________________________________________________________________
conv2d_443 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_511[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_512 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_443[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_95 (MaxPooling2D) (None, 32, 32, 128)  0           leaky_re_lu_512[0][0]            
__________________________________________________________________________________________________
dropout_210 (Dropout)           (None, 32, 32, 128)  0           max_pooling2d_95[0][0]           
__________________________________________________________________________________________________
conv2d_444 (Conv2D)             (None, 32, 32, 256)  295168      dropout_210[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_513 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_444[0][0]                 
__________________________________________________________________________________________________
conv2d_445 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_513[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_514 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_445[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_96 (MaxPooling2D) (None, 16, 16, 256)  0           leaky_re_lu_514[0][0]            
__________________________________________________________________________________________________
dropout_211 (Dropout)           (None, 16, 16, 256)  0           max_pooling2d_96[0][0]           
__________________________________________________________________________________________________
conv2d_446 (Conv2D)             (None, 16, 16, 512)  1180160     dropout_211[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_515 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_446[0][0]                 
__________________________________________________________________________________________________
conv2d_447 (Conv2D)             (None, 16, 16, 512)  2359808     leaky_re_lu_515[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_516 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_447[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_93 (Conv2DTran (None, 32, 32, 256)  1179904     leaky_re_lu_516[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_517 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_transpose_93[0][0]        
__________________________________________________________________________________________________
concatenate_93 (Concatenate)    (None, 32, 32, 512)  0           leaky_re_lu_517[0][0]            
                                                                 leaky_re_lu_514[0][0]            
__________________________________________________________________________________________________
dropout_212 (Dropout)           (None, 32, 32, 512)  0           concatenate_93[0][0]             
__________________________________________________________________________________________________
conv2d_448 (Conv2D)             (None, 32, 32, 256)  1179904     dropout_212[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_518 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_448[0][0]                 
__________________________________________________________________________________________________
conv2d_449 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_518[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_519 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_449[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_94 (Conv2DTran (None, 64, 64, 128)  295040      leaky_re_lu_519[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_520 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_94[0][0]        
__________________________________________________________________________________________________
concatenate_94 (Concatenate)    (None, 64, 64, 256)  0           leaky_re_lu_520[0][0]            
                                                                 leaky_re_lu_512[0][0]            
__________________________________________________________________________________________________
dropout_213 (Dropout)           (None, 64, 64, 256)  0           concatenate_94[0][0]             
__________________________________________________________________________________________________
conv2d_450 (Conv2D)             (None, 64, 64, 128)  295040      dropout_213[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_521 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_450[0][0]                 
__________________________________________________________________________________________________
conv2d_451 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_521[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_522 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_451[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_95 (Conv2DTran (None, 128, 128, 64) 73792       leaky_re_lu_522[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_523 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_95[0][0]        
__________________________________________________________________________________________________
concatenate_95 (Concatenate)    (None, 128, 128, 128 0           leaky_re_lu_523[0][0]            
                                                                 leaky_re_lu_510[0][0]            
__________________________________________________________________________________________________
dropout_214 (Dropout)           (None, 128, 128, 128 0           concatenate_95[0][0]             
__________________________________________________________________________________________________
conv2d_452 (Conv2D)             (None, 128, 128, 64) 73792       dropout_214[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_524 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_452[0][0]                 
__________________________________________________________________________________________________
conv2d_453 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_524[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_525 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_453[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_96 (Conv2DTran (None, 256, 256, 32) 18464       leaky_re_lu_525[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_526 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_96[0][0]        
__________________________________________________________________________________________________
concatenate_96 (Concatenate)    (None, 256, 256, 64) 0           leaky_re_lu_526[0][0]            
                                                                 leaky_re_lu_508[0][0]            
__________________________________________________________________________________________________
dropout_215 (Dropout)           (None, 256, 256, 64) 0           concatenate_96[0][0]             
__________________________________________________________________________________________________
dropout_216 (Dropout)           (None, 256, 256, 64) 0           dropout_215[0][0]                
__________________________________________________________________________________________________
conv2d_454 (Conv2D)             (None, 256, 256, 32) 18464       dropout_216[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_527 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_454[0][0]                 
__________________________________________________________________________________________________
conv2d_455 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_527[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_528 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_455[0][0]                 
__________________________________________________________________________________________________
conv2d_456 (Conv2D)             (None, 256, 256, 3)  99          leaky_re_lu_528[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 0.5694 - acc: 0.9210 - val_loss: 0.2319 - val_acc: 0.9428

Epoch 00001: val_acc improved from -inf to 0.94277, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.1966 - acc: 0.9360 - val_loss: 0.1923 - val_acc: 0.9433

Epoch 00002: val_acc improved from 0.94277 to 0.94326, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.1728 - acc: 0.9377 - val_loss: 0.1560 - val_acc: 0.9433

Epoch 00003: val_acc improved from 0.94326 to 0.94328, saving model to unn_grid.h5
Epoch 4/1000
 - 19s - loss: 0.1651 - acc: 0.9379 - val_loss: 0.1498 - val_acc: 0.9433

Epoch 00004: val_acc improved from 0.94328 to 0.94329, saving model to unn_grid.h5
Epoch 5/1000
 - 19s - loss: 0.1553 - acc: 0.9391 - val_loss: 0.1543 - val_acc: 0.9451

Epoch 00005: val_acc improved from 0.94329 to 0.94508, saving model to unn_grid.h5
Epoch 6/1000
 - 19s - loss: 0.1526 - acc: 0.9399 - val_loss: 0.1419 - val_acc: 0.9462

Epoch 00006: val_acc improved from 0.94508 to 0.94615, saving model to unn_grid.h5
Epoch 7/1000
 - 19s - loss: 0.1468 - acc: 0.9419 - val_loss: 0.1432 - val_acc: 0.9497

Epoch 00007: val_acc improved from 0.94615 to 0.94968, saving model to unn_grid.h5
Epoch 8/1000
 - 19s - loss: 0.1380 - acc: 0.9452 - val_loss: 0.1493 - val_acc: 0.9488

Epoch 00008: val_acc did not improve from 0.94968
Epoch 9/1000
 - 19s - loss: 0.1301 - acc: 0.9505 - val_loss: 0.1244 - val_acc: 0.9561

Epoch 00009: val_acc improved from 0.94968 to 0.95612, saving model to unn_grid.h5
Epoch 10/1000
 - 19s - loss: 0.1195 - acc: 0.9550 - val_loss: 0.1218 - val_acc: 0.9578

Epoch 00010: val_acc improved from 0.95612 to 0.95783, saving model to unn_grid.h5
Epoch 11/1000
 - 19s - loss: 0.1102 - acc: 0.9600 - val_loss: 0.1191 - val_acc: 0.9579

Epoch 00011: val_acc improved from 0.95783 to 0.95789, saving model to unn_grid.h5
Epoch 12/1000
 - 19s - loss: 0.0999 - acc: 0.9631 - val_loss: 0.1115 - val_acc: 0.9600

Epoch 00012: val_acc improved from 0.95789 to 0.96000, saving model to unn_grid.h5
Epoch 13/1000
 - 19s - loss: 0.0925 - acc: 0.9657 - val_loss: 0.1106 - val_acc: 0.9634

Epoch 00013: val_acc improved from 0.96000 to 0.96343, saving model to unn_grid.h5
Epoch 14/1000
 - 19s - loss: 0.0902 - acc: 0.9671 - val_loss: 0.0999 - val_acc: 0.9650

Epoch 00014: val_acc improved from 0.96343 to 0.96500, saving model to unn_grid.h5
Epoch 15/1000
 - 19s - loss: 0.0807 - acc: 0.9699 - val_loss: 0.0974 - val_acc: 0.9635

Epoch 00015: val_acc did not improve from 0.96500
Epoch 16/1000
 - 19s - loss: 0.0777 - acc: 0.9707 - val_loss: 0.1078 - val_acc: 0.9609

Epoch 00016: val_acc did not improve from 0.96500
Epoch 17/1000
 - 19s - loss: 0.0753 - acc: 0.9720 - val_loss: 0.0998 - val_acc: 0.9663

Epoch 00017: val_acc improved from 0.96500 to 0.96629, saving model to unn_grid.h5
Epoch 18/1000
 - 19s - loss: 0.0720 - acc: 0.9728 - val_loss: 0.0953 - val_acc: 0.9654

Epoch 00018: val_acc did not improve from 0.96629
Epoch 19/1000
 - 19s - loss: 0.0694 - acc: 0.9738 - val_loss: 0.0992 - val_acc: 0.9658

Epoch 00019: val_acc did not improve from 0.96629
Epoch 20/1000
 - 19s - loss: 0.0696 - acc: 0.9740 - val_loss: 0.1021 - val_acc: 0.9662

Epoch 00020: val_acc did not improve from 0.96629

Epoch 00020: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 21/1000
 - 19s - loss: 0.0554 - acc: 0.9784 - val_loss: 0.0929 - val_acc: 0.9680

Epoch 00021: val_acc improved from 0.96629 to 0.96797, saving model to unn_grid.h5
Epoch 22/1000
 - 19s - loss: 0.0524 - acc: 0.9794 - val_loss: 0.0967 - val_acc: 0.9681

Epoch 00022: val_acc improved from 0.96797 to 0.96807, saving model to unn_grid.h5
Epoch 23/1000
 - 19s - loss: 0.0514 - acc: 0.9798 - val_loss: 0.0949 - val_acc: 0.9682

Epoch 00023: val_acc improved from 0.96807 to 0.96819, saving model to unn_grid.h5
Epoch 24/1000
 - 19s - loss: 0.0503 - acc: 0.9803 - val_loss: 0.0981 - val_acc: 0.9684

Epoch 00024: val_acc improved from 0.96819 to 0.96837, saving model to unn_grid.h5
Epoch 25/1000
 - 19s - loss: 0.0490 - acc: 0.9808 - val_loss: 0.0990 - val_acc: 0.9681

Epoch 00025: val_acc did not improve from 0.96837
Epoch 26/1000
 - 19s - loss: 0.0485 - acc: 0.9809 - val_loss: 0.1002 - val_acc: 0.9681

Epoch 00026: val_acc did not improve from 0.96837
Epoch 27/1000
 - 19s - loss: 0.0476 - acc: 0.9814 - val_loss: 0.0980 - val_acc: 0.9681

Epoch 00027: val_acc did not improve from 0.96837

Epoch 00027: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 28/1000
 - 19s - loss: 0.0460 - acc: 0.9820 - val_loss: 0.0992 - val_acc: 0.9682

Epoch 00028: val_acc did not improve from 0.96837
Epoch 29/1000
 - 19s - loss: 0.0460 - acc: 0.9819 - val_loss: 0.0996 - val_acc: 0.9680

Epoch 00029: val_acc did not improve from 0.96837
Epoch 00029: early stopping
Model: "model_25"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_25 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_457 (Conv2D)             (None, 256, 256, 32) 320         input_25[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_529 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_457[0][0]                 
__________________________________________________________________________________________________
conv2d_458 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_529[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_530 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_458[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_97 (MaxPooling2D) (None, 128, 128, 32) 0           leaky_re_lu_530[0][0]            
__________________________________________________________________________________________________
dropout_217 (Dropout)           (None, 128, 128, 32) 0           max_pooling2d_97[0][0]           
__________________________________________________________________________________________________
conv2d_459 (Conv2D)             (None, 128, 128, 64) 18496       dropout_217[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_531 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_459[0][0]                 
__________________________________________________________________________________________________
conv2d_460 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_531[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_532 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_460[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_98 (MaxPooling2D) (None, 64, 64, 64)   0           leaky_re_lu_532[0][0]            
__________________________________________________________________________________________________
dropout_218 (Dropout)           (None, 64, 64, 64)   0           max_pooling2d_98[0][0]           
__________________________________________________________________________________________________
conv2d_461 (Conv2D)             (None, 64, 64, 128)  73856       dropout_218[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_533 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_461[0][0]                 
__________________________________________________________________________________________________
conv2d_462 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_533[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_534 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_462[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_99 (MaxPooling2D) (None, 32, 32, 128)  0           leaky_re_lu_534[0][0]            
__________________________________________________________________________________________________
dropout_219 (Dropout)           (None, 32, 32, 128)  0           max_pooling2d_99[0][0]           
__________________________________________________________________________________________________
conv2d_463 (Conv2D)             (None, 32, 32, 256)  295168      dropout_219[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_535 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_463[0][0]                 
__________________________________________________________________________________________________
conv2d_464 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_535[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_536 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_464[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_100 (MaxPooling2D (None, 16, 16, 256)  0           leaky_re_lu_536[0][0]            
__________________________________________________________________________________________________
dropout_220 (Dropout)           (None, 16, 16, 256)  0           max_pooling2d_100[0][0]          
__________________________________________________________________________________________________
conv2d_465 (Conv2D)             (None, 16, 16, 512)  1180160     dropout_220[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_537 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_465[0][0]                 
__________________________________________________________________________________________________
conv2d_466 (Conv2D)             (None, 16, 16, 512)  2359808     leaky_re_lu_537[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_538 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_466[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_97 (Conv2DTran (None, 32, 32, 256)  1179904     leaky_re_lu_538[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_539 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_transpose_97[0][0]        
__________________________________________________________________________________________________
concatenate_97 (Concatenate)    (None, 32, 32, 512)  0           leaky_re_lu_539[0][0]            
                                                                 leaky_re_lu_536[0][0]            
__________________________________________________________________________________________________
dropout_221 (Dropout)           (None, 32, 32, 512)  0           concatenate_97[0][0]             
__________________________________________________________________________________________________
conv2d_467 (Conv2D)             (None, 32, 32, 256)  1179904     dropout_221[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_540 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_467[0][0]                 
__________________________________________________________________________________________________
conv2d_468 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_540[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_541 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_468[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_98 (Conv2DTran (None, 64, 64, 128)  295040      leaky_re_lu_541[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_542 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_98[0][0]        
__________________________________________________________________________________________________
concatenate_98 (Concatenate)    (None, 64, 64, 256)  0           leaky_re_lu_542[0][0]            
                                                                 leaky_re_lu_534[0][0]            
__________________________________________________________________________________________________
dropout_222 (Dropout)           (None, 64, 64, 256)  0           concatenate_98[0][0]             
__________________________________________________________________________________________________
conv2d_469 (Conv2D)             (None, 64, 64, 128)  295040      dropout_222[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_543 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_469[0][0]                 
__________________________________________________________________________________________________
conv2d_470 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_543[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_544 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_470[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_99 (Conv2DTran (None, 128, 128, 64) 73792       leaky_re_lu_544[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_545 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_99[0][0]        
__________________________________________________________________________________________________
concatenate_99 (Concatenate)    (None, 128, 128, 128 0           leaky_re_lu_545[0][0]            
                                                                 leaky_re_lu_532[0][0]            
__________________________________________________________________________________________________
dropout_223 (Dropout)           (None, 128, 128, 128 0           concatenate_99[0][0]             
__________________________________________________________________________________________________
conv2d_471 (Conv2D)             (None, 128, 128, 64) 73792       dropout_223[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_546 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_471[0][0]                 
__________________________________________________________________________________________________
conv2d_472 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_546[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_547 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_472[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_100 (Conv2DTra (None, 256, 256, 32) 18464       leaky_re_lu_547[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_548 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_100[0][0]       
__________________________________________________________________________________________________
concatenate_100 (Concatenate)   (None, 256, 256, 64) 0           leaky_re_lu_548[0][0]            
                                                                 leaky_re_lu_530[0][0]            
__________________________________________________________________________________________________
dropout_224 (Dropout)           (None, 256, 256, 64) 0           concatenate_100[0][0]            
__________________________________________________________________________________________________
dropout_225 (Dropout)           (None, 256, 256, 64) 0           dropout_224[0][0]                
__________________________________________________________________________________________________
conv2d_473 (Conv2D)             (None, 256, 256, 32) 18464       dropout_225[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_549 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_473[0][0]                 
__________________________________________________________________________________________________
conv2d_474 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_549[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_550 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_474[0][0]                 
__________________________________________________________________________________________________
conv2d_475 (Conv2D)             (None, 256, 256, 3)  99          leaky_re_lu_550[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1213 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 0.6830 - acc: 0.9181 - val_loss: 0.3877 - val_acc: 0.8782

Epoch 00001: val_acc improved from -inf to 0.87821, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.2128 - acc: 0.9370 - val_loss: 0.2259 - val_acc: 0.9134

Epoch 00002: val_acc improved from 0.87821 to 0.91340, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.1774 - acc: 0.9396 - val_loss: 0.2253 - val_acc: 0.9135

Epoch 00003: val_acc improved from 0.91340 to 0.91348, saving model to unn_grid.h5
Epoch 4/1000
 - 19s - loss: 0.1667 - acc: 0.9402 - val_loss: 0.2107 - val_acc: 0.9135

Epoch 00004: val_acc improved from 0.91348 to 0.91348, saving model to unn_grid.h5
Epoch 5/1000
 - 19s - loss: 0.1613 - acc: 0.9403 - val_loss: 0.2124 - val_acc: 0.9135

Epoch 00005: val_acc did not improve from 0.91348

Epoch 00005: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 6/1000
 - 19s - loss: 0.1503 - acc: 0.9406 - val_loss: 0.2012 - val_acc: 0.9135

Epoch 00006: val_acc did not improve from 0.91348
Epoch 7/1000
 - 19s - loss: 0.1467 - acc: 0.9407 - val_loss: 0.2005 - val_acc: 0.9134

Epoch 00007: val_acc did not improve from 0.91348
Epoch 8/1000
 - 19s - loss: 0.1450 - acc: 0.9409 - val_loss: 0.1982 - val_acc: 0.9135

Epoch 00008: val_acc improved from 0.91348 to 0.91349, saving model to unn_grid.h5

Epoch 00008: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 9/1000
 - 19s - loss: 0.1427 - acc: 0.9411 - val_loss: 0.1978 - val_acc: 0.9134

Epoch 00009: val_acc did not improve from 0.91349
Epoch 10/1000
 - 19s - loss: 0.1423 - acc: 0.9412 - val_loss: 0.1975 - val_acc: 0.9133

Epoch 00010: val_acc did not improve from 0.91349
Epoch 11/1000
 - 19s - loss: 0.1419 - acc: 0.9412 - val_loss: 0.1966 - val_acc: 0.9134

Epoch 00011: val_acc did not improve from 0.91349

Epoch 00011: ReduceLROnPlateau reducing learning rate to 9.999999974752428e-08.
Epoch 12/1000
 - 19s - loss: 0.1415 - acc: 0.9412 - val_loss: 0.1969 - val_acc: 0.9134

Epoch 00012: val_acc did not improve from 0.91349
Epoch 13/1000
 - 19s - loss: 0.1416 - acc: 0.9412 - val_loss: 0.1971 - val_acc: 0.9134

Epoch 00013: val_acc did not improve from 0.91349
Epoch 00013: early stopping
scores= [[0.94593302 0.45337382 0.40869075]
 [0.93582602 0.33330832 0.3119443 ]
 [0.95986734 0.64962314 0.57892187]
 [0.93558513 0.33322472 0.31186717]
 [0.95149693 0.52931513 0.48150358]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]] parameters= (32, 'Adam', 0.2, 'glorot_uniform', 0.0001)
Model: "model_26"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_26 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_476 (Conv2D)             (None, 256, 256, 32) 320         input_26[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_551 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_476[0][0]                 
__________________________________________________________________________________________________
conv2d_477 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_551[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_552 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_477[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_101 (MaxPooling2D (None, 128, 128, 32) 0           leaky_re_lu_552[0][0]            
__________________________________________________________________________________________________
dropout_226 (Dropout)           (None, 128, 128, 32) 0           max_pooling2d_101[0][0]          
__________________________________________________________________________________________________
conv2d_478 (Conv2D)             (None, 128, 128, 64) 18496       dropout_226[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_553 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_478[0][0]                 
__________________________________________________________________________________________________
conv2d_479 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_553[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_554 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_479[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_102 (MaxPooling2D (None, 64, 64, 64)   0           leaky_re_lu_554[0][0]            
__________________________________________________________________________________________________
dropout_227 (Dropout)           (None, 64, 64, 64)   0           max_pooling2d_102[0][0]          
__________________________________________________________________________________________________
conv2d_480 (Conv2D)             (None, 64, 64, 128)  73856       dropout_227[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_555 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_480[0][0]                 
__________________________________________________________________________________________________
conv2d_481 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_555[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_556 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_481[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_103 (MaxPooling2D (None, 32, 32, 128)  0           leaky_re_lu_556[0][0]            
__________________________________________________________________________________________________
dropout_228 (Dropout)           (None, 32, 32, 128)  0           max_pooling2d_103[0][0]          
__________________________________________________________________________________________________
conv2d_482 (Conv2D)             (None, 32, 32, 256)  295168      dropout_228[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_557 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_482[0][0]                 
__________________________________________________________________________________________________
conv2d_483 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_557[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_558 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_483[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_104 (MaxPooling2D (None, 16, 16, 256)  0           leaky_re_lu_558[0][0]            
__________________________________________________________________________________________________
dropout_229 (Dropout)           (None, 16, 16, 256)  0           max_pooling2d_104[0][0]          
__________________________________________________________________________________________________
conv2d_484 (Conv2D)             (None, 16, 16, 512)  1180160     dropout_229[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_559 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_484[0][0]                 
__________________________________________________________________________________________________
conv2d_485 (Conv2D)             (None, 16, 16, 512)  2359808     leaky_re_lu_559[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_560 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_485[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_101 (Conv2DTra (None, 32, 32, 256)  1179904     leaky_re_lu_560[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_561 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_transpose_101[0][0]       
__________________________________________________________________________________________________
concatenate_101 (Concatenate)   (None, 32, 32, 512)  0           leaky_re_lu_561[0][0]            
                                                                 leaky_re_lu_558[0][0]            
__________________________________________________________________________________________________
dropout_230 (Dropout)           (None, 32, 32, 512)  0           concatenate_101[0][0]            
__________________________________________________________________________________________________
conv2d_486 (Conv2D)             (None, 32, 32, 256)  1179904     dropout_230[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_562 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_486[0][0]                 
__________________________________________________________________________________________________
conv2d_487 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_562[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_563 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_487[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_102 (Conv2DTra (None, 64, 64, 128)  295040      leaky_re_lu_563[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_564 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_102[0][0]       
__________________________________________________________________________________________________
concatenate_102 (Concatenate)   (None, 64, 64, 256)  0           leaky_re_lu_564[0][0]            
                                                                 leaky_re_lu_556[0][0]            
__________________________________________________________________________________________________
dropout_231 (Dropout)           (None, 64, 64, 256)  0           concatenate_102[0][0]            
__________________________________________________________________________________________________
conv2d_488 (Conv2D)             (None, 64, 64, 128)  295040      dropout_231[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_565 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_488[0][0]                 
__________________________________________________________________________________________________
conv2d_489 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_565[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_566 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_489[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_103 (Conv2DTra (None, 128, 128, 64) 73792       leaky_re_lu_566[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_567 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_103[0][0]       
__________________________________________________________________________________________________
concatenate_103 (Concatenate)   (None, 128, 128, 128 0           leaky_re_lu_567[0][0]            
                                                                 leaky_re_lu_554[0][0]            
__________________________________________________________________________________________________
dropout_232 (Dropout)           (None, 128, 128, 128 0           concatenate_103[0][0]            
__________________________________________________________________________________________________
conv2d_490 (Conv2D)             (None, 128, 128, 64) 73792       dropout_232[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_568 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_490[0][0]                 
__________________________________________________________________________________________________
conv2d_491 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_568[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_569 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_491[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_104 (Conv2DTra (None, 256, 256, 32) 18464       leaky_re_lu_569[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_570 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_104[0][0]       
__________________________________________________________________________________________________
concatenate_104 (Concatenate)   (None, 256, 256, 64) 0           leaky_re_lu_570[0][0]            
                                                                 leaky_re_lu_552[0][0]            
__________________________________________________________________________________________________
dropout_233 (Dropout)           (None, 256, 256, 64) 0           concatenate_104[0][0]            
__________________________________________________________________________________________________
dropout_234 (Dropout)           (None, 256, 256, 64) 0           dropout_233[0][0]                
__________________________________________________________________________________________________
conv2d_492 (Conv2D)             (None, 256, 256, 32) 18464       dropout_234[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_571 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_492[0][0]                 
__________________________________________________________________________________________________
conv2d_493 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_571[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_572 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_493[0][0]                 
__________________________________________________________________________________________________
conv2d_494 (Conv2D)             (None, 256, 256, 3)  99          leaky_re_lu_572[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 2.7648 - acc: 0.6551 - val_loss: 0.7036 - val_acc: 0.9400

Epoch 00001: val_acc improved from -inf to 0.94002, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.6208 - acc: 0.9218 - val_loss: 0.6045 - val_acc: 0.9432

Epoch 00002: val_acc improved from 0.94002 to 0.94325, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.5484 - acc: 0.9249 - val_loss: 0.5770 - val_acc: 0.9433

Epoch 00003: val_acc improved from 0.94325 to 0.94326, saving model to unn_grid.h5
Epoch 4/1000
 - 19s - loss: 0.4993 - acc: 0.9242 - val_loss: 0.4712 - val_acc: 0.9432

Epoch 00004: val_acc did not improve from 0.94326
Epoch 5/1000
 - 19s - loss: 0.4505 - acc: 0.9240 - val_loss: 0.3723 - val_acc: 0.9426

Epoch 00005: val_acc did not improve from 0.94326

Epoch 00005: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 6/1000
 - 19s - loss: 0.4116 - acc: 0.9248 - val_loss: 0.3501 - val_acc: 0.9414

Epoch 00006: val_acc did not improve from 0.94326
Epoch 7/1000
 - 19s - loss: 0.4044 - acc: 0.9251 - val_loss: 0.3391 - val_acc: 0.9400

Epoch 00007: val_acc did not improve from 0.94326
Epoch 8/1000
 - 19s - loss: 0.3973 - acc: 0.9253 - val_loss: 0.3320 - val_acc: 0.9407

Epoch 00008: val_acc did not improve from 0.94326

Epoch 00008: ReduceLROnPlateau reducing learning rate to 9.999999974752428e-08.
Epoch 00008: early stopping
Model: "model_27"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_27 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_495 (Conv2D)             (None, 256, 256, 32) 320         input_27[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_573 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_495[0][0]                 
__________________________________________________________________________________________________
conv2d_496 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_573[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_574 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_496[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_105 (MaxPooling2D (None, 128, 128, 32) 0           leaky_re_lu_574[0][0]            
__________________________________________________________________________________________________
dropout_235 (Dropout)           (None, 128, 128, 32) 0           max_pooling2d_105[0][0]          
__________________________________________________________________________________________________
conv2d_497 (Conv2D)             (None, 128, 128, 64) 18496       dropout_235[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_575 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_497[0][0]                 
__________________________________________________________________________________________________
conv2d_498 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_575[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_576 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_498[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_106 (MaxPooling2D (None, 64, 64, 64)   0           leaky_re_lu_576[0][0]            
__________________________________________________________________________________________________
dropout_236 (Dropout)           (None, 64, 64, 64)   0           max_pooling2d_106[0][0]          
__________________________________________________________________________________________________
conv2d_499 (Conv2D)             (None, 64, 64, 128)  73856       dropout_236[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_577 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_499[0][0]                 
__________________________________________________________________________________________________
conv2d_500 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_577[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_578 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_500[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_107 (MaxPooling2D (None, 32, 32, 128)  0           leaky_re_lu_578[0][0]            
__________________________________________________________________________________________________
dropout_237 (Dropout)           (None, 32, 32, 128)  0           max_pooling2d_107[0][0]          
__________________________________________________________________________________________________
conv2d_501 (Conv2D)             (None, 32, 32, 256)  295168      dropout_237[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_579 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_501[0][0]                 
__________________________________________________________________________________________________
conv2d_502 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_579[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_580 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_502[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_108 (MaxPooling2D (None, 16, 16, 256)  0           leaky_re_lu_580[0][0]            
__________________________________________________________________________________________________
dropout_238 (Dropout)           (None, 16, 16, 256)  0           max_pooling2d_108[0][0]          
__________________________________________________________________________________________________
conv2d_503 (Conv2D)             (None, 16, 16, 512)  1180160     dropout_238[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_581 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_503[0][0]                 
__________________________________________________________________________________________________
conv2d_504 (Conv2D)             (None, 16, 16, 512)  2359808     leaky_re_lu_581[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_582 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_504[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_105 (Conv2DTra (None, 32, 32, 256)  1179904     leaky_re_lu_582[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_583 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_transpose_105[0][0]       
__________________________________________________________________________________________________
concatenate_105 (Concatenate)   (None, 32, 32, 512)  0           leaky_re_lu_583[0][0]            
                                                                 leaky_re_lu_580[0][0]            
__________________________________________________________________________________________________
dropout_239 (Dropout)           (None, 32, 32, 512)  0           concatenate_105[0][0]            
__________________________________________________________________________________________________
conv2d_505 (Conv2D)             (None, 32, 32, 256)  1179904     dropout_239[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_584 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_505[0][0]                 
__________________________________________________________________________________________________
conv2d_506 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_584[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_585 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_506[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_106 (Conv2DTra (None, 64, 64, 128)  295040      leaky_re_lu_585[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_586 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_106[0][0]       
__________________________________________________________________________________________________
concatenate_106 (Concatenate)   (None, 64, 64, 256)  0           leaky_re_lu_586[0][0]            
                                                                 leaky_re_lu_578[0][0]            
__________________________________________________________________________________________________
dropout_240 (Dropout)           (None, 64, 64, 256)  0           concatenate_106[0][0]            
__________________________________________________________________________________________________
conv2d_507 (Conv2D)             (None, 64, 64, 128)  295040      dropout_240[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_587 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_507[0][0]                 
__________________________________________________________________________________________________
conv2d_508 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_587[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_588 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_508[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_107 (Conv2DTra (None, 128, 128, 64) 73792       leaky_re_lu_588[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_589 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_107[0][0]       
__________________________________________________________________________________________________
concatenate_107 (Concatenate)   (None, 128, 128, 128 0           leaky_re_lu_589[0][0]            
                                                                 leaky_re_lu_576[0][0]            
__________________________________________________________________________________________________
dropout_241 (Dropout)           (None, 128, 128, 128 0           concatenate_107[0][0]            
__________________________________________________________________________________________________
conv2d_509 (Conv2D)             (None, 128, 128, 64) 73792       dropout_241[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_590 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_509[0][0]                 
__________________________________________________________________________________________________
conv2d_510 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_590[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_591 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_510[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_108 (Conv2DTra (None, 256, 256, 32) 18464       leaky_re_lu_591[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_592 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_108[0][0]       
__________________________________________________________________________________________________
concatenate_108 (Concatenate)   (None, 256, 256, 64) 0           leaky_re_lu_592[0][0]            
                                                                 leaky_re_lu_574[0][0]            
__________________________________________________________________________________________________
dropout_242 (Dropout)           (None, 256, 256, 64) 0           concatenate_108[0][0]            
__________________________________________________________________________________________________
dropout_243 (Dropout)           (None, 256, 256, 64) 0           dropout_242[0][0]                
__________________________________________________________________________________________________
conv2d_511 (Conv2D)             (None, 256, 256, 32) 18464       dropout_243[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_593 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_511[0][0]                 
__________________________________________________________________________________________________
conv2d_512 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_593[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_594 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_512[0][0]                 
__________________________________________________________________________________________________
conv2d_513 (Conv2D)             (None, 256, 256, 3)  99          leaky_re_lu_594[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 1.8864 - acc: 0.7576 - val_loss: 0.7026 - val_acc: 0.9422

Epoch 00001: val_acc improved from -inf to 0.94215, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.6187 - acc: 0.9291 - val_loss: 0.6045 - val_acc: 0.9432

Epoch 00002: val_acc improved from 0.94215 to 0.94323, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.5245 - acc: 0.9308 - val_loss: 0.5715 - val_acc: 0.9432

Epoch 00003: val_acc improved from 0.94323 to 0.94324, saving model to unn_grid.h5
Epoch 4/1000
 - 19s - loss: 0.4743 - acc: 0.9302 - val_loss: 0.4518 - val_acc: 0.9416

Epoch 00004: val_acc did not improve from 0.94324
Epoch 5/1000
 - 19s - loss: 0.4126 - acc: 0.9297 - val_loss: 0.3780 - val_acc: 0.9371

Epoch 00005: val_acc did not improve from 0.94324

Epoch 00005: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 6/1000
 - 19s - loss: 0.3698 - acc: 0.9305 - val_loss: 0.3661 - val_acc: 0.9348

Epoch 00006: val_acc did not improve from 0.94324
Epoch 7/1000
 - 19s - loss: 0.3625 - acc: 0.9310 - val_loss: 0.3551 - val_acc: 0.9334

Epoch 00007: val_acc did not improve from 0.94324
Epoch 8/1000
 - 19s - loss: 0.3563 - acc: 0.9311 - val_loss: 0.3515 - val_acc: 0.9298

Epoch 00008: val_acc did not improve from 0.94324

Epoch 00008: ReduceLROnPlateau reducing learning rate to 9.999999974752428e-08.
Epoch 00008: early stopping
Model: "model_28"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_28 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_514 (Conv2D)             (None, 256, 256, 32) 320         input_28[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_595 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_514[0][0]                 
__________________________________________________________________________________________________
conv2d_515 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_595[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_596 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_515[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_109 (MaxPooling2D (None, 128, 128, 32) 0           leaky_re_lu_596[0][0]            
__________________________________________________________________________________________________
dropout_244 (Dropout)           (None, 128, 128, 32) 0           max_pooling2d_109[0][0]          
__________________________________________________________________________________________________
conv2d_516 (Conv2D)             (None, 128, 128, 64) 18496       dropout_244[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_597 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_516[0][0]                 
__________________________________________________________________________________________________
conv2d_517 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_597[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_598 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_517[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_110 (MaxPooling2D (None, 64, 64, 64)   0           leaky_re_lu_598[0][0]            
__________________________________________________________________________________________________
dropout_245 (Dropout)           (None, 64, 64, 64)   0           max_pooling2d_110[0][0]          
__________________________________________________________________________________________________
conv2d_518 (Conv2D)             (None, 64, 64, 128)  73856       dropout_245[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_599 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_518[0][0]                 
__________________________________________________________________________________________________
conv2d_519 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_599[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_600 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_519[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_111 (MaxPooling2D (None, 32, 32, 128)  0           leaky_re_lu_600[0][0]            
__________________________________________________________________________________________________
dropout_246 (Dropout)           (None, 32, 32, 128)  0           max_pooling2d_111[0][0]          
__________________________________________________________________________________________________
conv2d_520 (Conv2D)             (None, 32, 32, 256)  295168      dropout_246[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_601 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_520[0][0]                 
__________________________________________________________________________________________________
conv2d_521 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_601[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_602 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_521[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_112 (MaxPooling2D (None, 16, 16, 256)  0           leaky_re_lu_602[0][0]            
__________________________________________________________________________________________________
dropout_247 (Dropout)           (None, 16, 16, 256)  0           max_pooling2d_112[0][0]          
__________________________________________________________________________________________________
conv2d_522 (Conv2D)             (None, 16, 16, 512)  1180160     dropout_247[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_603 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_522[0][0]                 
__________________________________________________________________________________________________
conv2d_523 (Conv2D)             (None, 16, 16, 512)  2359808     leaky_re_lu_603[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_604 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_523[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_109 (Conv2DTra (None, 32, 32, 256)  1179904     leaky_re_lu_604[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_605 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_transpose_109[0][0]       
__________________________________________________________________________________________________
concatenate_109 (Concatenate)   (None, 32, 32, 512)  0           leaky_re_lu_605[0][0]            
                                                                 leaky_re_lu_602[0][0]            
__________________________________________________________________________________________________
dropout_248 (Dropout)           (None, 32, 32, 512)  0           concatenate_109[0][0]            
__________________________________________________________________________________________________
conv2d_524 (Conv2D)             (None, 32, 32, 256)  1179904     dropout_248[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_606 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_524[0][0]                 
__________________________________________________________________________________________________
conv2d_525 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_606[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_607 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_525[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_110 (Conv2DTra (None, 64, 64, 128)  295040      leaky_re_lu_607[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_608 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_110[0][0]       
__________________________________________________________________________________________________
concatenate_110 (Concatenate)   (None, 64, 64, 256)  0           leaky_re_lu_608[0][0]            
                                                                 leaky_re_lu_600[0][0]            
__________________________________________________________________________________________________
dropout_249 (Dropout)           (None, 64, 64, 256)  0           concatenate_110[0][0]            
__________________________________________________________________________________________________
conv2d_526 (Conv2D)             (None, 64, 64, 128)  295040      dropout_249[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_609 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_526[0][0]                 
__________________________________________________________________________________________________
conv2d_527 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_609[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_610 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_527[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_111 (Conv2DTra (None, 128, 128, 64) 73792       leaky_re_lu_610[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_611 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_111[0][0]       
__________________________________________________________________________________________________
concatenate_111 (Concatenate)   (None, 128, 128, 128 0           leaky_re_lu_611[0][0]            
                                                                 leaky_re_lu_598[0][0]            
__________________________________________________________________________________________________
dropout_250 (Dropout)           (None, 128, 128, 128 0           concatenate_111[0][0]            
__________________________________________________________________________________________________
conv2d_528 (Conv2D)             (None, 128, 128, 64) 73792       dropout_250[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_612 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_528[0][0]                 
__________________________________________________________________________________________________
conv2d_529 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_612[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_613 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_529[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_112 (Conv2DTra (None, 256, 256, 32) 18464       leaky_re_lu_613[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_614 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_112[0][0]       
__________________________________________________________________________________________________
concatenate_112 (Concatenate)   (None, 256, 256, 64) 0           leaky_re_lu_614[0][0]            
                                                                 leaky_re_lu_596[0][0]            
__________________________________________________________________________________________________
dropout_251 (Dropout)           (None, 256, 256, 64) 0           concatenate_112[0][0]            
__________________________________________________________________________________________________
dropout_252 (Dropout)           (None, 256, 256, 64) 0           dropout_251[0][0]                
__________________________________________________________________________________________________
conv2d_530 (Conv2D)             (None, 256, 256, 32) 18464       dropout_252[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_615 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_530[0][0]                 
__________________________________________________________________________________________________
conv2d_531 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_615[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_616 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_531[0][0]                 
__________________________________________________________________________________________________
conv2d_532 (Conv2D)             (None, 256, 256, 3)  99          leaky_re_lu_616[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 1.4615 - acc: 0.7773 - val_loss: 0.7085 - val_acc: 0.9410

Epoch 00001: val_acc improved from -inf to 0.94103, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.5977 - acc: 0.9222 - val_loss: 0.5636 - val_acc: 0.9427

Epoch 00002: val_acc improved from 0.94103 to 0.94267, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.4737 - acc: 0.9200 - val_loss: 0.4247 - val_acc: 0.9395

Epoch 00003: val_acc did not improve from 0.94267
Epoch 4/1000
 - 19s - loss: 0.4050 - acc: 0.9188 - val_loss: 0.3529 - val_acc: 0.9378

Epoch 00004: val_acc did not improve from 0.94267
Epoch 5/1000
 - 19s - loss: 0.3350 - acc: 0.9203 - val_loss: 0.2876 - val_acc: 0.9273

Epoch 00005: val_acc did not improve from 0.94267

Epoch 00005: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 6/1000
 - 19s - loss: 0.2970 - acc: 0.9225 - val_loss: 0.2898 - val_acc: 0.9266

Epoch 00006: val_acc did not improve from 0.94267
Epoch 7/1000
 - 19s - loss: 0.2910 - acc: 0.9226 - val_loss: 0.2844 - val_acc: 0.9239

Epoch 00007: val_acc did not improve from 0.94267
Epoch 00007: early stopping
Model: "model_29"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_29 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_533 (Conv2D)             (None, 256, 256, 32) 320         input_29[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_617 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_533[0][0]                 
__________________________________________________________________________________________________
conv2d_534 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_617[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_618 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_534[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_113 (MaxPooling2D (None, 128, 128, 32) 0           leaky_re_lu_618[0][0]            
__________________________________________________________________________________________________
dropout_253 (Dropout)           (None, 128, 128, 32) 0           max_pooling2d_113[0][0]          
__________________________________________________________________________________________________
conv2d_535 (Conv2D)             (None, 128, 128, 64) 18496       dropout_253[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_619 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_535[0][0]                 
__________________________________________________________________________________________________
conv2d_536 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_619[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_620 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_536[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_114 (MaxPooling2D (None, 64, 64, 64)   0           leaky_re_lu_620[0][0]            
__________________________________________________________________________________________________
dropout_254 (Dropout)           (None, 64, 64, 64)   0           max_pooling2d_114[0][0]          
__________________________________________________________________________________________________
conv2d_537 (Conv2D)             (None, 64, 64, 128)  73856       dropout_254[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_621 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_537[0][0]                 
__________________________________________________________________________________________________
conv2d_538 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_621[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_622 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_538[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_115 (MaxPooling2D (None, 32, 32, 128)  0           leaky_re_lu_622[0][0]            
__________________________________________________________________________________________________
dropout_255 (Dropout)           (None, 32, 32, 128)  0           max_pooling2d_115[0][0]          
__________________________________________________________________________________________________
conv2d_539 (Conv2D)             (None, 32, 32, 256)  295168      dropout_255[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_623 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_539[0][0]                 
__________________________________________________________________________________________________
conv2d_540 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_623[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_624 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_540[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_116 (MaxPooling2D (None, 16, 16, 256)  0           leaky_re_lu_624[0][0]            
__________________________________________________________________________________________________
dropout_256 (Dropout)           (None, 16, 16, 256)  0           max_pooling2d_116[0][0]          
__________________________________________________________________________________________________
conv2d_541 (Conv2D)             (None, 16, 16, 512)  1180160     dropout_256[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_625 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_541[0][0]                 
__________________________________________________________________________________________________
conv2d_542 (Conv2D)             (None, 16, 16, 512)  2359808     leaky_re_lu_625[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_626 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_542[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_113 (Conv2DTra (None, 32, 32, 256)  1179904     leaky_re_lu_626[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_627 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_transpose_113[0][0]       
__________________________________________________________________________________________________
concatenate_113 (Concatenate)   (None, 32, 32, 512)  0           leaky_re_lu_627[0][0]            
                                                                 leaky_re_lu_624[0][0]            
__________________________________________________________________________________________________
dropout_257 (Dropout)           (None, 32, 32, 512)  0           concatenate_113[0][0]            
__________________________________________________________________________________________________
conv2d_543 (Conv2D)             (None, 32, 32, 256)  1179904     dropout_257[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_628 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_543[0][0]                 
__________________________________________________________________________________________________
conv2d_544 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_628[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_629 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_544[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_114 (Conv2DTra (None, 64, 64, 128)  295040      leaky_re_lu_629[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_630 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_114[0][0]       
__________________________________________________________________________________________________
concatenate_114 (Concatenate)   (None, 64, 64, 256)  0           leaky_re_lu_630[0][0]            
                                                                 leaky_re_lu_622[0][0]            
__________________________________________________________________________________________________
dropout_258 (Dropout)           (None, 64, 64, 256)  0           concatenate_114[0][0]            
__________________________________________________________________________________________________
conv2d_545 (Conv2D)             (None, 64, 64, 128)  295040      dropout_258[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_631 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_545[0][0]                 
__________________________________________________________________________________________________
conv2d_546 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_631[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_632 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_546[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_115 (Conv2DTra (None, 128, 128, 64) 73792       leaky_re_lu_632[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_633 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_115[0][0]       
__________________________________________________________________________________________________
concatenate_115 (Concatenate)   (None, 128, 128, 128 0           leaky_re_lu_633[0][0]            
                                                                 leaky_re_lu_620[0][0]            
__________________________________________________________________________________________________
dropout_259 (Dropout)           (None, 128, 128, 128 0           concatenate_115[0][0]            
__________________________________________________________________________________________________
conv2d_547 (Conv2D)             (None, 128, 128, 64) 73792       dropout_259[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_634 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_547[0][0]                 
__________________________________________________________________________________________________
conv2d_548 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_634[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_635 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_548[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_116 (Conv2DTra (None, 256, 256, 32) 18464       leaky_re_lu_635[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_636 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_116[0][0]       
__________________________________________________________________________________________________
concatenate_116 (Concatenate)   (None, 256, 256, 64) 0           leaky_re_lu_636[0][0]            
                                                                 leaky_re_lu_618[0][0]            
__________________________________________________________________________________________________
dropout_260 (Dropout)           (None, 256, 256, 64) 0           concatenate_116[0][0]            
__________________________________________________________________________________________________
dropout_261 (Dropout)           (None, 256, 256, 64) 0           dropout_260[0][0]                
__________________________________________________________________________________________________
conv2d_549 (Conv2D)             (None, 256, 256, 32) 18464       dropout_261[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_637 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_549[0][0]                 
__________________________________________________________________________________________________
conv2d_550 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_637[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_638 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_550[0][0]                 
__________________________________________________________________________________________________
conv2d_551 (Conv2D)             (None, 256, 256, 3)  99          leaky_re_lu_638[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 1.6835 - acc: 0.7832 - val_loss: 0.7073 - val_acc: 0.9407

Epoch 00001: val_acc improved from -inf to 0.94068, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.6543 - acc: 0.9314 - val_loss: 0.6189 - val_acc: 0.9423

Epoch 00002: val_acc improved from 0.94068 to 0.94228, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.5536 - acc: 0.9302 - val_loss: 0.5470 - val_acc: 0.9432

Epoch 00003: val_acc improved from 0.94228 to 0.94324, saving model to unn_grid.h5
Epoch 4/1000
 - 19s - loss: 0.4980 - acc: 0.9287 - val_loss: 0.4139 - val_acc: 0.9428

Epoch 00004: val_acc did not improve from 0.94324
Epoch 5/1000
 - 19s - loss: 0.4397 - acc: 0.9267 - val_loss: 0.2768 - val_acc: 0.9325

Epoch 00005: val_acc did not improve from 0.94324
Epoch 6/1000
 - 19s - loss: 0.3734 - acc: 0.9273 - val_loss: 0.3057 - val_acc: 0.9007

Epoch 00006: val_acc did not improve from 0.94324

Epoch 00006: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 7/1000
 - 19s - loss: 0.3320 - acc: 0.9286 - val_loss: 0.3127 - val_acc: 0.8927

Epoch 00007: val_acc did not improve from 0.94324
Epoch 8/1000
 - 19s - loss: 0.3251 - acc: 0.9288 - val_loss: 0.3322 - val_acc: 0.8807

Epoch 00008: val_acc did not improve from 0.94324
Epoch 00008: early stopping
Model: "model_30"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_30 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_552 (Conv2D)             (None, 256, 256, 32) 320         input_30[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_639 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_552[0][0]                 
__________________________________________________________________________________________________
conv2d_553 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_639[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_640 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_553[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_117 (MaxPooling2D (None, 128, 128, 32) 0           leaky_re_lu_640[0][0]            
__________________________________________________________________________________________________
dropout_262 (Dropout)           (None, 128, 128, 32) 0           max_pooling2d_117[0][0]          
__________________________________________________________________________________________________
conv2d_554 (Conv2D)             (None, 128, 128, 64) 18496       dropout_262[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_641 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_554[0][0]                 
__________________________________________________________________________________________________
conv2d_555 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_641[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_642 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_555[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_118 (MaxPooling2D (None, 64, 64, 64)   0           leaky_re_lu_642[0][0]            
__________________________________________________________________________________________________
dropout_263 (Dropout)           (None, 64, 64, 64)   0           max_pooling2d_118[0][0]          
__________________________________________________________________________________________________
conv2d_556 (Conv2D)             (None, 64, 64, 128)  73856       dropout_263[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_643 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_556[0][0]                 
__________________________________________________________________________________________________
conv2d_557 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_643[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_644 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_557[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_119 (MaxPooling2D (None, 32, 32, 128)  0           leaky_re_lu_644[0][0]            
__________________________________________________________________________________________________
dropout_264 (Dropout)           (None, 32, 32, 128)  0           max_pooling2d_119[0][0]          
__________________________________________________________________________________________________
conv2d_558 (Conv2D)             (None, 32, 32, 256)  295168      dropout_264[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_645 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_558[0][0]                 
__________________________________________________________________________________________________
conv2d_559 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_645[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_646 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_559[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_120 (MaxPooling2D (None, 16, 16, 256)  0           leaky_re_lu_646[0][0]            
__________________________________________________________________________________________________
dropout_265 (Dropout)           (None, 16, 16, 256)  0           max_pooling2d_120[0][0]          
__________________________________________________________________________________________________
conv2d_560 (Conv2D)             (None, 16, 16, 512)  1180160     dropout_265[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_647 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_560[0][0]                 
__________________________________________________________________________________________________
conv2d_561 (Conv2D)             (None, 16, 16, 512)  2359808     leaky_re_lu_647[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_648 (LeakyReLU)     (None, 16, 16, 512)  0           conv2d_561[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_117 (Conv2DTra (None, 32, 32, 256)  1179904     leaky_re_lu_648[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_649 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_transpose_117[0][0]       
__________________________________________________________________________________________________
concatenate_117 (Concatenate)   (None, 32, 32, 512)  0           leaky_re_lu_649[0][0]            
                                                                 leaky_re_lu_646[0][0]            
__________________________________________________________________________________________________
dropout_266 (Dropout)           (None, 32, 32, 512)  0           concatenate_117[0][0]            
__________________________________________________________________________________________________
conv2d_562 (Conv2D)             (None, 32, 32, 256)  1179904     dropout_266[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_650 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_562[0][0]                 
__________________________________________________________________________________________________
conv2d_563 (Conv2D)             (None, 32, 32, 256)  590080      leaky_re_lu_650[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_651 (LeakyReLU)     (None, 32, 32, 256)  0           conv2d_563[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_118 (Conv2DTra (None, 64, 64, 128)  295040      leaky_re_lu_651[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_652 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_transpose_118[0][0]       
__________________________________________________________________________________________________
concatenate_118 (Concatenate)   (None, 64, 64, 256)  0           leaky_re_lu_652[0][0]            
                                                                 leaky_re_lu_644[0][0]            
__________________________________________________________________________________________________
dropout_267 (Dropout)           (None, 64, 64, 256)  0           concatenate_118[0][0]            
__________________________________________________________________________________________________
conv2d_564 (Conv2D)             (None, 64, 64, 128)  295040      dropout_267[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_653 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_564[0][0]                 
__________________________________________________________________________________________________
conv2d_565 (Conv2D)             (None, 64, 64, 128)  147584      leaky_re_lu_653[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_654 (LeakyReLU)     (None, 64, 64, 128)  0           conv2d_565[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_119 (Conv2DTra (None, 128, 128, 64) 73792       leaky_re_lu_654[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_655 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_transpose_119[0][0]       
__________________________________________________________________________________________________
concatenate_119 (Concatenate)   (None, 128, 128, 128 0           leaky_re_lu_655[0][0]            
                                                                 leaky_re_lu_642[0][0]            
__________________________________________________________________________________________________
dropout_268 (Dropout)           (None, 128, 128, 128 0           concatenate_119[0][0]            
__________________________________________________________________________________________________
conv2d_566 (Conv2D)             (None, 128, 128, 64) 73792       dropout_268[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_656 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_566[0][0]                 
__________________________________________________________________________________________________
conv2d_567 (Conv2D)             (None, 128, 128, 64) 36928       leaky_re_lu_656[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_657 (LeakyReLU)     (None, 128, 128, 64) 0           conv2d_567[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_120 (Conv2DTra (None, 256, 256, 32) 18464       leaky_re_lu_657[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_658 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_transpose_120[0][0]       
__________________________________________________________________________________________________
concatenate_120 (Concatenate)   (None, 256, 256, 64) 0           leaky_re_lu_658[0][0]            
                                                                 leaky_re_lu_640[0][0]            
__________________________________________________________________________________________________
dropout_269 (Dropout)           (None, 256, 256, 64) 0           concatenate_120[0][0]            
__________________________________________________________________________________________________
dropout_270 (Dropout)           (None, 256, 256, 64) 0           dropout_269[0][0]                
__________________________________________________________________________________________________
conv2d_568 (Conv2D)             (None, 256, 256, 32) 18464       dropout_270[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_659 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_568[0][0]                 
__________________________________________________________________________________________________
conv2d_569 (Conv2D)             (None, 256, 256, 32) 9248        leaky_re_lu_659[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_660 (LeakyReLU)     (None, 256, 256, 32) 0           conv2d_569[0][0]                 
__________________________________________________________________________________________________
conv2d_570 (Conv2D)             (None, 256, 256, 3)  99          leaky_re_lu_660[0][0]            
==================================================================================================
Total params: 8,629,987
Trainable params: 8,629,987
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1213 samples, validate on 135 samples
Epoch 1/1000
 - 21s - loss: 1.7326 - acc: 0.7765 - val_loss: 0.5577 - val_acc: 0.9108

Epoch 00001: val_acc improved from -inf to 0.91080, saving model to unn_grid.h5
Epoch 2/1000
 - 19s - loss: 0.6300 - acc: 0.9344 - val_loss: 0.4637 - val_acc: 0.9123

Epoch 00002: val_acc improved from 0.91080 to 0.91232, saving model to unn_grid.h5
Epoch 3/1000
 - 19s - loss: 0.5375 - acc: 0.9366 - val_loss: 0.3680 - val_acc: 0.9135

Epoch 00003: val_acc improved from 0.91232 to 0.91347, saving model to unn_grid.h5
Epoch 4/1000
 - 19s - loss: 0.5020 - acc: 0.9353 - val_loss: 0.3175 - val_acc: 0.9135

Epoch 00004: val_acc did not improve from 0.91347
Epoch 5/1000
 - 19s - loss: 0.4514 - acc: 0.9328 - val_loss: 0.2890 - val_acc: 0.9124

Epoch 00005: val_acc did not improve from 0.91347
Epoch 6/1000
 - 19s - loss: 0.3611 - acc: 0.9299 - val_loss: 0.3448 - val_acc: 0.9077

Epoch 00006: val_acc did not improve from 0.91347

Epoch 00006: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 7/1000
 - 19s - loss: 0.3022 - acc: 0.9306 - val_loss: 0.2862 - val_acc: 0.9101

Epoch 00007: val_acc did not improve from 0.91347
Epoch 8/1000
 - 19s - loss: 0.2918 - acc: 0.9313 - val_loss: 0.2911 - val_acc: 0.9092

Epoch 00008: val_acc did not improve from 0.91347
Epoch 00008: early stopping
scores= [[0.94593302 0.45337382 0.40869075]
 [0.93582602 0.33330832 0.3119443 ]
 [0.95986734 0.64962314 0.57892187]
 [0.93558513 0.33322472 0.31186717]
 [0.95149693 0.52931513 0.48150358]
 [0.93571018 0.33331998 0.31195914]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]] parameters= (32, 'Adam', 0.2, 'glorot_uniform', 1e-05)
Model: "model_31"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_31 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_571 (Conv2D)             (None, 256, 256, 64) 640         input_31[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_661 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_571[0][0]                 
__________________________________________________________________________________________________
conv2d_572 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_661[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_662 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_572[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_121 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_662[0][0]            
__________________________________________________________________________________________________
dropout_271 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_121[0][0]          
__________________________________________________________________________________________________
conv2d_573 (Conv2D)             (None, 128, 128, 128 73856       dropout_271[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_663 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_573[0][0]                 
__________________________________________________________________________________________________
conv2d_574 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_663[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_664 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_574[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_122 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_664[0][0]            
__________________________________________________________________________________________________
dropout_272 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_122[0][0]          
__________________________________________________________________________________________________
conv2d_575 (Conv2D)             (None, 64, 64, 256)  295168      dropout_272[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_665 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_575[0][0]                 
__________________________________________________________________________________________________
conv2d_576 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_665[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_666 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_576[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_123 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_666[0][0]            
__________________________________________________________________________________________________
dropout_273 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_123[0][0]          
__________________________________________________________________________________________________
conv2d_577 (Conv2D)             (None, 32, 32, 512)  1180160     dropout_273[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_667 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_577[0][0]                 
__________________________________________________________________________________________________
conv2d_578 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_667[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_668 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_578[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_124 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_668[0][0]            
__________________________________________________________________________________________________
dropout_274 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_124[0][0]          
__________________________________________________________________________________________________
conv2d_579 (Conv2D)             (None, 16, 16, 1024) 4719616     dropout_274[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_669 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_579[0][0]                 
__________________________________________________________________________________________________
conv2d_580 (Conv2D)             (None, 16, 16, 1024) 9438208     leaky_re_lu_669[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_670 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_580[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_121 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_670[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_671 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_transpose_121[0][0]       
__________________________________________________________________________________________________
concatenate_121 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_671[0][0]            
                                                                 leaky_re_lu_668[0][0]            
__________________________________________________________________________________________________
dropout_275 (Dropout)           (None, 32, 32, 1024) 0           concatenate_121[0][0]            
__________________________________________________________________________________________________
conv2d_581 (Conv2D)             (None, 32, 32, 512)  4719104     dropout_275[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_672 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_581[0][0]                 
__________________________________________________________________________________________________
conv2d_582 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_672[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_673 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_582[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_122 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_673[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_674 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_transpose_122[0][0]       
__________________________________________________________________________________________________
concatenate_122 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_674[0][0]            
                                                                 leaky_re_lu_666[0][0]            
__________________________________________________________________________________________________
dropout_276 (Dropout)           (None, 64, 64, 512)  0           concatenate_122[0][0]            
__________________________________________________________________________________________________
conv2d_583 (Conv2D)             (None, 64, 64, 256)  1179904     dropout_276[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_675 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_583[0][0]                 
__________________________________________________________________________________________________
conv2d_584 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_675[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_676 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_584[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_123 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_676[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_677 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_transpose_123[0][0]       
__________________________________________________________________________________________________
concatenate_123 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_677[0][0]            
                                                                 leaky_re_lu_664[0][0]            
__________________________________________________________________________________________________
dropout_277 (Dropout)           (None, 128, 128, 256 0           concatenate_123[0][0]            
__________________________________________________________________________________________________
conv2d_585 (Conv2D)             (None, 128, 128, 128 295040      dropout_277[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_678 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_585[0][0]                 
__________________________________________________________________________________________________
conv2d_586 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_678[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_679 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_586[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_124 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_679[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_680 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_transpose_124[0][0]       
__________________________________________________________________________________________________
concatenate_124 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_680[0][0]            
                                                                 leaky_re_lu_662[0][0]            
__________________________________________________________________________________________________
dropout_278 (Dropout)           (None, 256, 256, 128 0           concatenate_124[0][0]            
__________________________________________________________________________________________________
dropout_279 (Dropout)           (None, 256, 256, 128 0           dropout_278[0][0]                
__________________________________________________________________________________________________
conv2d_587 (Conv2D)             (None, 256, 256, 64) 73792       dropout_279[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_681 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_587[0][0]                 
__________________________________________________________________________________________________
conv2d_588 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_681[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_682 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_588[0][0]                 
__________________________________________________________________________________________________
conv2d_589 (Conv2D)             (None, 256, 256, 3)  195         leaky_re_lu_682[0][0]            
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 52s - loss: 0.4154 - acc: 0.9280 - val_loss: 0.1746 - val_acc: 0.9432

Epoch 00001: val_acc improved from -inf to 0.94325, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.1979 - acc: 0.9316 - val_loss: 0.1735 - val_acc: 0.9433

Epoch 00002: val_acc improved from 0.94325 to 0.94329, saving model to unn_grid.h5
Epoch 3/1000
 - 46s - loss: 0.1880 - acc: 0.9322 - val_loss: 0.1695 - val_acc: 0.9433

Epoch 00003: val_acc improved from 0.94329 to 0.94329, saving model to unn_grid.h5
Epoch 4/1000
 - 46s - loss: 0.1761 - acc: 0.9323 - val_loss: 0.1795 - val_acc: 0.9433

Epoch 00004: val_acc did not improve from 0.94329

Epoch 00004: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 5/1000
 - 46s - loss: 0.1656 - acc: 0.9336 - val_loss: 0.1583 - val_acc: 0.9441

Epoch 00005: val_acc improved from 0.94329 to 0.94414, saving model to unn_grid.h5
Epoch 6/1000
 - 46s - loss: 0.1600 - acc: 0.9380 - val_loss: 0.1527 - val_acc: 0.9385

Epoch 00006: val_acc did not improve from 0.94414
Epoch 7/1000
 - 46s - loss: 0.1528 - acc: 0.9444 - val_loss: 0.1654 - val_acc: 0.9368

Epoch 00007: val_acc did not improve from 0.94414
Epoch 8/1000
 - 46s - loss: 0.1463 - acc: 0.9468 - val_loss: 0.1577 - val_acc: 0.9380

Epoch 00008: val_acc did not improve from 0.94414

Epoch 00008: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 9/1000
 - 46s - loss: 0.1411 - acc: 0.9483 - val_loss: 0.1615 - val_acc: 0.9367

Epoch 00009: val_acc did not improve from 0.94414
Epoch 10/1000
 - 46s - loss: 0.1407 - acc: 0.9482 - val_loss: 0.1600 - val_acc: 0.9368

Epoch 00010: val_acc did not improve from 0.94414
Epoch 00010: early stopping
Model: "model_32"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_32 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_590 (Conv2D)             (None, 256, 256, 64) 640         input_32[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_683 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_590[0][0]                 
__________________________________________________________________________________________________
conv2d_591 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_683[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_684 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_591[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_125 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_684[0][0]            
__________________________________________________________________________________________________
dropout_280 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_125[0][0]          
__________________________________________________________________________________________________
conv2d_592 (Conv2D)             (None, 128, 128, 128 73856       dropout_280[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_685 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_592[0][0]                 
__________________________________________________________________________________________________
conv2d_593 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_685[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_686 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_593[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_126 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_686[0][0]            
__________________________________________________________________________________________________
dropout_281 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_126[0][0]          
__________________________________________________________________________________________________
conv2d_594 (Conv2D)             (None, 64, 64, 256)  295168      dropout_281[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_687 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_594[0][0]                 
__________________________________________________________________________________________________
conv2d_595 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_687[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_688 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_595[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_127 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_688[0][0]            
__________________________________________________________________________________________________
dropout_282 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_127[0][0]          
__________________________________________________________________________________________________
conv2d_596 (Conv2D)             (None, 32, 32, 512)  1180160     dropout_282[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_689 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_596[0][0]                 
__________________________________________________________________________________________________
conv2d_597 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_689[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_690 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_597[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_128 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_690[0][0]            
__________________________________________________________________________________________________
dropout_283 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_128[0][0]          
__________________________________________________________________________________________________
conv2d_598 (Conv2D)             (None, 16, 16, 1024) 4719616     dropout_283[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_691 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_598[0][0]                 
__________________________________________________________________________________________________
conv2d_599 (Conv2D)             (None, 16, 16, 1024) 9438208     leaky_re_lu_691[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_692 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_599[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_125 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_692[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_693 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_transpose_125[0][0]       
__________________________________________________________________________________________________
concatenate_125 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_693[0][0]            
                                                                 leaky_re_lu_690[0][0]            
__________________________________________________________________________________________________
dropout_284 (Dropout)           (None, 32, 32, 1024) 0           concatenate_125[0][0]            
__________________________________________________________________________________________________
conv2d_600 (Conv2D)             (None, 32, 32, 512)  4719104     dropout_284[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_694 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_600[0][0]                 
__________________________________________________________________________________________________
conv2d_601 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_694[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_695 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_601[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_126 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_695[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_696 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_transpose_126[0][0]       
__________________________________________________________________________________________________
concatenate_126 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_696[0][0]            
                                                                 leaky_re_lu_688[0][0]            
__________________________________________________________________________________________________
dropout_285 (Dropout)           (None, 64, 64, 512)  0           concatenate_126[0][0]            
__________________________________________________________________________________________________
conv2d_602 (Conv2D)             (None, 64, 64, 256)  1179904     dropout_285[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_697 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_602[0][0]                 
__________________________________________________________________________________________________
conv2d_603 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_697[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_698 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_603[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_127 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_698[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_699 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_transpose_127[0][0]       
__________________________________________________________________________________________________
concatenate_127 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_699[0][0]            
                                                                 leaky_re_lu_686[0][0]            
__________________________________________________________________________________________________
dropout_286 (Dropout)           (None, 128, 128, 256 0           concatenate_127[0][0]            
__________________________________________________________________________________________________
conv2d_604 (Conv2D)             (None, 128, 128, 128 295040      dropout_286[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_700 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_604[0][0]                 
__________________________________________________________________________________________________
conv2d_605 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_700[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_701 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_605[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_128 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_701[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_702 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_transpose_128[0][0]       
__________________________________________________________________________________________________
concatenate_128 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_702[0][0]            
                                                                 leaky_re_lu_684[0][0]            
__________________________________________________________________________________________________
dropout_287 (Dropout)           (None, 256, 256, 128 0           concatenate_128[0][0]            
__________________________________________________________________________________________________
dropout_288 (Dropout)           (None, 256, 256, 128 0           dropout_287[0][0]                
__________________________________________________________________________________________________
conv2d_606 (Conv2D)             (None, 256, 256, 64) 73792       dropout_288[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_703 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_606[0][0]                 
__________________________________________________________________________________________________
conv2d_607 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_703[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_704 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_607[0][0]                 
__________________________________________________________________________________________________
conv2d_608 (Conv2D)             (None, 256, 256, 3)  195         leaky_re_lu_704[0][0]            
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 47s - loss: 0.3689 - acc: 0.9331 - val_loss: 0.2725 - val_acc: 0.9281

Epoch 00001: val_acc improved from -inf to 0.92810, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.1816 - acc: 0.9361 - val_loss: 0.1993 - val_acc: 0.9432

Epoch 00002: val_acc improved from 0.92810 to 0.94321, saving model to unn_grid.h5
Epoch 3/1000
 - 46s - loss: 0.1718 - acc: 0.9372 - val_loss: 0.1860 - val_acc: 0.9420

Epoch 00003: val_acc did not improve from 0.94321
Epoch 4/1000
 - 46s - loss: 0.1612 - acc: 0.9395 - val_loss: 0.1952 - val_acc: 0.9440

Epoch 00004: val_acc improved from 0.94321 to 0.94397, saving model to unn_grid.h5
Epoch 5/1000
 - 46s - loss: 0.1547 - acc: 0.9434 - val_loss: 0.1672 - val_acc: 0.9489

Epoch 00005: val_acc improved from 0.94397 to 0.94895, saving model to unn_grid.h5
Epoch 6/1000
 - 46s - loss: 0.1432 - acc: 0.9473 - val_loss: 0.1577 - val_acc: 0.9368

Epoch 00006: val_acc did not improve from 0.94895
Epoch 7/1000
 - 46s - loss: 0.1364 - acc: 0.9502 - val_loss: 0.1275 - val_acc: 0.9535

Epoch 00007: val_acc improved from 0.94895 to 0.95351, saving model to unn_grid.h5
Epoch 8/1000
 - 46s - loss: 0.1254 - acc: 0.9548 - val_loss: 0.1179 - val_acc: 0.9579

Epoch 00008: val_acc improved from 0.95351 to 0.95786, saving model to unn_grid.h5
Epoch 9/1000
 - 46s - loss: 0.1154 - acc: 0.9588 - val_loss: 0.1333 - val_acc: 0.9479

Epoch 00009: val_acc did not improve from 0.95786
Epoch 10/1000
 - 46s - loss: 0.1041 - acc: 0.9625 - val_loss: 0.1133 - val_acc: 0.9614

Epoch 00010: val_acc improved from 0.95786 to 0.96137, saving model to unn_grid.h5
Epoch 11/1000
 - 46s - loss: 0.1002 - acc: 0.9632 - val_loss: 0.1113 - val_acc: 0.9621

Epoch 00011: val_acc improved from 0.96137 to 0.96210, saving model to unn_grid.h5
Epoch 12/1000
 - 46s - loss: 0.0907 - acc: 0.9672 - val_loss: 0.1079 - val_acc: 0.9600

Epoch 00012: val_acc did not improve from 0.96210
Epoch 13/1000
 - 46s - loss: 0.0847 - acc: 0.9689 - val_loss: 0.0953 - val_acc: 0.9648

Epoch 00013: val_acc improved from 0.96210 to 0.96480, saving model to unn_grid.h5
Epoch 14/1000
 - 46s - loss: 0.0804 - acc: 0.9706 - val_loss: 0.1007 - val_acc: 0.9625

Epoch 00014: val_acc did not improve from 0.96480
Epoch 15/1000
 - 46s - loss: 0.0762 - acc: 0.9721 - val_loss: 0.0956 - val_acc: 0.9649

Epoch 00015: val_acc improved from 0.96480 to 0.96488, saving model to unn_grid.h5
Epoch 16/1000
 - 46s - loss: 0.0761 - acc: 0.9721 - val_loss: 0.0912 - val_acc: 0.9661

Epoch 00016: val_acc improved from 0.96488 to 0.96611, saving model to unn_grid.h5
Epoch 17/1000
 - 46s - loss: 0.0694 - acc: 0.9745 - val_loss: 0.0985 - val_acc: 0.9647

Epoch 00017: val_acc did not improve from 0.96611
Epoch 18/1000
 - 46s - loss: 0.0657 - acc: 0.9757 - val_loss: 0.1136 - val_acc: 0.9596

Epoch 00018: val_acc did not improve from 0.96611
Epoch 19/1000
 - 46s - loss: 0.0625 - acc: 0.9765 - val_loss: 0.0913 - val_acc: 0.9665

Epoch 00019: val_acc improved from 0.96611 to 0.96649, saving model to unn_grid.h5
Epoch 20/1000
 - 46s - loss: 0.0565 - acc: 0.9787 - val_loss: 0.1040 - val_acc: 0.9665

Epoch 00020: val_acc did not improve from 0.96649
Epoch 21/1000
 - 46s - loss: 0.0551 - acc: 0.9790 - val_loss: 0.1012 - val_acc: 0.9660

Epoch 00021: val_acc did not improve from 0.96649
Epoch 22/1000
 - 46s - loss: 0.0559 - acc: 0.9791 - val_loss: 0.0933 - val_acc: 0.9667

Epoch 00022: val_acc improved from 0.96649 to 0.96666, saving model to unn_grid.h5
Epoch 23/1000
 - 46s - loss: 0.0500 - acc: 0.9812 - val_loss: 0.1023 - val_acc: 0.9678

Epoch 00023: val_acc improved from 0.96666 to 0.96779, saving model to unn_grid.h5
Epoch 24/1000
 - 46s - loss: 0.0503 - acc: 0.9811 - val_loss: 0.0892 - val_acc: 0.9680

Epoch 00024: val_acc improved from 0.96779 to 0.96798, saving model to unn_grid.h5
Epoch 25/1000
 - 46s - loss: 0.0456 - acc: 0.9828 - val_loss: 0.1128 - val_acc: 0.9639

Epoch 00025: val_acc did not improve from 0.96798
Epoch 26/1000
 - 46s - loss: 0.0417 - acc: 0.9841 - val_loss: 0.0980 - val_acc: 0.9673

Epoch 00026: val_acc did not improve from 0.96798
Epoch 27/1000
 - 46s - loss: 0.0400 - acc: 0.9847 - val_loss: 0.1131 - val_acc: 0.9657

Epoch 00027: val_acc did not improve from 0.96798

Epoch 00027: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 28/1000
 - 46s - loss: 0.0322 - acc: 0.9874 - val_loss: 0.1097 - val_acc: 0.9674

Epoch 00028: val_acc did not improve from 0.96798
Epoch 29/1000
 - 46s - loss: 0.0286 - acc: 0.9887 - val_loss: 0.1158 - val_acc: 0.9681

Epoch 00029: val_acc improved from 0.96798 to 0.96806, saving model to unn_grid.h5
Epoch 30/1000
 - 46s - loss: 0.0279 - acc: 0.9889 - val_loss: 0.1211 - val_acc: 0.9678

Epoch 00030: val_acc did not improve from 0.96806

Epoch 00030: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 31/1000
 - 46s - loss: 0.0265 - acc: 0.9895 - val_loss: 0.1215 - val_acc: 0.9678

Epoch 00031: val_acc did not improve from 0.96806
Epoch 32/1000
 - 46s - loss: 0.0263 - acc: 0.9896 - val_loss: 0.1224 - val_acc: 0.9678

Epoch 00032: val_acc did not improve from 0.96806
Epoch 33/1000
 - 46s - loss: 0.0260 - acc: 0.9896 - val_loss: 0.1232 - val_acc: 0.9680

Epoch 00033: val_acc did not improve from 0.96806

Epoch 00033: ReduceLROnPlateau reducing learning rate to 9.999999974752428e-08.
Epoch 34/1000
 - 46s - loss: 0.0258 - acc: 0.9898 - val_loss: 0.1234 - val_acc: 0.9680

Epoch 00034: val_acc did not improve from 0.96806
Epoch 00034: early stopping
Model: "model_33"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_33 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_609 (Conv2D)             (None, 256, 256, 64) 640         input_33[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_705 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_609[0][0]                 
__________________________________________________________________________________________________
conv2d_610 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_705[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_706 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_610[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_129 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_706[0][0]            
__________________________________________________________________________________________________
dropout_289 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_129[0][0]          
__________________________________________________________________________________________________
conv2d_611 (Conv2D)             (None, 128, 128, 128 73856       dropout_289[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_707 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_611[0][0]                 
__________________________________________________________________________________________________
conv2d_612 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_707[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_708 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_612[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_130 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_708[0][0]            
__________________________________________________________________________________________________
dropout_290 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_130[0][0]          
__________________________________________________________________________________________________
conv2d_613 (Conv2D)             (None, 64, 64, 256)  295168      dropout_290[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_709 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_613[0][0]                 
__________________________________________________________________________________________________
conv2d_614 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_709[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_710 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_614[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_131 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_710[0][0]            
__________________________________________________________________________________________________
dropout_291 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_131[0][0]          
__________________________________________________________________________________________________
conv2d_615 (Conv2D)             (None, 32, 32, 512)  1180160     dropout_291[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_711 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_615[0][0]                 
__________________________________________________________________________________________________
conv2d_616 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_711[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_712 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_616[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_132 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_712[0][0]            
__________________________________________________________________________________________________
dropout_292 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_132[0][0]          
__________________________________________________________________________________________________
conv2d_617 (Conv2D)             (None, 16, 16, 1024) 4719616     dropout_292[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_713 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_617[0][0]                 
__________________________________________________________________________________________________
conv2d_618 (Conv2D)             (None, 16, 16, 1024) 9438208     leaky_re_lu_713[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_714 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_618[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_129 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_714[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_715 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_transpose_129[0][0]       
__________________________________________________________________________________________________
concatenate_129 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_715[0][0]            
                                                                 leaky_re_lu_712[0][0]            
__________________________________________________________________________________________________
dropout_293 (Dropout)           (None, 32, 32, 1024) 0           concatenate_129[0][0]            
__________________________________________________________________________________________________
conv2d_619 (Conv2D)             (None, 32, 32, 512)  4719104     dropout_293[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_716 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_619[0][0]                 
__________________________________________________________________________________________________
conv2d_620 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_716[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_717 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_620[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_130 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_717[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_718 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_transpose_130[0][0]       
__________________________________________________________________________________________________
concatenate_130 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_718[0][0]            
                                                                 leaky_re_lu_710[0][0]            
__________________________________________________________________________________________________
dropout_294 (Dropout)           (None, 64, 64, 512)  0           concatenate_130[0][0]            
__________________________________________________________________________________________________
conv2d_621 (Conv2D)             (None, 64, 64, 256)  1179904     dropout_294[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_719 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_621[0][0]                 
__________________________________________________________________________________________________
conv2d_622 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_719[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_720 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_622[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_131 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_720[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_721 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_transpose_131[0][0]       
__________________________________________________________________________________________________
concatenate_131 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_721[0][0]            
                                                                 leaky_re_lu_708[0][0]            
__________________________________________________________________________________________________
dropout_295 (Dropout)           (None, 128, 128, 256 0           concatenate_131[0][0]            
__________________________________________________________________________________________________
conv2d_623 (Conv2D)             (None, 128, 128, 128 295040      dropout_295[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_722 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_623[0][0]                 
__________________________________________________________________________________________________
conv2d_624 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_722[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_723 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_624[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_132 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_723[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_724 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_transpose_132[0][0]       
__________________________________________________________________________________________________
concatenate_132 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_724[0][0]            
                                                                 leaky_re_lu_706[0][0]            
__________________________________________________________________________________________________
dropout_296 (Dropout)           (None, 256, 256, 128 0           concatenate_132[0][0]            
__________________________________________________________________________________________________
dropout_297 (Dropout)           (None, 256, 256, 128 0           dropout_296[0][0]                
__________________________________________________________________________________________________
conv2d_625 (Conv2D)             (None, 256, 256, 64) 73792       dropout_297[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_725 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_625[0][0]                 
__________________________________________________________________________________________________
conv2d_626 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_725[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_726 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_626[0][0]                 
__________________________________________________________________________________________________
conv2d_627 (Conv2D)             (None, 256, 256, 3)  195         leaky_re_lu_726[0][0]            
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 48s - loss: 0.3824 - acc: 0.9257 - val_loss: 0.3242 - val_acc: 0.9433

Epoch 00001: val_acc improved from -inf to 0.94328, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.2126 - acc: 0.9287 - val_loss: 0.1725 - val_acc: 0.9433

Epoch 00002: val_acc did not improve from 0.94328
Epoch 3/1000
 - 46s - loss: 0.1951 - acc: 0.9291 - val_loss: 0.1504 - val_acc: 0.9433

Epoch 00003: val_acc improved from 0.94328 to 0.94329, saving model to unn_grid.h5
Epoch 4/1000
 - 46s - loss: 0.1850 - acc: 0.9292 - val_loss: 0.1580 - val_acc: 0.9433

Epoch 00004: val_acc did not improve from 0.94329

Epoch 00004: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 5/1000
 - 46s - loss: 0.1713 - acc: 0.9298 - val_loss: 0.1556 - val_acc: 0.9433

Epoch 00005: val_acc did not improve from 0.94329
Epoch 6/1000
 - 46s - loss: 0.1690 - acc: 0.9299 - val_loss: 0.1467 - val_acc: 0.9433

Epoch 00006: val_acc did not improve from 0.94329
Epoch 7/1000
 - 46s - loss: 0.1669 - acc: 0.9303 - val_loss: 0.1495 - val_acc: 0.9453

Epoch 00007: val_acc improved from 0.94329 to 0.94529, saving model to unn_grid.h5
Epoch 8/1000
 - 46s - loss: 0.1651 - acc: 0.9308 - val_loss: 0.1469 - val_acc: 0.9495

Epoch 00008: val_acc improved from 0.94529 to 0.94947, saving model to unn_grid.h5
Epoch 9/1000
 - 46s - loss: 0.1625 - acc: 0.9313 - val_loss: 0.1445 - val_acc: 0.9522

Epoch 00009: val_acc improved from 0.94947 to 0.95221, saving model to unn_grid.h5
Epoch 10/1000
 - 46s - loss: 0.1603 - acc: 0.9321 - val_loss: 0.1395 - val_acc: 0.9485

Epoch 00010: val_acc did not improve from 0.95221
Epoch 11/1000
 - 46s - loss: 0.1566 - acc: 0.9372 - val_loss: 0.1587 - val_acc: 0.9498

Epoch 00011: val_acc did not improve from 0.95221
Epoch 12/1000
 - 46s - loss: 0.1513 - acc: 0.9434 - val_loss: 0.1294 - val_acc: 0.9545

Epoch 00012: val_acc improved from 0.95221 to 0.95454, saving model to unn_grid.h5
Epoch 13/1000
 - 46s - loss: 0.1433 - acc: 0.9476 - val_loss: 0.1387 - val_acc: 0.9525

Epoch 00013: val_acc did not improve from 0.95454
Epoch 14/1000
 - 46s - loss: 0.1378 - acc: 0.9500 - val_loss: 0.1332 - val_acc: 0.9540

Epoch 00014: val_acc did not improve from 0.95454
Epoch 15/1000
 - 46s - loss: 0.1327 - acc: 0.9519 - val_loss: 0.1339 - val_acc: 0.9545

Epoch 00015: val_acc did not improve from 0.95454

Epoch 00015: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 16/1000
 - 46s - loss: 0.1256 - acc: 0.9543 - val_loss: 0.1448 - val_acc: 0.9532

Epoch 00016: val_acc did not improve from 0.95454
Epoch 17/1000
 - 46s - loss: 0.1243 - acc: 0.9546 - val_loss: 0.1498 - val_acc: 0.9526

Epoch 00017: val_acc did not improve from 0.95454
Epoch 00017: early stopping
Model: "model_34"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_34 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_628 (Conv2D)             (None, 256, 256, 64) 640         input_34[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_727 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_628[0][0]                 
__________________________________________________________________________________________________
conv2d_629 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_727[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_728 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_629[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_133 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_728[0][0]            
__________________________________________________________________________________________________
dropout_298 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_133[0][0]          
__________________________________________________________________________________________________
conv2d_630 (Conv2D)             (None, 128, 128, 128 73856       dropout_298[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_729 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_630[0][0]                 
__________________________________________________________________________________________________
conv2d_631 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_729[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_730 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_631[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_134 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_730[0][0]            
__________________________________________________________________________________________________
dropout_299 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_134[0][0]          
__________________________________________________________________________________________________
conv2d_632 (Conv2D)             (None, 64, 64, 256)  295168      dropout_299[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_731 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_632[0][0]                 
__________________________________________________________________________________________________
conv2d_633 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_731[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_732 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_633[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_135 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_732[0][0]            
__________________________________________________________________________________________________
dropout_300 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_135[0][0]          
__________________________________________________________________________________________________
conv2d_634 (Conv2D)             (None, 32, 32, 512)  1180160     dropout_300[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_733 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_634[0][0]                 
__________________________________________________________________________________________________
conv2d_635 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_733[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_734 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_635[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_136 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_734[0][0]            
__________________________________________________________________________________________________
dropout_301 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_136[0][0]          
__________________________________________________________________________________________________
conv2d_636 (Conv2D)             (None, 16, 16, 1024) 4719616     dropout_301[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_735 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_636[0][0]                 
__________________________________________________________________________________________________
conv2d_637 (Conv2D)             (None, 16, 16, 1024) 9438208     leaky_re_lu_735[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_736 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_637[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_133 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_736[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_737 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_transpose_133[0][0]       
__________________________________________________________________________________________________
concatenate_133 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_737[0][0]            
                                                                 leaky_re_lu_734[0][0]            
__________________________________________________________________________________________________
dropout_302 (Dropout)           (None, 32, 32, 1024) 0           concatenate_133[0][0]            
__________________________________________________________________________________________________
conv2d_638 (Conv2D)             (None, 32, 32, 512)  4719104     dropout_302[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_738 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_638[0][0]                 
__________________________________________________________________________________________________
conv2d_639 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_738[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_739 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_639[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_134 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_739[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_740 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_transpose_134[0][0]       
__________________________________________________________________________________________________
concatenate_134 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_740[0][0]            
                                                                 leaky_re_lu_732[0][0]            
__________________________________________________________________________________________________
dropout_303 (Dropout)           (None, 64, 64, 512)  0           concatenate_134[0][0]            
__________________________________________________________________________________________________
conv2d_640 (Conv2D)             (None, 64, 64, 256)  1179904     dropout_303[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_741 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_640[0][0]                 
__________________________________________________________________________________________________
conv2d_641 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_741[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_742 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_641[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_135 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_742[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_743 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_transpose_135[0][0]       
__________________________________________________________________________________________________
concatenate_135 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_743[0][0]            
                                                                 leaky_re_lu_730[0][0]            
__________________________________________________________________________________________________
dropout_304 (Dropout)           (None, 128, 128, 256 0           concatenate_135[0][0]            
__________________________________________________________________________________________________
conv2d_642 (Conv2D)             (None, 128, 128, 128 295040      dropout_304[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_744 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_642[0][0]                 
__________________________________________________________________________________________________
conv2d_643 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_744[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_745 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_643[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_136 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_745[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_746 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_transpose_136[0][0]       
__________________________________________________________________________________________________
concatenate_136 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_746[0][0]            
                                                                 leaky_re_lu_728[0][0]            
__________________________________________________________________________________________________
dropout_305 (Dropout)           (None, 256, 256, 128 0           concatenate_136[0][0]            
__________________________________________________________________________________________________
dropout_306 (Dropout)           (None, 256, 256, 128 0           dropout_305[0][0]                
__________________________________________________________________________________________________
conv2d_644 (Conv2D)             (None, 256, 256, 64) 73792       dropout_306[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_747 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_644[0][0]                 
__________________________________________________________________________________________________
conv2d_645 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_747[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_748 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_645[0][0]                 
__________________________________________________________________________________________________
conv2d_646 (Conv2D)             (None, 256, 256, 3)  195         leaky_re_lu_748[0][0]            
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 48s - loss: 0.4938 - acc: 0.9292 - val_loss: 0.2996 - val_acc: 0.9076

Epoch 00001: val_acc improved from -inf to 0.90764, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.1963 - acc: 0.9355 - val_loss: 0.1785 - val_acc: 0.9438

Epoch 00002: val_acc improved from 0.90764 to 0.94376, saving model to unn_grid.h5
Epoch 3/1000
 - 46s - loss: 0.1795 - acc: 0.9369 - val_loss: 0.1512 - val_acc: 0.9495

Epoch 00003: val_acc improved from 0.94376 to 0.94950, saving model to unn_grid.h5
Epoch 4/1000
 - 46s - loss: 0.1723 - acc: 0.9374 - val_loss: 0.1601 - val_acc: 0.9433

Epoch 00004: val_acc did not improve from 0.94950
Epoch 5/1000
 - 46s - loss: 0.1644 - acc: 0.9387 - val_loss: 0.1472 - val_acc: 0.9448

Epoch 00005: val_acc did not improve from 0.94950
Epoch 6/1000
 - 46s - loss: 0.1557 - acc: 0.9417 - val_loss: 0.1614 - val_acc: 0.9514

Epoch 00006: val_acc improved from 0.94950 to 0.95140, saving model to unn_grid.h5
Epoch 7/1000
 - 46s - loss: 0.1489 - acc: 0.9440 - val_loss: 0.1281 - val_acc: 0.9536

Epoch 00007: val_acc improved from 0.95140 to 0.95362, saving model to unn_grid.h5
Epoch 8/1000
 - 46s - loss: 0.1389 - acc: 0.9489 - val_loss: 0.1442 - val_acc: 0.9461

Epoch 00008: val_acc did not improve from 0.95362
Epoch 9/1000
 - 46s - loss: 0.1264 - acc: 0.9544 - val_loss: 0.1443 - val_acc: 0.9435

Epoch 00009: val_acc did not improve from 0.95362
Epoch 10/1000
 - 46s - loss: 0.1136 - acc: 0.9587 - val_loss: 0.1168 - val_acc: 0.9579

Epoch 00010: val_acc improved from 0.95362 to 0.95788, saving model to unn_grid.h5
Epoch 11/1000
 - 46s - loss: 0.1032 - acc: 0.9623 - val_loss: 0.1273 - val_acc: 0.9517

Epoch 00011: val_acc did not improve from 0.95788
Epoch 12/1000
 - 46s - loss: 0.0955 - acc: 0.9647 - val_loss: 0.1135 - val_acc: 0.9603

Epoch 00012: val_acc improved from 0.95788 to 0.96032, saving model to unn_grid.h5
Epoch 13/1000
 - 46s - loss: 0.0916 - acc: 0.9666 - val_loss: 0.1143 - val_acc: 0.9562

Epoch 00013: val_acc did not improve from 0.96032
Epoch 14/1000
 - 46s - loss: 0.0892 - acc: 0.9669 - val_loss: 0.1145 - val_acc: 0.9567

Epoch 00014: val_acc did not improve from 0.96032
Epoch 15/1000
 - 46s - loss: 0.0840 - acc: 0.9691 - val_loss: 0.1096 - val_acc: 0.9616

Epoch 00015: val_acc improved from 0.96032 to 0.96155, saving model to unn_grid.h5
Epoch 16/1000
 - 46s - loss: 0.0836 - acc: 0.9690 - val_loss: 0.0958 - val_acc: 0.9652

Epoch 00016: val_acc improved from 0.96155 to 0.96519, saving model to unn_grid.h5
Epoch 17/1000
 - 46s - loss: 0.0763 - acc: 0.9711 - val_loss: 0.1060 - val_acc: 0.9625

Epoch 00017: val_acc did not improve from 0.96519
Epoch 18/1000
 - 46s - loss: 0.0721 - acc: 0.9726 - val_loss: 0.1026 - val_acc: 0.9657

Epoch 00018: val_acc improved from 0.96519 to 0.96574, saving model to unn_grid.h5
Epoch 19/1000
 - 46s - loss: 0.0697 - acc: 0.9737 - val_loss: 0.1036 - val_acc: 0.9666

Epoch 00019: val_acc improved from 0.96574 to 0.96663, saving model to unn_grid.h5
Epoch 20/1000
 - 46s - loss: 0.0670 - acc: 0.9748 - val_loss: 0.0919 - val_acc: 0.9647

Epoch 00020: val_acc did not improve from 0.96663
Epoch 21/1000
 - 46s - loss: 0.0631 - acc: 0.9758 - val_loss: 0.0963 - val_acc: 0.9658

Epoch 00021: val_acc did not improve from 0.96663
Epoch 22/1000
 - 46s - loss: 0.0633 - acc: 0.9763 - val_loss: 0.1002 - val_acc: 0.9655

Epoch 00022: val_acc did not improve from 0.96663

Epoch 00022: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 23/1000
 - 46s - loss: 0.0487 - acc: 0.9812 - val_loss: 0.0940 - val_acc: 0.9665

Epoch 00023: val_acc did not improve from 0.96663
Epoch 24/1000
 - 46s - loss: 0.0454 - acc: 0.9823 - val_loss: 0.0963 - val_acc: 0.9666

Epoch 00024: val_acc did not improve from 0.96663
Epoch 00024: early stopping
Model: "model_35"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_35 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_647 (Conv2D)             (None, 256, 256, 64) 640         input_35[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_749 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_647[0][0]                 
__________________________________________________________________________________________________
conv2d_648 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_749[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_750 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_648[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_137 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_750[0][0]            
__________________________________________________________________________________________________
dropout_307 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_137[0][0]          
__________________________________________________________________________________________________
conv2d_649 (Conv2D)             (None, 128, 128, 128 73856       dropout_307[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_751 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_649[0][0]                 
__________________________________________________________________________________________________
conv2d_650 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_751[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_752 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_650[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_138 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_752[0][0]            
__________________________________________________________________________________________________
dropout_308 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_138[0][0]          
__________________________________________________________________________________________________
conv2d_651 (Conv2D)             (None, 64, 64, 256)  295168      dropout_308[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_753 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_651[0][0]                 
__________________________________________________________________________________________________
conv2d_652 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_753[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_754 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_652[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_139 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_754[0][0]            
__________________________________________________________________________________________________
dropout_309 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_139[0][0]          
__________________________________________________________________________________________________
conv2d_653 (Conv2D)             (None, 32, 32, 512)  1180160     dropout_309[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_755 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_653[0][0]                 
__________________________________________________________________________________________________
conv2d_654 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_755[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_756 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_654[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_140 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_756[0][0]            
__________________________________________________________________________________________________
dropout_310 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_140[0][0]          
__________________________________________________________________________________________________
conv2d_655 (Conv2D)             (None, 16, 16, 1024) 4719616     dropout_310[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_757 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_655[0][0]                 
__________________________________________________________________________________________________
conv2d_656 (Conv2D)             (None, 16, 16, 1024) 9438208     leaky_re_lu_757[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_758 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_656[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_137 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_758[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_759 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_transpose_137[0][0]       
__________________________________________________________________________________________________
concatenate_137 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_759[0][0]            
                                                                 leaky_re_lu_756[0][0]            
__________________________________________________________________________________________________
dropout_311 (Dropout)           (None, 32, 32, 1024) 0           concatenate_137[0][0]            
__________________________________________________________________________________________________
conv2d_657 (Conv2D)             (None, 32, 32, 512)  4719104     dropout_311[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_760 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_657[0][0]                 
__________________________________________________________________________________________________
conv2d_658 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_760[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_761 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_658[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_138 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_761[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_762 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_transpose_138[0][0]       
__________________________________________________________________________________________________
concatenate_138 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_762[0][0]            
                                                                 leaky_re_lu_754[0][0]            
__________________________________________________________________________________________________
dropout_312 (Dropout)           (None, 64, 64, 512)  0           concatenate_138[0][0]            
__________________________________________________________________________________________________
conv2d_659 (Conv2D)             (None, 64, 64, 256)  1179904     dropout_312[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_763 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_659[0][0]                 
__________________________________________________________________________________________________
conv2d_660 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_763[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_764 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_660[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_139 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_764[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_765 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_transpose_139[0][0]       
__________________________________________________________________________________________________
concatenate_139 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_765[0][0]            
                                                                 leaky_re_lu_752[0][0]            
__________________________________________________________________________________________________
dropout_313 (Dropout)           (None, 128, 128, 256 0           concatenate_139[0][0]            
__________________________________________________________________________________________________
conv2d_661 (Conv2D)             (None, 128, 128, 128 295040      dropout_313[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_766 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_661[0][0]                 
__________________________________________________________________________________________________
conv2d_662 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_766[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_767 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_662[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_140 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_767[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_768 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_transpose_140[0][0]       
__________________________________________________________________________________________________
concatenate_140 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_768[0][0]            
                                                                 leaky_re_lu_750[0][0]            
__________________________________________________________________________________________________
dropout_314 (Dropout)           (None, 256, 256, 128 0           concatenate_140[0][0]            
__________________________________________________________________________________________________
dropout_315 (Dropout)           (None, 256, 256, 128 0           dropout_314[0][0]                
__________________________________________________________________________________________________
conv2d_663 (Conv2D)             (None, 256, 256, 64) 73792       dropout_315[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_769 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_663[0][0]                 
__________________________________________________________________________________________________
conv2d_664 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_769[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_770 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_664[0][0]                 
__________________________________________________________________________________________________
conv2d_665 (Conv2D)             (None, 256, 256, 3)  195         leaky_re_lu_770[0][0]            
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1213 samples, validate on 135 samples
Epoch 1/1000
 - 50s - loss: 0.5395 - acc: 0.9237 - val_loss: 0.2656 - val_acc: 0.9070

Epoch 00001: val_acc improved from -inf to 0.90696, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.1963 - acc: 0.9381 - val_loss: 0.3025 - val_acc: 0.9134

Epoch 00002: val_acc improved from 0.90696 to 0.91337, saving model to unn_grid.h5
Epoch 3/1000
 - 46s - loss: 0.1727 - acc: 0.9393 - val_loss: 0.2149 - val_acc: 0.9132

Epoch 00003: val_acc did not improve from 0.91337
Epoch 4/1000
 - 46s - loss: 0.1680 - acc: 0.9402 - val_loss: 0.2013 - val_acc: 0.9148

Epoch 00004: val_acc improved from 0.91337 to 0.91482, saving model to unn_grid.h5
Epoch 5/1000
 - 46s - loss: 0.1644 - acc: 0.9415 - val_loss: 0.1947 - val_acc: 0.9175

Epoch 00005: val_acc improved from 0.91482 to 0.91751, saving model to unn_grid.h5
Epoch 6/1000
 - 46s - loss: 0.1556 - acc: 0.9453 - val_loss: 0.1865 - val_acc: 0.9264

Epoch 00006: val_acc improved from 0.91751 to 0.92637, saving model to unn_grid.h5
Epoch 7/1000
 - 46s - loss: 0.1400 - acc: 0.9495 - val_loss: 0.1986 - val_acc: 0.9304

Epoch 00007: val_acc improved from 0.92637 to 0.93043, saving model to unn_grid.h5
Epoch 8/1000
 - 46s - loss: 0.1297 - acc: 0.9536 - val_loss: 0.1443 - val_acc: 0.9477

Epoch 00008: val_acc improved from 0.93043 to 0.94772, saving model to unn_grid.h5
Epoch 9/1000
 - 46s - loss: 0.1178 - acc: 0.9586 - val_loss: 0.1380 - val_acc: 0.9512

Epoch 00009: val_acc improved from 0.94772 to 0.95115, saving model to unn_grid.h5
Epoch 10/1000
 - 46s - loss: 0.1072 - acc: 0.9619 - val_loss: 0.1310 - val_acc: 0.9523

Epoch 00010: val_acc improved from 0.95115 to 0.95234, saving model to unn_grid.h5
Epoch 11/1000
 - 46s - loss: 0.0995 - acc: 0.9648 - val_loss: 0.1325 - val_acc: 0.9478

Epoch 00011: val_acc did not improve from 0.95234
Epoch 12/1000
 - 46s - loss: 0.0958 - acc: 0.9656 - val_loss: 0.1112 - val_acc: 0.9582

Epoch 00012: val_acc improved from 0.95234 to 0.95825, saving model to unn_grid.h5
Epoch 13/1000
 - 46s - loss: 0.0879 - acc: 0.9680 - val_loss: 0.1268 - val_acc: 0.9541

Epoch 00013: val_acc did not improve from 0.95825
Epoch 14/1000
 - 46s - loss: 0.0842 - acc: 0.9692 - val_loss: 0.1166 - val_acc: 0.9585

Epoch 00014: val_acc improved from 0.95825 to 0.95846, saving model to unn_grid.h5
Epoch 15/1000
 - 46s - loss: 0.0774 - acc: 0.9711 - val_loss: 0.1433 - val_acc: 0.9464

Epoch 00015: val_acc did not improve from 0.95846
Epoch 16/1000
 - 46s - loss: 0.0750 - acc: 0.9719 - val_loss: 0.1196 - val_acc: 0.9556

Epoch 00016: val_acc did not improve from 0.95846
Epoch 17/1000
 - 46s - loss: 0.0694 - acc: 0.9744 - val_loss: 0.1147 - val_acc: 0.9610

Epoch 00017: val_acc improved from 0.95846 to 0.96098, saving model to unn_grid.h5
Epoch 18/1000
 - 46s - loss: 0.0673 - acc: 0.9746 - val_loss: 0.1078 - val_acc: 0.9601

Epoch 00018: val_acc did not improve from 0.96098
Epoch 19/1000
 - 46s - loss: 0.0626 - acc: 0.9763 - val_loss: 0.1187 - val_acc: 0.9571

Epoch 00019: val_acc did not improve from 0.96098
Epoch 20/1000
 - 46s - loss: 0.0578 - acc: 0.9781 - val_loss: 0.1151 - val_acc: 0.9597

Epoch 00020: val_acc did not improve from 0.96098

Epoch 00020: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 21/1000
 - 46s - loss: 0.0476 - acc: 0.9813 - val_loss: 0.1117 - val_acc: 0.9638

Epoch 00021: val_acc improved from 0.96098 to 0.96381, saving model to unn_grid.h5
Epoch 22/1000
 - 46s - loss: 0.0428 - acc: 0.9833 - val_loss: 0.1141 - val_acc: 0.9638

Epoch 00022: val_acc improved from 0.96381 to 0.96384, saving model to unn_grid.h5
Epoch 23/1000
 - 46s - loss: 0.0414 - acc: 0.9838 - val_loss: 0.1141 - val_acc: 0.9641

Epoch 00023: val_acc improved from 0.96384 to 0.96415, saving model to unn_grid.h5
Epoch 24/1000
 - 46s - loss: 0.0399 - acc: 0.9843 - val_loss: 0.1168 - val_acc: 0.9634

Epoch 00024: val_acc did not improve from 0.96415
Epoch 25/1000
 - 46s - loss: 0.0390 - acc: 0.9847 - val_loss: 0.1184 - val_acc: 0.9633

Epoch 00025: val_acc did not improve from 0.96415
Epoch 26/1000
 - 46s - loss: 0.0381 - acc: 0.9851 - val_loss: 0.1183 - val_acc: 0.9639

Epoch 00026: val_acc did not improve from 0.96415

Epoch 00026: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 27/1000
 - 46s - loss: 0.0364 - acc: 0.9856 - val_loss: 0.1202 - val_acc: 0.9638

Epoch 00027: val_acc did not improve from 0.96415
Epoch 28/1000
 - 46s - loss: 0.0358 - acc: 0.9859 - val_loss: 0.1217 - val_acc: 0.9636

Epoch 00028: val_acc did not improve from 0.96415
Epoch 00028: early stopping
scores= [[0.94593302 0.45337382 0.40869075]
 [0.93582602 0.33330832 0.3119443 ]
 [0.95986734 0.64962314 0.57892187]
 [0.93558513 0.33322472 0.31186717]
 [0.95149693 0.52931513 0.48150358]
 [0.93571018 0.33331998 0.31195914]
 [0.95960049 0.62126837 0.55187472]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]] parameters= (64, 'Adam', 0.5, 'glorot_uniform', 0.0001)
Model: "model_36"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_36 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_666 (Conv2D)             (None, 256, 256, 64) 640         input_36[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_771 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_666[0][0]                 
__________________________________________________________________________________________________
conv2d_667 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_771[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_772 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_667[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_141 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_772[0][0]            
__________________________________________________________________________________________________
dropout_316 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_141[0][0]          
__________________________________________________________________________________________________
conv2d_668 (Conv2D)             (None, 128, 128, 128 73856       dropout_316[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_773 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_668[0][0]                 
__________________________________________________________________________________________________
conv2d_669 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_773[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_774 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_669[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_142 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_774[0][0]            
__________________________________________________________________________________________________
dropout_317 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_142[0][0]          
__________________________________________________________________________________________________
conv2d_670 (Conv2D)             (None, 64, 64, 256)  295168      dropout_317[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_775 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_670[0][0]                 
__________________________________________________________________________________________________
conv2d_671 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_775[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_776 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_671[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_143 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_776[0][0]            
__________________________________________________________________________________________________
dropout_318 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_143[0][0]          
__________________________________________________________________________________________________
conv2d_672 (Conv2D)             (None, 32, 32, 512)  1180160     dropout_318[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_777 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_672[0][0]                 
__________________________________________________________________________________________________
conv2d_673 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_777[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_778 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_673[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_144 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_778[0][0]            
__________________________________________________________________________________________________
dropout_319 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_144[0][0]          
__________________________________________________________________________________________________
conv2d_674 (Conv2D)             (None, 16, 16, 1024) 4719616     dropout_319[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_779 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_674[0][0]                 
__________________________________________________________________________________________________
conv2d_675 (Conv2D)             (None, 16, 16, 1024) 9438208     leaky_re_lu_779[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_780 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_675[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_141 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_780[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_781 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_transpose_141[0][0]       
__________________________________________________________________________________________________
concatenate_141 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_781[0][0]            
                                                                 leaky_re_lu_778[0][0]            
__________________________________________________________________________________________________
dropout_320 (Dropout)           (None, 32, 32, 1024) 0           concatenate_141[0][0]            
__________________________________________________________________________________________________
conv2d_676 (Conv2D)             (None, 32, 32, 512)  4719104     dropout_320[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_782 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_676[0][0]                 
__________________________________________________________________________________________________
conv2d_677 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_782[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_783 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_677[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_142 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_783[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_784 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_transpose_142[0][0]       
__________________________________________________________________________________________________
concatenate_142 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_784[0][0]            
                                                                 leaky_re_lu_776[0][0]            
__________________________________________________________________________________________________
dropout_321 (Dropout)           (None, 64, 64, 512)  0           concatenate_142[0][0]            
__________________________________________________________________________________________________
conv2d_678 (Conv2D)             (None, 64, 64, 256)  1179904     dropout_321[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_785 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_678[0][0]                 
__________________________________________________________________________________________________
conv2d_679 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_785[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_786 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_679[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_143 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_786[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_787 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_transpose_143[0][0]       
__________________________________________________________________________________________________
concatenate_143 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_787[0][0]            
                                                                 leaky_re_lu_774[0][0]            
__________________________________________________________________________________________________
dropout_322 (Dropout)           (None, 128, 128, 256 0           concatenate_143[0][0]            
__________________________________________________________________________________________________
conv2d_680 (Conv2D)             (None, 128, 128, 128 295040      dropout_322[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_788 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_680[0][0]                 
__________________________________________________________________________________________________
conv2d_681 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_788[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_789 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_681[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_144 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_789[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_790 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_transpose_144[0][0]       
__________________________________________________________________________________________________
concatenate_144 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_790[0][0]            
                                                                 leaky_re_lu_772[0][0]            
__________________________________________________________________________________________________
dropout_323 (Dropout)           (None, 256, 256, 128 0           concatenate_144[0][0]            
__________________________________________________________________________________________________
dropout_324 (Dropout)           (None, 256, 256, 128 0           dropout_323[0][0]                
__________________________________________________________________________________________________
conv2d_682 (Conv2D)             (None, 256, 256, 64) 73792       dropout_324[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_791 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_682[0][0]                 
__________________________________________________________________________________________________
conv2d_683 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_791[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_792 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_683[0][0]                 
__________________________________________________________________________________________________
conv2d_684 (Conv2D)             (None, 256, 256, 3)  195         leaky_re_lu_792[0][0]            
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 48s - loss: 1.5170 - acc: 0.8226 - val_loss: 0.6719 - val_acc: 0.9433

Epoch 00001: val_acc improved from -inf to 0.94328, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.6019 - acc: 0.9260 - val_loss: 0.6423 - val_acc: 0.9432

Epoch 00002: val_acc did not improve from 0.94328
Epoch 3/1000
 - 46s - loss: 0.4994 - acc: 0.9244 - val_loss: 0.3945 - val_acc: 0.9397

Epoch 00003: val_acc did not improve from 0.94328
Epoch 4/1000
 - 46s - loss: 0.3301 - acc: 0.9215 - val_loss: 0.2790 - val_acc: 0.9404

Epoch 00004: val_acc did not improve from 0.94328

Epoch 00004: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 5/1000
 - 46s - loss: 0.2484 - acc: 0.9254 - val_loss: 0.2887 - val_acc: 0.9390

Epoch 00005: val_acc did not improve from 0.94328
Epoch 6/1000
 - 46s - loss: 0.2420 - acc: 0.9254 - val_loss: 0.2801 - val_acc: 0.9393

Epoch 00006: val_acc did not improve from 0.94328
Epoch 00006: early stopping
Model: "model_37"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_37 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_685 (Conv2D)             (None, 256, 256, 64) 640         input_37[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_793 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_685[0][0]                 
__________________________________________________________________________________________________
conv2d_686 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_793[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_794 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_686[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_145 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_794[0][0]            
__________________________________________________________________________________________________
dropout_325 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_145[0][0]          
__________________________________________________________________________________________________
conv2d_687 (Conv2D)             (None, 128, 128, 128 73856       dropout_325[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_795 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_687[0][0]                 
__________________________________________________________________________________________________
conv2d_688 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_795[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_796 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_688[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_146 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_796[0][0]            
__________________________________________________________________________________________________
dropout_326 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_146[0][0]          
__________________________________________________________________________________________________
conv2d_689 (Conv2D)             (None, 64, 64, 256)  295168      dropout_326[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_797 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_689[0][0]                 
__________________________________________________________________________________________________
conv2d_690 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_797[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_798 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_690[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_147 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_798[0][0]            
__________________________________________________________________________________________________
dropout_327 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_147[0][0]          
__________________________________________________________________________________________________
conv2d_691 (Conv2D)             (None, 32, 32, 512)  1180160     dropout_327[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_799 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_691[0][0]                 
__________________________________________________________________________________________________
conv2d_692 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_799[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_800 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_692[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_148 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_800[0][0]            
__________________________________________________________________________________________________
dropout_328 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_148[0][0]          
__________________________________________________________________________________________________
conv2d_693 (Conv2D)             (None, 16, 16, 1024) 4719616     dropout_328[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_801 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_693[0][0]                 
__________________________________________________________________________________________________
conv2d_694 (Conv2D)             (None, 16, 16, 1024) 9438208     leaky_re_lu_801[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_802 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_694[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_145 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_802[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_803 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_transpose_145[0][0]       
__________________________________________________________________________________________________
concatenate_145 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_803[0][0]            
                                                                 leaky_re_lu_800[0][0]            
__________________________________________________________________________________________________
dropout_329 (Dropout)           (None, 32, 32, 1024) 0           concatenate_145[0][0]            
__________________________________________________________________________________________________
conv2d_695 (Conv2D)             (None, 32, 32, 512)  4719104     dropout_329[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_804 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_695[0][0]                 
__________________________________________________________________________________________________
conv2d_696 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_804[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_805 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_696[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_146 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_805[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_806 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_transpose_146[0][0]       
__________________________________________________________________________________________________
concatenate_146 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_806[0][0]            
                                                                 leaky_re_lu_798[0][0]            
__________________________________________________________________________________________________
dropout_330 (Dropout)           (None, 64, 64, 512)  0           concatenate_146[0][0]            
__________________________________________________________________________________________________
conv2d_697 (Conv2D)             (None, 64, 64, 256)  1179904     dropout_330[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_807 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_697[0][0]                 
__________________________________________________________________________________________________
conv2d_698 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_807[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_808 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_698[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_147 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_808[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_809 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_transpose_147[0][0]       
__________________________________________________________________________________________________
concatenate_147 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_809[0][0]            
                                                                 leaky_re_lu_796[0][0]            
__________________________________________________________________________________________________
dropout_331 (Dropout)           (None, 128, 128, 256 0           concatenate_147[0][0]            
__________________________________________________________________________________________________
conv2d_699 (Conv2D)             (None, 128, 128, 128 295040      dropout_331[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_810 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_699[0][0]                 
__________________________________________________________________________________________________
conv2d_700 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_810[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_811 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_700[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_148 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_811[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_812 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_transpose_148[0][0]       
__________________________________________________________________________________________________
concatenate_148 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_812[0][0]            
                                                                 leaky_re_lu_794[0][0]            
__________________________________________________________________________________________________
dropout_332 (Dropout)           (None, 256, 256, 128 0           concatenate_148[0][0]            
__________________________________________________________________________________________________
dropout_333 (Dropout)           (None, 256, 256, 128 0           dropout_332[0][0]                
__________________________________________________________________________________________________
conv2d_701 (Conv2D)             (None, 256, 256, 64) 73792       dropout_333[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_813 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_701[0][0]                 
__________________________________________________________________________________________________
conv2d_702 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_813[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_814 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_702[0][0]                 
__________________________________________________________________________________________________
conv2d_703 (Conv2D)             (None, 256, 256, 3)  195         leaky_re_lu_814[0][0]            
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 48s - loss: 0.7795 - acc: 0.9108 - val_loss: 0.6629 - val_acc: 0.9433

Epoch 00001: val_acc improved from -inf to 0.94328, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.4906 - acc: 0.9318 - val_loss: 0.4626 - val_acc: 0.9415

Epoch 00002: val_acc did not improve from 0.94328
Epoch 3/1000
 - 46s - loss: 0.2826 - acc: 0.9285 - val_loss: 0.3631 - val_acc: 0.8698

Epoch 00003: val_acc did not improve from 0.94328
Epoch 4/1000
 - 46s - loss: 0.2114 - acc: 0.9326 - val_loss: 0.3231 - val_acc: 0.9248

Epoch 00004: val_acc did not improve from 0.94328

Epoch 00004: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 5/1000
 - 46s - loss: 0.1951 - acc: 0.9345 - val_loss: 0.2943 - val_acc: 0.9186

Epoch 00005: val_acc did not improve from 0.94328
Epoch 6/1000
 - 46s - loss: 0.1916 - acc: 0.9345 - val_loss: 0.2978 - val_acc: 0.9129

Epoch 00006: val_acc did not improve from 0.94328
Epoch 00006: early stopping
Model: "model_38"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_38 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_704 (Conv2D)             (None, 256, 256, 64) 640         input_38[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_815 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_704[0][0]                 
__________________________________________________________________________________________________
conv2d_705 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_815[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_816 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_705[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_149 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_816[0][0]            
__________________________________________________________________________________________________
dropout_334 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_149[0][0]          
__________________________________________________________________________________________________
conv2d_706 (Conv2D)             (None, 128, 128, 128 73856       dropout_334[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_817 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_706[0][0]                 
__________________________________________________________________________________________________
conv2d_707 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_817[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_818 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_707[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_150 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_818[0][0]            
__________________________________________________________________________________________________
dropout_335 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_150[0][0]          
__________________________________________________________________________________________________
conv2d_708 (Conv2D)             (None, 64, 64, 256)  295168      dropout_335[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_819 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_708[0][0]                 
__________________________________________________________________________________________________
conv2d_709 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_819[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_820 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_709[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_151 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_820[0][0]            
__________________________________________________________________________________________________
dropout_336 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_151[0][0]          
__________________________________________________________________________________________________
conv2d_710 (Conv2D)             (None, 32, 32, 512)  1180160     dropout_336[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_821 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_710[0][0]                 
__________________________________________________________________________________________________
conv2d_711 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_821[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_822 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_711[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_152 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_822[0][0]            
__________________________________________________________________________________________________
dropout_337 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_152[0][0]          
__________________________________________________________________________________________________
conv2d_712 (Conv2D)             (None, 16, 16, 1024) 4719616     dropout_337[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_823 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_712[0][0]                 
__________________________________________________________________________________________________
conv2d_713 (Conv2D)             (None, 16, 16, 1024) 9438208     leaky_re_lu_823[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_824 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_713[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_149 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_824[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_825 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_transpose_149[0][0]       
__________________________________________________________________________________________________
concatenate_149 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_825[0][0]            
                                                                 leaky_re_lu_822[0][0]            
__________________________________________________________________________________________________
dropout_338 (Dropout)           (None, 32, 32, 1024) 0           concatenate_149[0][0]            
__________________________________________________________________________________________________
conv2d_714 (Conv2D)             (None, 32, 32, 512)  4719104     dropout_338[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_826 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_714[0][0]                 
__________________________________________________________________________________________________
conv2d_715 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_826[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_827 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_715[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_150 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_827[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_828 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_transpose_150[0][0]       
__________________________________________________________________________________________________
concatenate_150 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_828[0][0]            
                                                                 leaky_re_lu_820[0][0]            
__________________________________________________________________________________________________
dropout_339 (Dropout)           (None, 64, 64, 512)  0           concatenate_150[0][0]            
__________________________________________________________________________________________________
conv2d_716 (Conv2D)             (None, 64, 64, 256)  1179904     dropout_339[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_829 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_716[0][0]                 
__________________________________________________________________________________________________
conv2d_717 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_829[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_830 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_717[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_151 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_830[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_831 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_transpose_151[0][0]       
__________________________________________________________________________________________________
concatenate_151 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_831[0][0]            
                                                                 leaky_re_lu_818[0][0]            
__________________________________________________________________________________________________
dropout_340 (Dropout)           (None, 128, 128, 256 0           concatenate_151[0][0]            
__________________________________________________________________________________________________
conv2d_718 (Conv2D)             (None, 128, 128, 128 295040      dropout_340[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_832 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_718[0][0]                 
__________________________________________________________________________________________________
conv2d_719 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_832[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_833 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_719[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_152 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_833[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_834 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_transpose_152[0][0]       
__________________________________________________________________________________________________
concatenate_152 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_834[0][0]            
                                                                 leaky_re_lu_816[0][0]            
__________________________________________________________________________________________________
dropout_341 (Dropout)           (None, 256, 256, 128 0           concatenate_152[0][0]            
__________________________________________________________________________________________________
dropout_342 (Dropout)           (None, 256, 256, 128 0           dropout_341[0][0]                
__________________________________________________________________________________________________
conv2d_720 (Conv2D)             (None, 256, 256, 64) 73792       dropout_342[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_835 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_720[0][0]                 
__________________________________________________________________________________________________
conv2d_721 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_835[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_836 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_721[0][0]                 
__________________________________________________________________________________________________
conv2d_722 (Conv2D)             (None, 256, 256, 3)  195         leaky_re_lu_836[0][0]            
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 48s - loss: 0.8369 - acc: 0.8935 - val_loss: 0.6795 - val_acc: 0.9430

Epoch 00001: val_acc improved from -inf to 0.94298, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.5110 - acc: 0.9217 - val_loss: 0.4669 - val_acc: 0.9425

Epoch 00002: val_acc did not improve from 0.94298
Epoch 3/1000
 - 46s - loss: 0.3076 - acc: 0.9202 - val_loss: 0.3203 - val_acc: 0.9271

Epoch 00003: val_acc did not improve from 0.94298
Epoch 4/1000
 - 46s - loss: 0.2301 - acc: 0.9252 - val_loss: 0.3136 - val_acc: 0.9359

Epoch 00004: val_acc did not improve from 0.94298

Epoch 00004: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 5/1000
 - 46s - loss: 0.2132 - acc: 0.9266 - val_loss: 0.2976 - val_acc: 0.9359

Epoch 00005: val_acc did not improve from 0.94298
Epoch 6/1000
 - 46s - loss: 0.2105 - acc: 0.9270 - val_loss: 0.2918 - val_acc: 0.9346

Epoch 00006: val_acc did not improve from 0.94298
Epoch 00006: early stopping
Model: "model_39"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_39 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_723 (Conv2D)             (None, 256, 256, 64) 640         input_39[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_837 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_723[0][0]                 
__________________________________________________________________________________________________
conv2d_724 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_837[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_838 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_724[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_153 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_838[0][0]            
__________________________________________________________________________________________________
dropout_343 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_153[0][0]          
__________________________________________________________________________________________________
conv2d_725 (Conv2D)             (None, 128, 128, 128 73856       dropout_343[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_839 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_725[0][0]                 
__________________________________________________________________________________________________
conv2d_726 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_839[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_840 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_726[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_154 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_840[0][0]            
__________________________________________________________________________________________________
dropout_344 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_154[0][0]          
__________________________________________________________________________________________________
conv2d_727 (Conv2D)             (None, 64, 64, 256)  295168      dropout_344[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_841 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_727[0][0]                 
__________________________________________________________________________________________________
conv2d_728 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_841[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_842 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_728[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_155 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_842[0][0]            
__________________________________________________________________________________________________
dropout_345 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_155[0][0]          
__________________________________________________________________________________________________
conv2d_729 (Conv2D)             (None, 32, 32, 512)  1180160     dropout_345[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_843 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_729[0][0]                 
__________________________________________________________________________________________________
conv2d_730 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_843[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_844 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_730[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_156 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_844[0][0]            
__________________________________________________________________________________________________
dropout_346 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_156[0][0]          
__________________________________________________________________________________________________
conv2d_731 (Conv2D)             (None, 16, 16, 1024) 4719616     dropout_346[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_845 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_731[0][0]                 
__________________________________________________________________________________________________
conv2d_732 (Conv2D)             (None, 16, 16, 1024) 9438208     leaky_re_lu_845[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_846 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_732[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_153 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_846[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_847 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_transpose_153[0][0]       
__________________________________________________________________________________________________
concatenate_153 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_847[0][0]            
                                                                 leaky_re_lu_844[0][0]            
__________________________________________________________________________________________________
dropout_347 (Dropout)           (None, 32, 32, 1024) 0           concatenate_153[0][0]            
__________________________________________________________________________________________________
conv2d_733 (Conv2D)             (None, 32, 32, 512)  4719104     dropout_347[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_848 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_733[0][0]                 
__________________________________________________________________________________________________
conv2d_734 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_848[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_849 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_734[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_154 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_849[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_850 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_transpose_154[0][0]       
__________________________________________________________________________________________________
concatenate_154 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_850[0][0]            
                                                                 leaky_re_lu_842[0][0]            
__________________________________________________________________________________________________
dropout_348 (Dropout)           (None, 64, 64, 512)  0           concatenate_154[0][0]            
__________________________________________________________________________________________________
conv2d_735 (Conv2D)             (None, 64, 64, 256)  1179904     dropout_348[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_851 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_735[0][0]                 
__________________________________________________________________________________________________
conv2d_736 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_851[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_852 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_736[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_155 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_852[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_853 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_transpose_155[0][0]       
__________________________________________________________________________________________________
concatenate_155 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_853[0][0]            
                                                                 leaky_re_lu_840[0][0]            
__________________________________________________________________________________________________
dropout_349 (Dropout)           (None, 128, 128, 256 0           concatenate_155[0][0]            
__________________________________________________________________________________________________
conv2d_737 (Conv2D)             (None, 128, 128, 128 295040      dropout_349[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_854 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_737[0][0]                 
__________________________________________________________________________________________________
conv2d_738 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_854[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_855 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_738[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_156 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_855[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_856 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_transpose_156[0][0]       
__________________________________________________________________________________________________
concatenate_156 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_856[0][0]            
                                                                 leaky_re_lu_838[0][0]            
__________________________________________________________________________________________________
dropout_350 (Dropout)           (None, 256, 256, 128 0           concatenate_156[0][0]            
__________________________________________________________________________________________________
dropout_351 (Dropout)           (None, 256, 256, 128 0           dropout_350[0][0]                
__________________________________________________________________________________________________
conv2d_739 (Conv2D)             (None, 256, 256, 64) 73792       dropout_351[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_857 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_739[0][0]                 
__________________________________________________________________________________________________
conv2d_740 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_857[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_858 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_740[0][0]                 
__________________________________________________________________________________________________
conv2d_741 (Conv2D)             (None, 256, 256, 3)  195         leaky_re_lu_858[0][0]            
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 48s - loss: 1.0938 - acc: 0.8907 - val_loss: 0.6907 - val_acc: 0.9432

Epoch 00001: val_acc improved from -inf to 0.94323, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.6459 - acc: 0.9325 - val_loss: 0.6570 - val_acc: 0.9432

Epoch 00002: val_acc did not improve from 0.94323
Epoch 3/1000
 - 46s - loss: 0.5424 - acc: 0.9306 - val_loss: 0.5099 - val_acc: 0.8866

Epoch 00003: val_acc did not improve from 0.94323
Epoch 4/1000
 - 46s - loss: 0.3281 - acc: 0.9265 - val_loss: 0.3159 - val_acc: 0.9224

Epoch 00004: val_acc did not improve from 0.94323

Epoch 00004: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 5/1000
 - 46s - loss: 0.2342 - acc: 0.9304 - val_loss: 0.2984 - val_acc: 0.9268

Epoch 00005: val_acc did not improve from 0.94323
Epoch 6/1000
 - 46s - loss: 0.2280 - acc: 0.9316 - val_loss: 0.3314 - val_acc: 0.9232

Epoch 00006: val_acc did not improve from 0.94323
Epoch 00006: early stopping
Model: "model_40"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_40 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_742 (Conv2D)             (None, 256, 256, 64) 640         input_40[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_859 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_742[0][0]                 
__________________________________________________________________________________________________
conv2d_743 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_859[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_860 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_743[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_157 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_860[0][0]            
__________________________________________________________________________________________________
dropout_352 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_157[0][0]          
__________________________________________________________________________________________________
conv2d_744 (Conv2D)             (None, 128, 128, 128 73856       dropout_352[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_861 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_744[0][0]                 
__________________________________________________________________________________________________
conv2d_745 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_861[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_862 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_745[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_158 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_862[0][0]            
__________________________________________________________________________________________________
dropout_353 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_158[0][0]          
__________________________________________________________________________________________________
conv2d_746 (Conv2D)             (None, 64, 64, 256)  295168      dropout_353[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_863 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_746[0][0]                 
__________________________________________________________________________________________________
conv2d_747 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_863[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_864 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_747[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_159 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_864[0][0]            
__________________________________________________________________________________________________
dropout_354 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_159[0][0]          
__________________________________________________________________________________________________
conv2d_748 (Conv2D)             (None, 32, 32, 512)  1180160     dropout_354[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_865 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_748[0][0]                 
__________________________________________________________________________________________________
conv2d_749 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_865[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_866 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_749[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_160 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_866[0][0]            
__________________________________________________________________________________________________
dropout_355 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_160[0][0]          
__________________________________________________________________________________________________
conv2d_750 (Conv2D)             (None, 16, 16, 1024) 4719616     dropout_355[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_867 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_750[0][0]                 
__________________________________________________________________________________________________
conv2d_751 (Conv2D)             (None, 16, 16, 1024) 9438208     leaky_re_lu_867[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_868 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_751[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_157 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_868[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_869 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_transpose_157[0][0]       
__________________________________________________________________________________________________
concatenate_157 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_869[0][0]            
                                                                 leaky_re_lu_866[0][0]            
__________________________________________________________________________________________________
dropout_356 (Dropout)           (None, 32, 32, 1024) 0           concatenate_157[0][0]            
__________________________________________________________________________________________________
conv2d_752 (Conv2D)             (None, 32, 32, 512)  4719104     dropout_356[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_870 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_752[0][0]                 
__________________________________________________________________________________________________
conv2d_753 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_870[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_871 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_753[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_158 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_871[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_872 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_transpose_158[0][0]       
__________________________________________________________________________________________________
concatenate_158 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_872[0][0]            
                                                                 leaky_re_lu_864[0][0]            
__________________________________________________________________________________________________
dropout_357 (Dropout)           (None, 64, 64, 512)  0           concatenate_158[0][0]            
__________________________________________________________________________________________________
conv2d_754 (Conv2D)             (None, 64, 64, 256)  1179904     dropout_357[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_873 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_754[0][0]                 
__________________________________________________________________________________________________
conv2d_755 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_873[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_874 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_755[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_159 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_874[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_875 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_transpose_159[0][0]       
__________________________________________________________________________________________________
concatenate_159 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_875[0][0]            
                                                                 leaky_re_lu_862[0][0]            
__________________________________________________________________________________________________
dropout_358 (Dropout)           (None, 128, 128, 256 0           concatenate_159[0][0]            
__________________________________________________________________________________________________
conv2d_756 (Conv2D)             (None, 128, 128, 128 295040      dropout_358[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_876 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_756[0][0]                 
__________________________________________________________________________________________________
conv2d_757 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_876[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_877 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_757[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_160 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_877[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_878 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_transpose_160[0][0]       
__________________________________________________________________________________________________
concatenate_160 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_878[0][0]            
                                                                 leaky_re_lu_860[0][0]            
__________________________________________________________________________________________________
dropout_359 (Dropout)           (None, 256, 256, 128 0           concatenate_160[0][0]            
__________________________________________________________________________________________________
dropout_360 (Dropout)           (None, 256, 256, 128 0           dropout_359[0][0]                
__________________________________________________________________________________________________
conv2d_758 (Conv2D)             (None, 256, 256, 64) 73792       dropout_360[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_879 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_758[0][0]                 
__________________________________________________________________________________________________
conv2d_759 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_879[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_880 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_759[0][0]                 
__________________________________________________________________________________________________
conv2d_760 (Conv2D)             (None, 256, 256, 3)  195         leaky_re_lu_880[0][0]            
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1213 samples, validate on 135 samples
Epoch 1/1000
 - 48s - loss: 0.8479 - acc: 0.9013 - val_loss: 0.4680 - val_acc: 0.9134

Epoch 00001: val_acc improved from -inf to 0.91342, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.5406 - acc: 0.9357 - val_loss: 0.4297 - val_acc: 0.9135

Epoch 00002: val_acc improved from 0.91342 to 0.91347, saving model to unn_grid.h5
Epoch 3/1000
 - 46s - loss: 0.4142 - acc: 0.9313 - val_loss: 0.3896 - val_acc: 0.9107

Epoch 00003: val_acc did not improve from 0.91347
Epoch 4/1000
 - 46s - loss: 0.2404 - acc: 0.9327 - val_loss: 0.3337 - val_acc: 0.9129

Epoch 00004: val_acc did not improve from 0.91347

Epoch 00004: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 5/1000
 - 46s - loss: 0.2079 - acc: 0.9362 - val_loss: 0.3273 - val_acc: 0.9126

Epoch 00005: val_acc did not improve from 0.91347
Epoch 6/1000
 - 46s - loss: 0.2044 - acc: 0.9362 - val_loss: 0.3387 - val_acc: 0.9125

Epoch 00006: val_acc did not improve from 0.91347
Epoch 7/1000
 - 46s - loss: 0.2020 - acc: 0.9362 - val_loss: 0.3283 - val_acc: 0.9125

Epoch 00007: val_acc did not improve from 0.91347

Epoch 00007: ReduceLROnPlateau reducing learning rate to 9.999999974752428e-08.
Epoch 00007: early stopping
scores= [[0.94593302 0.45337382 0.40869075]
 [0.93582602 0.33330832 0.3119443 ]
 [0.95986734 0.64962314 0.57892187]
 [0.93558513 0.33322472 0.31186717]
 [0.95149693 0.52931513 0.48150358]
 [0.93571018 0.33331998 0.31195914]
 [0.95960049 0.62126837 0.55187472]
 [0.93582604 0.33330626 0.31194201]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]] parameters= (64, 'Adam', 0.5, 'glorot_uniform', 1e-05)
Model: "model_41"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_41 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_761 (Conv2D)             (None, 256, 256, 64) 640         input_41[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_881 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_761[0][0]                 
__________________________________________________________________________________________________
conv2d_762 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_881[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_882 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_762[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_161 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_882[0][0]            
__________________________________________________________________________________________________
dropout_361 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_161[0][0]          
__________________________________________________________________________________________________
conv2d_763 (Conv2D)             (None, 128, 128, 128 73856       dropout_361[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_883 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_763[0][0]                 
__________________________________________________________________________________________________
conv2d_764 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_883[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_884 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_764[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_162 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_884[0][0]            
__________________________________________________________________________________________________
dropout_362 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_162[0][0]          
__________________________________________________________________________________________________
conv2d_765 (Conv2D)             (None, 64, 64, 256)  295168      dropout_362[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_885 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_765[0][0]                 
__________________________________________________________________________________________________
conv2d_766 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_885[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_886 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_766[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_163 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_886[0][0]            
__________________________________________________________________________________________________
dropout_363 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_163[0][0]          
__________________________________________________________________________________________________
conv2d_767 (Conv2D)             (None, 32, 32, 512)  1180160     dropout_363[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_887 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_767[0][0]                 
__________________________________________________________________________________________________
conv2d_768 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_887[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_888 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_768[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_164 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_888[0][0]            
__________________________________________________________________________________________________
dropout_364 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_164[0][0]          
__________________________________________________________________________________________________
conv2d_769 (Conv2D)             (None, 16, 16, 1024) 4719616     dropout_364[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_889 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_769[0][0]                 
__________________________________________________________________________________________________
conv2d_770 (Conv2D)             (None, 16, 16, 1024) 9438208     leaky_re_lu_889[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_890 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_770[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_161 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_890[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_891 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_transpose_161[0][0]       
__________________________________________________________________________________________________
concatenate_161 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_891[0][0]            
                                                                 leaky_re_lu_888[0][0]            
__________________________________________________________________________________________________
dropout_365 (Dropout)           (None, 32, 32, 1024) 0           concatenate_161[0][0]            
__________________________________________________________________________________________________
conv2d_771 (Conv2D)             (None, 32, 32, 512)  4719104     dropout_365[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_892 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_771[0][0]                 
__________________________________________________________________________________________________
conv2d_772 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_892[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_893 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_772[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_162 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_893[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_894 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_transpose_162[0][0]       
__________________________________________________________________________________________________
concatenate_162 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_894[0][0]            
                                                                 leaky_re_lu_886[0][0]            
__________________________________________________________________________________________________
dropout_366 (Dropout)           (None, 64, 64, 512)  0           concatenate_162[0][0]            
__________________________________________________________________________________________________
conv2d_773 (Conv2D)             (None, 64, 64, 256)  1179904     dropout_366[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_895 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_773[0][0]                 
__________________________________________________________________________________________________
conv2d_774 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_895[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_896 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_774[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_163 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_896[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_897 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_transpose_163[0][0]       
__________________________________________________________________________________________________
concatenate_163 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_897[0][0]            
                                                                 leaky_re_lu_884[0][0]            
__________________________________________________________________________________________________
dropout_367 (Dropout)           (None, 128, 128, 256 0           concatenate_163[0][0]            
__________________________________________________________________________________________________
conv2d_775 (Conv2D)             (None, 128, 128, 128 295040      dropout_367[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_898 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_775[0][0]                 
__________________________________________________________________________________________________
conv2d_776 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_898[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_899 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_776[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_164 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_899[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_900 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_transpose_164[0][0]       
__________________________________________________________________________________________________
concatenate_164 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_900[0][0]            
                                                                 leaky_re_lu_882[0][0]            
__________________________________________________________________________________________________
dropout_368 (Dropout)           (None, 256, 256, 128 0           concatenate_164[0][0]            
__________________________________________________________________________________________________
dropout_369 (Dropout)           (None, 256, 256, 128 0           dropout_368[0][0]                
__________________________________________________________________________________________________
conv2d_777 (Conv2D)             (None, 256, 256, 64) 73792       dropout_369[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_901 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_777[0][0]                 
__________________________________________________________________________________________________
conv2d_778 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_901[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_902 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_778[0][0]                 
__________________________________________________________________________________________________
conv2d_779 (Conv2D)             (None, 256, 256, 3)  195         leaky_re_lu_902[0][0]            
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 48s - loss: 0.5612 - acc: 0.9130 - val_loss: 0.2150 - val_acc: 0.9432

Epoch 00001: val_acc improved from -inf to 0.94315, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.1980 - acc: 0.9319 - val_loss: 0.1626 - val_acc: 0.9433

Epoch 00002: val_acc improved from 0.94315 to 0.94329, saving model to unn_grid.h5
Epoch 3/1000
 - 46s - loss: 0.1800 - acc: 0.9324 - val_loss: 0.1658 - val_acc: 0.9434

Epoch 00003: val_acc improved from 0.94329 to 0.94336, saving model to unn_grid.h5
Epoch 4/1000
 - 46s - loss: 0.1725 - acc: 0.9335 - val_loss: 0.1562 - val_acc: 0.9433

Epoch 00004: val_acc did not improve from 0.94336
Epoch 5/1000
 - 46s - loss: 0.1673 - acc: 0.9344 - val_loss: 0.1407 - val_acc: 0.9439

Epoch 00005: val_acc improved from 0.94336 to 0.94393, saving model to unn_grid.h5
Epoch 6/1000
 - 46s - loss: 0.1585 - acc: 0.9406 - val_loss: 0.1587 - val_acc: 0.9482

Epoch 00006: val_acc improved from 0.94393 to 0.94825, saving model to unn_grid.h5
Epoch 7/1000
 - 46s - loss: 0.1459 - acc: 0.9455 - val_loss: 0.1550 - val_acc: 0.9523

Epoch 00007: val_acc improved from 0.94825 to 0.95230, saving model to unn_grid.h5
Epoch 8/1000
 - 46s - loss: 0.1389 - acc: 0.9497 - val_loss: 0.1348 - val_acc: 0.9532

Epoch 00008: val_acc improved from 0.95230 to 0.95315, saving model to unn_grid.h5
Epoch 9/1000
 - 46s - loss: 0.1214 - acc: 0.9563 - val_loss: 0.1349 - val_acc: 0.9591

Epoch 00009: val_acc improved from 0.95315 to 0.95913, saving model to unn_grid.h5
Epoch 10/1000
 - 46s - loss: 0.1099 - acc: 0.9607 - val_loss: 0.1050 - val_acc: 0.9640

Epoch 00010: val_acc improved from 0.95913 to 0.96404, saving model to unn_grid.h5
Epoch 11/1000
 - 46s - loss: 0.0994 - acc: 0.9634 - val_loss: 0.1078 - val_acc: 0.9603

Epoch 00011: val_acc did not improve from 0.96404
Epoch 12/1000
 - 46s - loss: 0.0943 - acc: 0.9648 - val_loss: 0.1286 - val_acc: 0.9562

Epoch 00012: val_acc did not improve from 0.96404
Epoch 13/1000
 - 46s - loss: 0.0869 - acc: 0.9679 - val_loss: 0.1241 - val_acc: 0.9614

Epoch 00013: val_acc did not improve from 0.96404

Epoch 00013: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 14/1000
 - 46s - loss: 0.0719 - acc: 0.9726 - val_loss: 0.0889 - val_acc: 0.9687

Epoch 00014: val_acc improved from 0.96404 to 0.96870, saving model to unn_grid.h5
Epoch 15/1000
 - 46s - loss: 0.0658 - acc: 0.9747 - val_loss: 0.0891 - val_acc: 0.9678

Epoch 00015: val_acc did not improve from 0.96870
Epoch 16/1000
 - 46s - loss: 0.0633 - acc: 0.9756 - val_loss: 0.0900 - val_acc: 0.9681

Epoch 00016: val_acc did not improve from 0.96870
Epoch 17/1000
 - 46s - loss: 0.0616 - acc: 0.9762 - val_loss: 0.0908 - val_acc: 0.9686

Epoch 00017: val_acc did not improve from 0.96870

Epoch 00017: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 18/1000
 - 46s - loss: 0.0589 - acc: 0.9772 - val_loss: 0.0893 - val_acc: 0.9689

Epoch 00018: val_acc improved from 0.96870 to 0.96889, saving model to unn_grid.h5
Epoch 19/1000
 - 46s - loss: 0.0584 - acc: 0.9774 - val_loss: 0.0890 - val_acc: 0.9688

Epoch 00019: val_acc did not improve from 0.96889
Epoch 20/1000
 - 46s - loss: 0.0582 - acc: 0.9773 - val_loss: 0.0895 - val_acc: 0.9687

Epoch 00020: val_acc did not improve from 0.96889
Epoch 21/1000
 - 46s - loss: 0.0578 - acc: 0.9776 - val_loss: 0.0893 - val_acc: 0.9686

Epoch 00021: val_acc did not improve from 0.96889

Epoch 00021: ReduceLROnPlateau reducing learning rate to 9.999999974752428e-08.
Epoch 22/1000
 - 46s - loss: 0.0575 - acc: 0.9777 - val_loss: 0.0893 - val_acc: 0.9687

Epoch 00022: val_acc did not improve from 0.96889
Epoch 23/1000
 - 46s - loss: 0.0573 - acc: 0.9778 - val_loss: 0.0894 - val_acc: 0.9687

Epoch 00023: val_acc did not improve from 0.96889
Epoch 00023: early stopping
Model: "model_42"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_42 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_780 (Conv2D)             (None, 256, 256, 64) 640         input_42[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_903 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_780[0][0]                 
__________________________________________________________________________________________________
conv2d_781 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_903[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_904 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_781[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_165 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_904[0][0]            
__________________________________________________________________________________________________
dropout_370 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_165[0][0]          
__________________________________________________________________________________________________
conv2d_782 (Conv2D)             (None, 128, 128, 128 73856       dropout_370[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_905 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_782[0][0]                 
__________________________________________________________________________________________________
conv2d_783 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_905[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_906 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_783[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_166 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_906[0][0]            
__________________________________________________________________________________________________
dropout_371 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_166[0][0]          
__________________________________________________________________________________________________
conv2d_784 (Conv2D)             (None, 64, 64, 256)  295168      dropout_371[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_907 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_784[0][0]                 
__________________________________________________________________________________________________
conv2d_785 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_907[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_908 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_785[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_167 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_908[0][0]            
__________________________________________________________________________________________________
dropout_372 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_167[0][0]          
__________________________________________________________________________________________________
conv2d_786 (Conv2D)             (None, 32, 32, 512)  1180160     dropout_372[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_909 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_786[0][0]                 
__________________________________________________________________________________________________
conv2d_787 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_909[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_910 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_787[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_168 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_910[0][0]            
__________________________________________________________________________________________________
dropout_373 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_168[0][0]          
__________________________________________________________________________________________________
conv2d_788 (Conv2D)             (None, 16, 16, 1024) 4719616     dropout_373[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_911 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_788[0][0]                 
__________________________________________________________________________________________________
conv2d_789 (Conv2D)             (None, 16, 16, 1024) 9438208     leaky_re_lu_911[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_912 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_789[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_165 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_912[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_913 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_transpose_165[0][0]       
__________________________________________________________________________________________________
concatenate_165 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_913[0][0]            
                                                                 leaky_re_lu_910[0][0]            
__________________________________________________________________________________________________
dropout_374 (Dropout)           (None, 32, 32, 1024) 0           concatenate_165[0][0]            
__________________________________________________________________________________________________
conv2d_790 (Conv2D)             (None, 32, 32, 512)  4719104     dropout_374[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_914 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_790[0][0]                 
__________________________________________________________________________________________________
conv2d_791 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_914[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_915 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_791[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_166 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_915[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_916 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_transpose_166[0][0]       
__________________________________________________________________________________________________
concatenate_166 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_916[0][0]            
                                                                 leaky_re_lu_908[0][0]            
__________________________________________________________________________________________________
dropout_375 (Dropout)           (None, 64, 64, 512)  0           concatenate_166[0][0]            
__________________________________________________________________________________________________
conv2d_792 (Conv2D)             (None, 64, 64, 256)  1179904     dropout_375[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_917 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_792[0][0]                 
__________________________________________________________________________________________________
conv2d_793 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_917[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_918 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_793[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_167 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_918[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_919 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_transpose_167[0][0]       
__________________________________________________________________________________________________
concatenate_167 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_919[0][0]            
                                                                 leaky_re_lu_906[0][0]            
__________________________________________________________________________________________________
dropout_376 (Dropout)           (None, 128, 128, 256 0           concatenate_167[0][0]            
__________________________________________________________________________________________________
conv2d_794 (Conv2D)             (None, 128, 128, 128 295040      dropout_376[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_920 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_794[0][0]                 
__________________________________________________________________________________________________
conv2d_795 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_920[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_921 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_795[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_168 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_921[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_922 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_transpose_168[0][0]       
__________________________________________________________________________________________________
concatenate_168 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_922[0][0]            
                                                                 leaky_re_lu_904[0][0]            
__________________________________________________________________________________________________
dropout_377 (Dropout)           (None, 256, 256, 128 0           concatenate_168[0][0]            
__________________________________________________________________________________________________
dropout_378 (Dropout)           (None, 256, 256, 128 0           dropout_377[0][0]                
__________________________________________________________________________________________________
conv2d_796 (Conv2D)             (None, 256, 256, 64) 73792       dropout_378[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_923 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_796[0][0]                 
__________________________________________________________________________________________________
conv2d_797 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_923[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_924 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_797[0][0]                 
__________________________________________________________________________________________________
conv2d_798 (Conv2D)             (None, 256, 256, 3)  195         leaky_re_lu_924[0][0]            
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 48s - loss: 0.5739 - acc: 0.9167 - val_loss: 0.2006 - val_acc: 0.9429

Epoch 00001: val_acc improved from -inf to 0.94294, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.1842 - acc: 0.9365 - val_loss: 0.1914 - val_acc: 0.9433

Epoch 00002: val_acc improved from 0.94294 to 0.94329, saving model to unn_grid.h5
Epoch 3/1000
 - 46s - loss: 0.1677 - acc: 0.9373 - val_loss: 0.1546 - val_acc: 0.9433

Epoch 00003: val_acc did not improve from 0.94329
Epoch 4/1000
 - 46s - loss: 0.1612 - acc: 0.9381 - val_loss: 0.1547 - val_acc: 0.9441

Epoch 00004: val_acc improved from 0.94329 to 0.94408, saving model to unn_grid.h5
Epoch 5/1000
 - 46s - loss: 0.1529 - acc: 0.9419 - val_loss: 0.1524 - val_acc: 0.9454

Epoch 00005: val_acc improved from 0.94408 to 0.94537, saving model to unn_grid.h5
Epoch 6/1000
 - 46s - loss: 0.1507 - acc: 0.9440 - val_loss: 0.1453 - val_acc: 0.9457

Epoch 00006: val_acc improved from 0.94537 to 0.94574, saving model to unn_grid.h5
Epoch 7/1000
 - 46s - loss: 0.1353 - acc: 0.9505 - val_loss: 0.1340 - val_acc: 0.9535

Epoch 00007: val_acc improved from 0.94574 to 0.95350, saving model to unn_grid.h5
Epoch 8/1000
 - 46s - loss: 0.1253 - acc: 0.9544 - val_loss: 0.1230 - val_acc: 0.9571

Epoch 00008: val_acc improved from 0.95350 to 0.95710, saving model to unn_grid.h5
Epoch 9/1000
 - 46s - loss: 0.1146 - acc: 0.9577 - val_loss: 0.1211 - val_acc: 0.9616

Epoch 00009: val_acc improved from 0.95710 to 0.96155, saving model to unn_grid.h5
Epoch 10/1000
 - 46s - loss: 0.1081 - acc: 0.9603 - val_loss: 0.1028 - val_acc: 0.9615

Epoch 00010: val_acc did not improve from 0.96155
Epoch 11/1000
 - 46s - loss: 0.1009 - acc: 0.9631 - val_loss: 0.1184 - val_acc: 0.9585

Epoch 00011: val_acc did not improve from 0.96155
Epoch 12/1000
 - 46s - loss: 0.0943 - acc: 0.9657 - val_loss: 0.1036 - val_acc: 0.9622

Epoch 00012: val_acc improved from 0.96155 to 0.96218, saving model to unn_grid.h5
Epoch 13/1000
 - 46s - loss: 0.0857 - acc: 0.9684 - val_loss: 0.1143 - val_acc: 0.9644

Epoch 00013: val_acc improved from 0.96218 to 0.96441, saving model to unn_grid.h5
Epoch 14/1000
 - 46s - loss: 0.0815 - acc: 0.9703 - val_loss: 0.1034 - val_acc: 0.9633

Epoch 00014: val_acc did not improve from 0.96441
Epoch 15/1000
 - 46s - loss: 0.0745 - acc: 0.9724 - val_loss: 0.1038 - val_acc: 0.9622

Epoch 00015: val_acc did not improve from 0.96441
Epoch 16/1000
 - 46s - loss: 0.0682 - acc: 0.9749 - val_loss: 0.0985 - val_acc: 0.9654

Epoch 00016: val_acc improved from 0.96441 to 0.96538, saving model to unn_grid.h5
Epoch 17/1000
 - 46s - loss: 0.0641 - acc: 0.9759 - val_loss: 0.0977 - val_acc: 0.9651

Epoch 00017: val_acc did not improve from 0.96538
Epoch 18/1000
 - 46s - loss: 0.0627 - acc: 0.9765 - val_loss: 0.0932 - val_acc: 0.9680

Epoch 00018: val_acc improved from 0.96538 to 0.96798, saving model to unn_grid.h5
Epoch 19/1000
 - 46s - loss: 0.0547 - acc: 0.9795 - val_loss: 0.1109 - val_acc: 0.9669

Epoch 00019: val_acc did not improve from 0.96798
Epoch 20/1000
 - 46s - loss: 0.0532 - acc: 0.9798 - val_loss: 0.0887 - val_acc: 0.9688

Epoch 00020: val_acc improved from 0.96798 to 0.96875, saving model to unn_grid.h5
Epoch 21/1000
 - 46s - loss: 0.0531 - acc: 0.9804 - val_loss: 0.1071 - val_acc: 0.9681

Epoch 00021: val_acc did not improve from 0.96875
Epoch 22/1000
 - 46s - loss: 0.0478 - acc: 0.9821 - val_loss: 0.1040 - val_acc: 0.9681

Epoch 00022: val_acc did not improve from 0.96875
Epoch 23/1000
 - 46s - loss: 0.0456 - acc: 0.9827 - val_loss: 0.1068 - val_acc: 0.9670

Epoch 00023: val_acc did not improve from 0.96875

Epoch 00023: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 24/1000
 - 46s - loss: 0.0343 - acc: 0.9866 - val_loss: 0.1063 - val_acc: 0.9690

Epoch 00024: val_acc improved from 0.96875 to 0.96897, saving model to unn_grid.h5
Epoch 25/1000
 - 46s - loss: 0.0308 - acc: 0.9880 - val_loss: 0.1118 - val_acc: 0.9697

Epoch 00025: val_acc improved from 0.96897 to 0.96967, saving model to unn_grid.h5
Epoch 26/1000
 - 46s - loss: 0.0293 - acc: 0.9885 - val_loss: 0.1127 - val_acc: 0.9692

Epoch 00026: val_acc did not improve from 0.96967
Epoch 27/1000
 - 46s - loss: 0.0281 - acc: 0.9889 - val_loss: 0.1192 - val_acc: 0.9692

Epoch 00027: val_acc did not improve from 0.96967
Epoch 28/1000
 - 46s - loss: 0.0274 - acc: 0.9892 - val_loss: 0.1196 - val_acc: 0.9688

Epoch 00028: val_acc did not improve from 0.96967

Epoch 00028: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 29/1000
 - 46s - loss: 0.0260 - acc: 0.9897 - val_loss: 0.1230 - val_acc: 0.9689

Epoch 00029: val_acc did not improve from 0.96967
Epoch 30/1000
 - 46s - loss: 0.0258 - acc: 0.9897 - val_loss: 0.1249 - val_acc: 0.9688

Epoch 00030: val_acc did not improve from 0.96967
Epoch 00030: early stopping
Model: "model_43"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_43 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_799 (Conv2D)             (None, 256, 256, 64) 640         input_43[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_925 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_799[0][0]                 
__________________________________________________________________________________________________
conv2d_800 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_925[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_926 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_800[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_169 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_926[0][0]            
__________________________________________________________________________________________________
dropout_379 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_169[0][0]          
__________________________________________________________________________________________________
conv2d_801 (Conv2D)             (None, 128, 128, 128 73856       dropout_379[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_927 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_801[0][0]                 
__________________________________________________________________________________________________
conv2d_802 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_927[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_928 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_802[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_170 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_928[0][0]            
__________________________________________________________________________________________________
dropout_380 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_170[0][0]          
__________________________________________________________________________________________________
conv2d_803 (Conv2D)             (None, 64, 64, 256)  295168      dropout_380[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_929 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_803[0][0]                 
__________________________________________________________________________________________________
conv2d_804 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_929[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_930 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_804[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_171 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_930[0][0]            
__________________________________________________________________________________________________
dropout_381 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_171[0][0]          
__________________________________________________________________________________________________
conv2d_805 (Conv2D)             (None, 32, 32, 512)  1180160     dropout_381[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_931 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_805[0][0]                 
__________________________________________________________________________________________________
conv2d_806 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_931[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_932 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_806[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_172 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_932[0][0]            
__________________________________________________________________________________________________
dropout_382 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_172[0][0]          
__________________________________________________________________________________________________
conv2d_807 (Conv2D)             (None, 16, 16, 1024) 4719616     dropout_382[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_933 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_807[0][0]                 
__________________________________________________________________________________________________
conv2d_808 (Conv2D)             (None, 16, 16, 1024) 9438208     leaky_re_lu_933[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_934 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_808[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_169 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_934[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_935 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_transpose_169[0][0]       
__________________________________________________________________________________________________
concatenate_169 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_935[0][0]            
                                                                 leaky_re_lu_932[0][0]            
__________________________________________________________________________________________________
dropout_383 (Dropout)           (None, 32, 32, 1024) 0           concatenate_169[0][0]            
__________________________________________________________________________________________________
conv2d_809 (Conv2D)             (None, 32, 32, 512)  4719104     dropout_383[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_936 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_809[0][0]                 
__________________________________________________________________________________________________
conv2d_810 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_936[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_937 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_810[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_170 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_937[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_938 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_transpose_170[0][0]       
__________________________________________________________________________________________________
concatenate_170 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_938[0][0]            
                                                                 leaky_re_lu_930[0][0]            
__________________________________________________________________________________________________
dropout_384 (Dropout)           (None, 64, 64, 512)  0           concatenate_170[0][0]            
__________________________________________________________________________________________________
conv2d_811 (Conv2D)             (None, 64, 64, 256)  1179904     dropout_384[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_939 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_811[0][0]                 
__________________________________________________________________________________________________
conv2d_812 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_939[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_940 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_812[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_171 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_940[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_941 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_transpose_171[0][0]       
__________________________________________________________________________________________________
concatenate_171 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_941[0][0]            
                                                                 leaky_re_lu_928[0][0]            
__________________________________________________________________________________________________
dropout_385 (Dropout)           (None, 128, 128, 256 0           concatenate_171[0][0]            
__________________________________________________________________________________________________
conv2d_813 (Conv2D)             (None, 128, 128, 128 295040      dropout_385[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_942 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_813[0][0]                 
__________________________________________________________________________________________________
conv2d_814 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_942[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_943 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_814[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_172 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_943[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_944 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_transpose_172[0][0]       
__________________________________________________________________________________________________
concatenate_172 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_944[0][0]            
                                                                 leaky_re_lu_926[0][0]            
__________________________________________________________________________________________________
dropout_386 (Dropout)           (None, 256, 256, 128 0           concatenate_172[0][0]            
__________________________________________________________________________________________________
dropout_387 (Dropout)           (None, 256, 256, 128 0           dropout_386[0][0]                
__________________________________________________________________________________________________
conv2d_815 (Conv2D)             (None, 256, 256, 64) 73792       dropout_387[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_945 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_815[0][0]                 
__________________________________________________________________________________________________
conv2d_816 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_945[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_946 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_816[0][0]                 
__________________________________________________________________________________________________
conv2d_817 (Conv2D)             (None, 256, 256, 3)  195         leaky_re_lu_946[0][0]            
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 48s - loss: 0.5453 - acc: 0.9158 - val_loss: 0.2042 - val_acc: 0.9427

Epoch 00001: val_acc improved from -inf to 0.94271, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.1972 - acc: 0.9280 - val_loss: 0.1507 - val_acc: 0.9433

Epoch 00002: val_acc improved from 0.94271 to 0.94327, saving model to unn_grid.h5
Epoch 3/1000
 - 46s - loss: 0.1834 - acc: 0.9289 - val_loss: 0.1512 - val_acc: 0.9471

Epoch 00003: val_acc improved from 0.94327 to 0.94713, saving model to unn_grid.h5
Epoch 4/1000
 - 46s - loss: 0.1728 - acc: 0.9340 - val_loss: 0.1455 - val_acc: 0.9433

Epoch 00004: val_acc did not improve from 0.94713
Epoch 5/1000
 - 46s - loss: 0.1600 - acc: 0.9414 - val_loss: 0.1365 - val_acc: 0.9452

Epoch 00005: val_acc did not improve from 0.94713
Epoch 6/1000
 - 46s - loss: 0.1456 - acc: 0.9476 - val_loss: 0.1394 - val_acc: 0.9522

Epoch 00006: val_acc improved from 0.94713 to 0.95223, saving model to unn_grid.h5
Epoch 7/1000
 - 46s - loss: 0.1385 - acc: 0.9521 - val_loss: 0.1398 - val_acc: 0.9572

Epoch 00007: val_acc improved from 0.95223 to 0.95719, saving model to unn_grid.h5
Epoch 8/1000
 - 46s - loss: 0.1208 - acc: 0.9576 - val_loss: 0.1138 - val_acc: 0.9591

Epoch 00008: val_acc improved from 0.95719 to 0.95914, saving model to unn_grid.h5
Epoch 9/1000
 - 46s - loss: 0.1086 - acc: 0.9616 - val_loss: 0.1034 - val_acc: 0.9620

Epoch 00009: val_acc improved from 0.95914 to 0.96204, saving model to unn_grid.h5
Epoch 10/1000
 - 46s - loss: 0.1005 - acc: 0.9643 - val_loss: 0.1014 - val_acc: 0.9637

Epoch 00010: val_acc improved from 0.96204 to 0.96367, saving model to unn_grid.h5
Epoch 11/1000
 - 46s - loss: 0.0927 - acc: 0.9663 - val_loss: 0.1074 - val_acc: 0.9611

Epoch 00011: val_acc did not improve from 0.96367
Epoch 12/1000
 - 46s - loss: 0.0834 - acc: 0.9694 - val_loss: 0.1073 - val_acc: 0.9629

Epoch 00012: val_acc did not improve from 0.96367
Epoch 13/1000
 - 46s - loss: 0.0840 - acc: 0.9693 - val_loss: 0.1253 - val_acc: 0.9567

Epoch 00013: val_acc did not improve from 0.96367

Epoch 00013: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 14/1000
 - 46s - loss: 0.0680 - acc: 0.9743 - val_loss: 0.0990 - val_acc: 0.9657

Epoch 00014: val_acc improved from 0.96367 to 0.96569, saving model to unn_grid.h5
Epoch 15/1000
 - 46s - loss: 0.0616 - acc: 0.9764 - val_loss: 0.1040 - val_acc: 0.9662

Epoch 00015: val_acc improved from 0.96569 to 0.96620, saving model to unn_grid.h5
Epoch 16/1000
 - 46s - loss: 0.0587 - acc: 0.9775 - val_loss: 0.0962 - val_acc: 0.9668

Epoch 00016: val_acc improved from 0.96620 to 0.96684, saving model to unn_grid.h5
Epoch 17/1000
 - 46s - loss: 0.0570 - acc: 0.9781 - val_loss: 0.1035 - val_acc: 0.9664

Epoch 00017: val_acc did not improve from 0.96684
Epoch 18/1000
 - 46s - loss: 0.0554 - acc: 0.9786 - val_loss: 0.1056 - val_acc: 0.9675

Epoch 00018: val_acc improved from 0.96684 to 0.96751, saving model to unn_grid.h5
Epoch 19/1000
 - 46s - loss: 0.0536 - acc: 0.9792 - val_loss: 0.1183 - val_acc: 0.9668

Epoch 00019: val_acc did not improve from 0.96751
Epoch 20/1000
 - 46s - loss: 0.0526 - acc: 0.9798 - val_loss: 0.1066 - val_acc: 0.9656

Epoch 00020: val_acc did not improve from 0.96751
Epoch 21/1000
 - 46s - loss: 0.0510 - acc: 0.9802 - val_loss: 0.1124 - val_acc: 0.9655

Epoch 00021: val_acc did not improve from 0.96751

Epoch 00021: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 22/1000
 - 46s - loss: 0.0486 - acc: 0.9811 - val_loss: 0.1116 - val_acc: 0.9668

Epoch 00022: val_acc did not improve from 0.96751
Epoch 23/1000
 - 46s - loss: 0.0482 - acc: 0.9813 - val_loss: 0.1102 - val_acc: 0.9668

Epoch 00023: val_acc did not improve from 0.96751
Epoch 00023: early stopping
Model: "model_44"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_44 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_818 (Conv2D)             (None, 256, 256, 64) 640         input_44[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_947 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_818[0][0]                 
__________________________________________________________________________________________________
conv2d_819 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_947[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_948 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_819[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_173 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_948[0][0]            
__________________________________________________________________________________________________
dropout_388 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_173[0][0]          
__________________________________________________________________________________________________
conv2d_820 (Conv2D)             (None, 128, 128, 128 73856       dropout_388[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_949 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_820[0][0]                 
__________________________________________________________________________________________________
conv2d_821 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_949[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_950 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_821[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_174 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_950[0][0]            
__________________________________________________________________________________________________
dropout_389 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_174[0][0]          
__________________________________________________________________________________________________
conv2d_822 (Conv2D)             (None, 64, 64, 256)  295168      dropout_389[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_951 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_822[0][0]                 
__________________________________________________________________________________________________
conv2d_823 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_951[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_952 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_823[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_175 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_952[0][0]            
__________________________________________________________________________________________________
dropout_390 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_175[0][0]          
__________________________________________________________________________________________________
conv2d_824 (Conv2D)             (None, 32, 32, 512)  1180160     dropout_390[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_953 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_824[0][0]                 
__________________________________________________________________________________________________
conv2d_825 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_953[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_954 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_825[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_176 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_954[0][0]            
__________________________________________________________________________________________________
dropout_391 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_176[0][0]          
__________________________________________________________________________________________________
conv2d_826 (Conv2D)             (None, 16, 16, 1024) 4719616     dropout_391[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_955 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_826[0][0]                 
__________________________________________________________________________________________________
conv2d_827 (Conv2D)             (None, 16, 16, 1024) 9438208     leaky_re_lu_955[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_956 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_827[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_173 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_956[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_957 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_transpose_173[0][0]       
__________________________________________________________________________________________________
concatenate_173 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_957[0][0]            
                                                                 leaky_re_lu_954[0][0]            
__________________________________________________________________________________________________
dropout_392 (Dropout)           (None, 32, 32, 1024) 0           concatenate_173[0][0]            
__________________________________________________________________________________________________
conv2d_828 (Conv2D)             (None, 32, 32, 512)  4719104     dropout_392[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_958 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_828[0][0]                 
__________________________________________________________________________________________________
conv2d_829 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_958[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_959 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_829[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_174 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_959[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_960 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_transpose_174[0][0]       
__________________________________________________________________________________________________
concatenate_174 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_960[0][0]            
                                                                 leaky_re_lu_952[0][0]            
__________________________________________________________________________________________________
dropout_393 (Dropout)           (None, 64, 64, 512)  0           concatenate_174[0][0]            
__________________________________________________________________________________________________
conv2d_830 (Conv2D)             (None, 64, 64, 256)  1179904     dropout_393[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_961 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_830[0][0]                 
__________________________________________________________________________________________________
conv2d_831 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_961[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_962 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_831[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_175 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_962[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_963 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_transpose_175[0][0]       
__________________________________________________________________________________________________
concatenate_175 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_963[0][0]            
                                                                 leaky_re_lu_950[0][0]            
__________________________________________________________________________________________________
dropout_394 (Dropout)           (None, 128, 128, 256 0           concatenate_175[0][0]            
__________________________________________________________________________________________________
conv2d_832 (Conv2D)             (None, 128, 128, 128 295040      dropout_394[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_964 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_832[0][0]                 
__________________________________________________________________________________________________
conv2d_833 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_964[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_965 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_833[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_176 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_965[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_966 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_transpose_176[0][0]       
__________________________________________________________________________________________________
concatenate_176 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_966[0][0]            
                                                                 leaky_re_lu_948[0][0]            
__________________________________________________________________________________________________
dropout_395 (Dropout)           (None, 256, 256, 128 0           concatenate_176[0][0]            
__________________________________________________________________________________________________
dropout_396 (Dropout)           (None, 256, 256, 128 0           dropout_395[0][0]                
__________________________________________________________________________________________________
conv2d_834 (Conv2D)             (None, 256, 256, 64) 73792       dropout_396[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_967 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_834[0][0]                 
__________________________________________________________________________________________________
conv2d_835 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_967[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_968 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_835[0][0]                 
__________________________________________________________________________________________________
conv2d_836 (Conv2D)             (None, 256, 256, 3)  195         leaky_re_lu_968[0][0]            
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 48s - loss: 0.5561 - acc: 0.9253 - val_loss: 0.2084 - val_acc: 0.9431

Epoch 00001: val_acc improved from -inf to 0.94312, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.1866 - acc: 0.9371 - val_loss: 0.2099 - val_acc: 0.9432

Epoch 00002: val_acc improved from 0.94312 to 0.94316, saving model to unn_grid.h5
Epoch 3/1000
 - 46s - loss: 0.1740 - acc: 0.9375 - val_loss: 0.1836 - val_acc: 0.9433

Epoch 00003: val_acc improved from 0.94316 to 0.94329, saving model to unn_grid.h5
Epoch 4/1000
 - 46s - loss: 0.1631 - acc: 0.9383 - val_loss: 0.1454 - val_acc: 0.9444

Epoch 00004: val_acc improved from 0.94329 to 0.94440, saving model to unn_grid.h5
Epoch 5/1000
 - 46s - loss: 0.1507 - acc: 0.9442 - val_loss: 0.1411 - val_acc: 0.9490

Epoch 00005: val_acc improved from 0.94440 to 0.94897, saving model to unn_grid.h5
Epoch 6/1000
 - 46s - loss: 0.1430 - acc: 0.9489 - val_loss: 0.1243 - val_acc: 0.9529

Epoch 00006: val_acc improved from 0.94897 to 0.95292, saving model to unn_grid.h5
Epoch 7/1000
 - 46s - loss: 0.1287 - acc: 0.9534 - val_loss: 0.1339 - val_acc: 0.9530

Epoch 00007: val_acc improved from 0.95292 to 0.95303, saving model to unn_grid.h5
Epoch 8/1000
 - 46s - loss: 0.1153 - acc: 0.9588 - val_loss: 0.1547 - val_acc: 0.9472

Epoch 00008: val_acc did not improve from 0.95303
Epoch 9/1000
 - 46s - loss: 0.1034 - acc: 0.9624 - val_loss: 0.1187 - val_acc: 0.9572

Epoch 00009: val_acc improved from 0.95303 to 0.95725, saving model to unn_grid.h5
Epoch 10/1000
 - 46s - loss: 0.0980 - acc: 0.9645 - val_loss: 0.1057 - val_acc: 0.9595

Epoch 00010: val_acc improved from 0.95725 to 0.95954, saving model to unn_grid.h5
Epoch 11/1000
 - 46s - loss: 0.0927 - acc: 0.9667 - val_loss: 0.1095 - val_acc: 0.9607

Epoch 00011: val_acc improved from 0.95954 to 0.96074, saving model to unn_grid.h5
Epoch 12/1000
 - 46s - loss: 0.0848 - acc: 0.9689 - val_loss: 0.0955 - val_acc: 0.9650

Epoch 00012: val_acc improved from 0.96074 to 0.96505, saving model to unn_grid.h5
Epoch 13/1000
 - 46s - loss: 0.0798 - acc: 0.9705 - val_loss: 0.1072 - val_acc: 0.9608

Epoch 00013: val_acc did not improve from 0.96505
Epoch 14/1000
 - 46s - loss: 0.0765 - acc: 0.9720 - val_loss: 0.1032 - val_acc: 0.9629

Epoch 00014: val_acc did not improve from 0.96505
Epoch 15/1000
 - 46s - loss: 0.0692 - acc: 0.9739 - val_loss: 0.1037 - val_acc: 0.9648

Epoch 00015: val_acc did not improve from 0.96505

Epoch 00015: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 16/1000
 - 46s - loss: 0.0551 - acc: 0.9788 - val_loss: 0.0941 - val_acc: 0.9682

Epoch 00016: val_acc improved from 0.96505 to 0.96822, saving model to unn_grid.h5
Epoch 17/1000
 - 46s - loss: 0.0516 - acc: 0.9801 - val_loss: 0.0948 - val_acc: 0.9681

Epoch 00017: val_acc did not improve from 0.96822
Epoch 18/1000
 - 46s - loss: 0.0496 - acc: 0.9807 - val_loss: 0.0955 - val_acc: 0.9691

Epoch 00018: val_acc improved from 0.96822 to 0.96911, saving model to unn_grid.h5
Epoch 19/1000
 - 46s - loss: 0.0478 - acc: 0.9814 - val_loss: 0.0979 - val_acc: 0.9695

Epoch 00019: val_acc improved from 0.96911 to 0.96948, saving model to unn_grid.h5
Epoch 20/1000
 - 46s - loss: 0.0467 - acc: 0.9817 - val_loss: 0.0981 - val_acc: 0.9686

Epoch 00020: val_acc did not improve from 0.96948
Epoch 21/1000
 - 46s - loss: 0.0455 - acc: 0.9823 - val_loss: 0.1022 - val_acc: 0.9687

Epoch 00021: val_acc did not improve from 0.96948
Epoch 22/1000
 - 46s - loss: 0.0441 - acc: 0.9828 - val_loss: 0.1049 - val_acc: 0.9685

Epoch 00022: val_acc did not improve from 0.96948

Epoch 00022: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 23/1000
 - 46s - loss: 0.0421 - acc: 0.9835 - val_loss: 0.1047 - val_acc: 0.9687

Epoch 00023: val_acc did not improve from 0.96948
Epoch 24/1000
 - 46s - loss: 0.0416 - acc: 0.9837 - val_loss: 0.1046 - val_acc: 0.9687

Epoch 00024: val_acc did not improve from 0.96948
Epoch 00024: early stopping
Model: "model_45"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_45 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_837 (Conv2D)             (None, 256, 256, 64) 640         input_45[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_969 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_837[0][0]                 
__________________________________________________________________________________________________
conv2d_838 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_969[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_970 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_838[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_177 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_970[0][0]            
__________________________________________________________________________________________________
dropout_397 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_177[0][0]          
__________________________________________________________________________________________________
conv2d_839 (Conv2D)             (None, 128, 128, 128 73856       dropout_397[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_971 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_839[0][0]                 
__________________________________________________________________________________________________
conv2d_840 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_971[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_972 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_840[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_178 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_972[0][0]            
__________________________________________________________________________________________________
dropout_398 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_178[0][0]          
__________________________________________________________________________________________________
conv2d_841 (Conv2D)             (None, 64, 64, 256)  295168      dropout_398[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_973 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_841[0][0]                 
__________________________________________________________________________________________________
conv2d_842 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_973[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_974 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_842[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_179 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_974[0][0]            
__________________________________________________________________________________________________
dropout_399 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_179[0][0]          
__________________________________________________________________________________________________
conv2d_843 (Conv2D)             (None, 32, 32, 512)  1180160     dropout_399[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_975 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_843[0][0]                 
__________________________________________________________________________________________________
conv2d_844 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_975[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_976 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_844[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_180 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_976[0][0]            
__________________________________________________________________________________________________
dropout_400 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_180[0][0]          
__________________________________________________________________________________________________
conv2d_845 (Conv2D)             (None, 16, 16, 1024) 4719616     dropout_400[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_977 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_845[0][0]                 
__________________________________________________________________________________________________
conv2d_846 (Conv2D)             (None, 16, 16, 1024) 9438208     leaky_re_lu_977[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_978 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_846[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_177 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_978[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_979 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_transpose_177[0][0]       
__________________________________________________________________________________________________
concatenate_177 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_979[0][0]            
                                                                 leaky_re_lu_976[0][0]            
__________________________________________________________________________________________________
dropout_401 (Dropout)           (None, 32, 32, 1024) 0           concatenate_177[0][0]            
__________________________________________________________________________________________________
conv2d_847 (Conv2D)             (None, 32, 32, 512)  4719104     dropout_401[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_980 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_847[0][0]                 
__________________________________________________________________________________________________
conv2d_848 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_980[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_981 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_848[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_178 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_981[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_982 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_transpose_178[0][0]       
__________________________________________________________________________________________________
concatenate_178 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_982[0][0]            
                                                                 leaky_re_lu_974[0][0]            
__________________________________________________________________________________________________
dropout_402 (Dropout)           (None, 64, 64, 512)  0           concatenate_178[0][0]            
__________________________________________________________________________________________________
conv2d_849 (Conv2D)             (None, 64, 64, 256)  1179904     dropout_402[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_983 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_849[0][0]                 
__________________________________________________________________________________________________
conv2d_850 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_983[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_984 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_850[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_179 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_984[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_985 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_transpose_179[0][0]       
__________________________________________________________________________________________________
concatenate_179 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_985[0][0]            
                                                                 leaky_re_lu_972[0][0]            
__________________________________________________________________________________________________
dropout_403 (Dropout)           (None, 128, 128, 256 0           concatenate_179[0][0]            
__________________________________________________________________________________________________
conv2d_851 (Conv2D)             (None, 128, 128, 128 295040      dropout_403[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_986 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_851[0][0]                 
__________________________________________________________________________________________________
conv2d_852 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_986[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_987 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_852[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_180 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_987[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_988 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_transpose_180[0][0]       
__________________________________________________________________________________________________
concatenate_180 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_988[0][0]            
                                                                 leaky_re_lu_970[0][0]            
__________________________________________________________________________________________________
dropout_404 (Dropout)           (None, 256, 256, 128 0           concatenate_180[0][0]            
__________________________________________________________________________________________________
dropout_405 (Dropout)           (None, 256, 256, 128 0           dropout_404[0][0]                
__________________________________________________________________________________________________
conv2d_853 (Conv2D)             (None, 256, 256, 64) 73792       dropout_405[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_989 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_853[0][0]                 
__________________________________________________________________________________________________
conv2d_854 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_989[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_990 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_854[0][0]                 
__________________________________________________________________________________________________
conv2d_855 (Conv2D)             (None, 256, 256, 3)  195         leaky_re_lu_990[0][0]            
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1213 samples, validate on 135 samples
Epoch 1/1000
 - 48s - loss: 0.4404 - acc: 0.9320 - val_loss: 0.2687 - val_acc: 0.9134

Epoch 00001: val_acc improved from -inf to 0.91343, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.1804 - acc: 0.9400 - val_loss: 0.2071 - val_acc: 0.9135

Epoch 00002: val_acc improved from 0.91343 to 0.91348, saving model to unn_grid.h5
Epoch 3/1000
 - 46s - loss: 0.1671 - acc: 0.9403 - val_loss: 0.2171 - val_acc: 0.9135

Epoch 00003: val_acc improved from 0.91348 to 0.91348, saving model to unn_grid.h5
Epoch 4/1000
 - 46s - loss: 0.1564 - acc: 0.9406 - val_loss: 0.2031 - val_acc: 0.9142

Epoch 00004: val_acc improved from 0.91348 to 0.91419, saving model to unn_grid.h5
Epoch 5/1000
 - 46s - loss: 0.1487 - acc: 0.9439 - val_loss: 0.1832 - val_acc: 0.9135

Epoch 00005: val_acc did not improve from 0.91419
Epoch 6/1000
 - 46s - loss: 0.1434 - acc: 0.9452 - val_loss: 0.1706 - val_acc: 0.9412

Epoch 00006: val_acc improved from 0.91419 to 0.94123, saving model to unn_grid.h5
Epoch 7/1000
 - 46s - loss: 0.1295 - acc: 0.9535 - val_loss: 0.1541 - val_acc: 0.9421

Epoch 00007: val_acc improved from 0.94123 to 0.94209, saving model to unn_grid.h5
Epoch 8/1000
 - 46s - loss: 0.1227 - acc: 0.9570 - val_loss: 0.1474 - val_acc: 0.9478

Epoch 00008: val_acc improved from 0.94209 to 0.94778, saving model to unn_grid.h5
Epoch 9/1000
 - 46s - loss: 0.1081 - acc: 0.9611 - val_loss: 0.1242 - val_acc: 0.9542

Epoch 00009: val_acc improved from 0.94778 to 0.95424, saving model to unn_grid.h5
Epoch 10/1000
 - 46s - loss: 0.0987 - acc: 0.9646 - val_loss: 0.1290 - val_acc: 0.9514

Epoch 00010: val_acc did not improve from 0.95424
Epoch 11/1000
 - 46s - loss: 0.0924 - acc: 0.9668 - val_loss: 0.1171 - val_acc: 0.9571

Epoch 00011: val_acc improved from 0.95424 to 0.95707, saving model to unn_grid.h5
Epoch 12/1000
 - 46s - loss: 0.0873 - acc: 0.9679 - val_loss: 0.1185 - val_acc: 0.9576

Epoch 00012: val_acc improved from 0.95707 to 0.95764, saving model to unn_grid.h5
Epoch 13/1000
 - 46s - loss: 0.0787 - acc: 0.9710 - val_loss: 0.1178 - val_acc: 0.9582

Epoch 00013: val_acc improved from 0.95764 to 0.95816, saving model to unn_grid.h5
Epoch 14/1000
 - 46s - loss: 0.0719 - acc: 0.9732 - val_loss: 0.1448 - val_acc: 0.9492

Epoch 00014: val_acc did not improve from 0.95816
Epoch 15/1000
 - 46s - loss: 0.0697 - acc: 0.9736 - val_loss: 0.1268 - val_acc: 0.9559

Epoch 00015: val_acc did not improve from 0.95816
Epoch 16/1000
 - 46s - loss: 0.0667 - acc: 0.9750 - val_loss: 0.1150 - val_acc: 0.9568

Epoch 00016: val_acc did not improve from 0.95816

Epoch 00016: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 17/1000
 - 46s - loss: 0.0524 - acc: 0.9798 - val_loss: 0.1127 - val_acc: 0.9623

Epoch 00017: val_acc improved from 0.95816 to 0.96229, saving model to unn_grid.h5
Epoch 18/1000
 - 46s - loss: 0.0473 - acc: 0.9814 - val_loss: 0.1178 - val_acc: 0.9625

Epoch 00018: val_acc improved from 0.96229 to 0.96247, saving model to unn_grid.h5
Epoch 19/1000
 - 46s - loss: 0.0451 - acc: 0.9823 - val_loss: 0.1164 - val_acc: 0.9629

Epoch 00019: val_acc improved from 0.96247 to 0.96291, saving model to unn_grid.h5
Epoch 20/1000
 - 46s - loss: 0.0436 - acc: 0.9828 - val_loss: 0.1182 - val_acc: 0.9624

Epoch 00020: val_acc did not improve from 0.96291
Epoch 21/1000
 - 46s - loss: 0.0417 - acc: 0.9836 - val_loss: 0.1201 - val_acc: 0.9627

Epoch 00021: val_acc did not improve from 0.96291
Epoch 22/1000
 - 46s - loss: 0.0406 - acc: 0.9840 - val_loss: 0.1271 - val_acc: 0.9622

Epoch 00022: val_acc did not improve from 0.96291

Epoch 00022: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 23/1000
 - 46s - loss: 0.0384 - acc: 0.9848 - val_loss: 0.1243 - val_acc: 0.9627

Epoch 00023: val_acc did not improve from 0.96291
Epoch 24/1000
 - 46s - loss: 0.0382 - acc: 0.9849 - val_loss: 0.1246 - val_acc: 0.9628

Epoch 00024: val_acc did not improve from 0.96291
Epoch 00024: early stopping
scores= [[0.94593302 0.45337382 0.40869075]
 [0.93582602 0.33330832 0.3119443 ]
 [0.95986734 0.64962314 0.57892187]
 [0.93558513 0.33322472 0.31186717]
 [0.95149693 0.52931513 0.48150358]
 [0.93571018 0.33331998 0.31195914]
 [0.95960049 0.62126837 0.55187472]
 [0.93582604 0.33330626 0.31194201]
 [0.96562115 0.72077765 0.63546703]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]] parameters= (64, 'Adam', 0.35, 'glorot_uniform', 0.0001)
Model: "model_46"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_46 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_856 (Conv2D)             (None, 256, 256, 64) 640         input_46[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_991 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_856[0][0]                 
__________________________________________________________________________________________________
conv2d_857 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_991[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_992 (LeakyReLU)     (None, 256, 256, 64) 0           conv2d_857[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_181 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_992[0][0]            
__________________________________________________________________________________________________
dropout_406 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_181[0][0]          
__________________________________________________________________________________________________
conv2d_858 (Conv2D)             (None, 128, 128, 128 73856       dropout_406[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_993 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_858[0][0]                 
__________________________________________________________________________________________________
conv2d_859 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_993[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_994 (LeakyReLU)     (None, 128, 128, 128 0           conv2d_859[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_182 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_994[0][0]            
__________________________________________________________________________________________________
dropout_407 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_182[0][0]          
__________________________________________________________________________________________________
conv2d_860 (Conv2D)             (None, 64, 64, 256)  295168      dropout_407[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_995 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_860[0][0]                 
__________________________________________________________________________________________________
conv2d_861 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_995[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_996 (LeakyReLU)     (None, 64, 64, 256)  0           conv2d_861[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_183 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_996[0][0]            
__________________________________________________________________________________________________
dropout_408 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_183[0][0]          
__________________________________________________________________________________________________
conv2d_862 (Conv2D)             (None, 32, 32, 512)  1180160     dropout_408[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_997 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_862[0][0]                 
__________________________________________________________________________________________________
conv2d_863 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_997[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_998 (LeakyReLU)     (None, 32, 32, 512)  0           conv2d_863[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_184 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_998[0][0]            
__________________________________________________________________________________________________
dropout_409 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_184[0][0]          
__________________________________________________________________________________________________
conv2d_864 (Conv2D)             (None, 16, 16, 1024) 4719616     dropout_409[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_999 (LeakyReLU)     (None, 16, 16, 1024) 0           conv2d_864[0][0]                 
__________________________________________________________________________________________________
conv2d_865 (Conv2D)             (None, 16, 16, 1024) 9438208     leaky_re_lu_999[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_1000 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_865[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_181 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_1000[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1001 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_transpose_181[0][0]       
__________________________________________________________________________________________________
concatenate_181 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_1001[0][0]           
                                                                 leaky_re_lu_998[0][0]            
__________________________________________________________________________________________________
dropout_410 (Dropout)           (None, 32, 32, 1024) 0           concatenate_181[0][0]            
__________________________________________________________________________________________________
conv2d_866 (Conv2D)             (None, 32, 32, 512)  4719104     dropout_410[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1002 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_866[0][0]                 
__________________________________________________________________________________________________
conv2d_867 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_1002[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1003 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_867[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_182 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_1003[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1004 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_transpose_182[0][0]       
__________________________________________________________________________________________________
concatenate_182 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_1004[0][0]           
                                                                 leaky_re_lu_996[0][0]            
__________________________________________________________________________________________________
dropout_411 (Dropout)           (None, 64, 64, 512)  0           concatenate_182[0][0]            
__________________________________________________________________________________________________
conv2d_868 (Conv2D)             (None, 64, 64, 256)  1179904     dropout_411[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1005 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_868[0][0]                 
__________________________________________________________________________________________________
conv2d_869 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_1005[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1006 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_869[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_183 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_1006[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1007 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_transpose_183[0][0]       
__________________________________________________________________________________________________
concatenate_183 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_1007[0][0]           
                                                                 leaky_re_lu_994[0][0]            
__________________________________________________________________________________________________
dropout_412 (Dropout)           (None, 128, 128, 256 0           concatenate_183[0][0]            
__________________________________________________________________________________________________
conv2d_870 (Conv2D)             (None, 128, 128, 128 295040      dropout_412[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1008 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_870[0][0]                 
__________________________________________________________________________________________________
conv2d_871 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_1008[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1009 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_871[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_184 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_1009[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1010 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_transpose_184[0][0]       
__________________________________________________________________________________________________
concatenate_184 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_1010[0][0]           
                                                                 leaky_re_lu_992[0][0]            
__________________________________________________________________________________________________
dropout_413 (Dropout)           (None, 256, 256, 128 0           concatenate_184[0][0]            
__________________________________________________________________________________________________
dropout_414 (Dropout)           (None, 256, 256, 128 0           dropout_413[0][0]                
__________________________________________________________________________________________________
conv2d_872 (Conv2D)             (None, 256, 256, 64) 73792       dropout_414[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1011 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_872[0][0]                 
__________________________________________________________________________________________________
conv2d_873 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_1011[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1012 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_873[0][0]                 
__________________________________________________________________________________________________
conv2d_874 (Conv2D)             (None, 256, 256, 3)  195         leaky_re_lu_1012[0][0]           
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 48s - loss: 1.1557 - acc: 0.8570 - val_loss: 0.6441 - val_acc: 0.9433

Epoch 00001: val_acc improved from -inf to 0.94327, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.5479 - acc: 0.9262 - val_loss: 0.4404 - val_acc: 0.9432

Epoch 00002: val_acc did not improve from 0.94327
Epoch 3/1000
 - 46s - loss: 0.4233 - acc: 0.9228 - val_loss: 0.2917 - val_acc: 0.9398

Epoch 00003: val_acc did not improve from 0.94327
Epoch 4/1000
 - 46s - loss: 0.2638 - acc: 0.9245 - val_loss: 0.2787 - val_acc: 0.9376

Epoch 00004: val_acc did not improve from 0.94327

Epoch 00004: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 5/1000
 - 46s - loss: 0.2201 - acc: 0.9277 - val_loss: 0.2382 - val_acc: 0.9381

Epoch 00005: val_acc did not improve from 0.94327
Epoch 6/1000
 - 46s - loss: 0.2144 - acc: 0.9281 - val_loss: 0.2436 - val_acc: 0.9383

Epoch 00006: val_acc did not improve from 0.94327
Epoch 00006: early stopping
Model: "model_47"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_47 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_875 (Conv2D)             (None, 256, 256, 64) 640         input_47[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_1013 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_875[0][0]                 
__________________________________________________________________________________________________
conv2d_876 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_1013[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1014 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_876[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_185 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_1014[0][0]           
__________________________________________________________________________________________________
dropout_415 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_185[0][0]          
__________________________________________________________________________________________________
conv2d_877 (Conv2D)             (None, 128, 128, 128 73856       dropout_415[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1015 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_877[0][0]                 
__________________________________________________________________________________________________
conv2d_878 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_1015[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1016 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_878[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_186 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_1016[0][0]           
__________________________________________________________________________________________________
dropout_416 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_186[0][0]          
__________________________________________________________________________________________________
conv2d_879 (Conv2D)             (None, 64, 64, 256)  295168      dropout_416[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1017 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_879[0][0]                 
__________________________________________________________________________________________________
conv2d_880 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_1017[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1018 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_880[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_187 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_1018[0][0]           
__________________________________________________________________________________________________
dropout_417 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_187[0][0]          
__________________________________________________________________________________________________
conv2d_881 (Conv2D)             (None, 32, 32, 512)  1180160     dropout_417[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1019 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_881[0][0]                 
__________________________________________________________________________________________________
conv2d_882 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_1019[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1020 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_882[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_188 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_1020[0][0]           
__________________________________________________________________________________________________
dropout_418 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_188[0][0]          
__________________________________________________________________________________________________
conv2d_883 (Conv2D)             (None, 16, 16, 1024) 4719616     dropout_418[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1021 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_883[0][0]                 
__________________________________________________________________________________________________
conv2d_884 (Conv2D)             (None, 16, 16, 1024) 9438208     leaky_re_lu_1021[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1022 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_884[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_185 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_1022[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1023 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_transpose_185[0][0]       
__________________________________________________________________________________________________
concatenate_185 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_1023[0][0]           
                                                                 leaky_re_lu_1020[0][0]           
__________________________________________________________________________________________________
dropout_419 (Dropout)           (None, 32, 32, 1024) 0           concatenate_185[0][0]            
__________________________________________________________________________________________________
conv2d_885 (Conv2D)             (None, 32, 32, 512)  4719104     dropout_419[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1024 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_885[0][0]                 
__________________________________________________________________________________________________
conv2d_886 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_1024[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1025 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_886[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_186 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_1025[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1026 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_transpose_186[0][0]       
__________________________________________________________________________________________________
concatenate_186 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_1026[0][0]           
                                                                 leaky_re_lu_1018[0][0]           
__________________________________________________________________________________________________
dropout_420 (Dropout)           (None, 64, 64, 512)  0           concatenate_186[0][0]            
__________________________________________________________________________________________________
conv2d_887 (Conv2D)             (None, 64, 64, 256)  1179904     dropout_420[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1027 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_887[0][0]                 
__________________________________________________________________________________________________
conv2d_888 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_1027[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1028 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_888[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_187 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_1028[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1029 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_transpose_187[0][0]       
__________________________________________________________________________________________________
concatenate_187 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_1029[0][0]           
                                                                 leaky_re_lu_1016[0][0]           
__________________________________________________________________________________________________
dropout_421 (Dropout)           (None, 128, 128, 256 0           concatenate_187[0][0]            
__________________________________________________________________________________________________
conv2d_889 (Conv2D)             (None, 128, 128, 128 295040      dropout_421[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1030 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_889[0][0]                 
__________________________________________________________________________________________________
conv2d_890 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_1030[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1031 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_890[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_188 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_1031[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1032 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_transpose_188[0][0]       
__________________________________________________________________________________________________
concatenate_188 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_1032[0][0]           
                                                                 leaky_re_lu_1014[0][0]           
__________________________________________________________________________________________________
dropout_422 (Dropout)           (None, 256, 256, 128 0           concatenate_188[0][0]            
__________________________________________________________________________________________________
dropout_423 (Dropout)           (None, 256, 256, 128 0           dropout_422[0][0]                
__________________________________________________________________________________________________
conv2d_891 (Conv2D)             (None, 256, 256, 64) 73792       dropout_423[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1033 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_891[0][0]                 
__________________________________________________________________________________________________
conv2d_892 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_1033[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1034 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_892[0][0]                 
__________________________________________________________________________________________________
conv2d_893 (Conv2D)             (None, 256, 256, 3)  195         leaky_re_lu_1034[0][0]           
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 48s - loss: 0.6616 - acc: 0.9173 - val_loss: 0.6192 - val_acc: 0.9432

Epoch 00001: val_acc improved from -inf to 0.94325, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.3995 - acc: 0.9290 - val_loss: 0.3084 - val_acc: 0.9423

Epoch 00002: val_acc did not improve from 0.94325
Epoch 3/1000
 - 46s - loss: 0.2292 - acc: 0.9309 - val_loss: 0.2388 - val_acc: 0.9356

Epoch 00003: val_acc did not improve from 0.94325
Epoch 4/1000
 - 46s - loss: 0.1877 - acc: 0.9344 - val_loss: 0.2032 - val_acc: 0.9322

Epoch 00004: val_acc did not improve from 0.94325

Epoch 00004: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 5/1000
 - 46s - loss: 0.1736 - acc: 0.9357 - val_loss: 0.2136 - val_acc: 0.9319

Epoch 00005: val_acc did not improve from 0.94325
Epoch 6/1000
 - 46s - loss: 0.1718 - acc: 0.9359 - val_loss: 0.2123 - val_acc: 0.9307

Epoch 00006: val_acc did not improve from 0.94325
Epoch 00006: early stopping
Model: "model_48"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_48 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_894 (Conv2D)             (None, 256, 256, 64) 640         input_48[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_1035 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_894[0][0]                 
__________________________________________________________________________________________________
conv2d_895 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_1035[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1036 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_895[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_189 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_1036[0][0]           
__________________________________________________________________________________________________
dropout_424 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_189[0][0]          
__________________________________________________________________________________________________
conv2d_896 (Conv2D)             (None, 128, 128, 128 73856       dropout_424[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1037 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_896[0][0]                 
__________________________________________________________________________________________________
conv2d_897 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_1037[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1038 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_897[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_190 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_1038[0][0]           
__________________________________________________________________________________________________
dropout_425 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_190[0][0]          
__________________________________________________________________________________________________
conv2d_898 (Conv2D)             (None, 64, 64, 256)  295168      dropout_425[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1039 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_898[0][0]                 
__________________________________________________________________________________________________
conv2d_899 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_1039[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1040 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_899[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_191 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_1040[0][0]           
__________________________________________________________________________________________________
dropout_426 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_191[0][0]          
__________________________________________________________________________________________________
conv2d_900 (Conv2D)             (None, 32, 32, 512)  1180160     dropout_426[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1041 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_900[0][0]                 
__________________________________________________________________________________________________
conv2d_901 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_1041[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1042 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_901[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_192 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_1042[0][0]           
__________________________________________________________________________________________________
dropout_427 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_192[0][0]          
__________________________________________________________________________________________________
conv2d_902 (Conv2D)             (None, 16, 16, 1024) 4719616     dropout_427[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1043 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_902[0][0]                 
__________________________________________________________________________________________________
conv2d_903 (Conv2D)             (None, 16, 16, 1024) 9438208     leaky_re_lu_1043[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1044 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_903[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_189 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_1044[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1045 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_transpose_189[0][0]       
__________________________________________________________________________________________________
concatenate_189 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_1045[0][0]           
                                                                 leaky_re_lu_1042[0][0]           
__________________________________________________________________________________________________
dropout_428 (Dropout)           (None, 32, 32, 1024) 0           concatenate_189[0][0]            
__________________________________________________________________________________________________
conv2d_904 (Conv2D)             (None, 32, 32, 512)  4719104     dropout_428[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1046 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_904[0][0]                 
__________________________________________________________________________________________________
conv2d_905 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_1046[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1047 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_905[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_190 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_1047[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1048 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_transpose_190[0][0]       
__________________________________________________________________________________________________
concatenate_190 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_1048[0][0]           
                                                                 leaky_re_lu_1040[0][0]           
__________________________________________________________________________________________________
dropout_429 (Dropout)           (None, 64, 64, 512)  0           concatenate_190[0][0]            
__________________________________________________________________________________________________
conv2d_906 (Conv2D)             (None, 64, 64, 256)  1179904     dropout_429[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1049 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_906[0][0]                 
__________________________________________________________________________________________________
conv2d_907 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_1049[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1050 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_907[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_191 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_1050[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1051 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_transpose_191[0][0]       
__________________________________________________________________________________________________
concatenate_191 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_1051[0][0]           
                                                                 leaky_re_lu_1038[0][0]           
__________________________________________________________________________________________________
dropout_430 (Dropout)           (None, 128, 128, 256 0           concatenate_191[0][0]            
__________________________________________________________________________________________________
conv2d_908 (Conv2D)             (None, 128, 128, 128 295040      dropout_430[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1052 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_908[0][0]                 
__________________________________________________________________________________________________
conv2d_909 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_1052[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1053 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_909[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_192 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_1053[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1054 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_transpose_192[0][0]       
__________________________________________________________________________________________________
concatenate_192 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_1054[0][0]           
                                                                 leaky_re_lu_1036[0][0]           
__________________________________________________________________________________________________
dropout_431 (Dropout)           (None, 256, 256, 128 0           concatenate_192[0][0]            
__________________________________________________________________________________________________
dropout_432 (Dropout)           (None, 256, 256, 128 0           dropout_431[0][0]                
__________________________________________________________________________________________________
conv2d_910 (Conv2D)             (None, 256, 256, 64) 73792       dropout_432[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1055 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_910[0][0]                 
__________________________________________________________________________________________________
conv2d_911 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_1055[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1056 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_911[0][0]                 
__________________________________________________________________________________________________
conv2d_912 (Conv2D)             (None, 256, 256, 3)  195         leaky_re_lu_1056[0][0]           
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 48s - loss: 1.3013 - acc: 0.8413 - val_loss: 0.6580 - val_acc: 0.9432

Epoch 00001: val_acc improved from -inf to 0.94320, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.5659 - acc: 0.9229 - val_loss: 0.6157 - val_acc: 0.9433

Epoch 00002: val_acc improved from 0.94320 to 0.94326, saving model to unn_grid.h5
Epoch 3/1000
 - 46s - loss: 0.4457 - acc: 0.9210 - val_loss: 0.3172 - val_acc: 0.9429

Epoch 00003: val_acc did not improve from 0.94326
Epoch 4/1000
 - 46s - loss: 0.2766 - acc: 0.9219 - val_loss: 0.2433 - val_acc: 0.9413

Epoch 00004: val_acc did not improve from 0.94326

Epoch 00004: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 5/1000
 - 46s - loss: 0.2217 - acc: 0.9261 - val_loss: 0.2191 - val_acc: 0.9415

Epoch 00005: val_acc did not improve from 0.94326
Epoch 6/1000
 - 46s - loss: 0.2178 - acc: 0.9267 - val_loss: 0.2142 - val_acc: 0.9413

Epoch 00006: val_acc did not improve from 0.94326
Epoch 7/1000
 - 46s - loss: 0.2140 - acc: 0.9270 - val_loss: 0.2116 - val_acc: 0.9409

Epoch 00007: val_acc did not improve from 0.94326

Epoch 00007: ReduceLROnPlateau reducing learning rate to 9.999999974752428e-08.
Epoch 00007: early stopping
Model: "model_49"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_49 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_913 (Conv2D)             (None, 256, 256, 64) 640         input_49[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_1057 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_913[0][0]                 
__________________________________________________________________________________________________
conv2d_914 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_1057[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1058 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_914[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_193 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_1058[0][0]           
__________________________________________________________________________________________________
dropout_433 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_193[0][0]          
__________________________________________________________________________________________________
conv2d_915 (Conv2D)             (None, 128, 128, 128 73856       dropout_433[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1059 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_915[0][0]                 
__________________________________________________________________________________________________
conv2d_916 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_1059[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1060 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_916[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_194 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_1060[0][0]           
__________________________________________________________________________________________________
dropout_434 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_194[0][0]          
__________________________________________________________________________________________________
conv2d_917 (Conv2D)             (None, 64, 64, 256)  295168      dropout_434[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1061 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_917[0][0]                 
__________________________________________________________________________________________________
conv2d_918 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_1061[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1062 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_918[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_195 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_1062[0][0]           
__________________________________________________________________________________________________
dropout_435 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_195[0][0]          
__________________________________________________________________________________________________
conv2d_919 (Conv2D)             (None, 32, 32, 512)  1180160     dropout_435[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1063 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_919[0][0]                 
__________________________________________________________________________________________________
conv2d_920 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_1063[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1064 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_920[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_196 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_1064[0][0]           
__________________________________________________________________________________________________
dropout_436 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_196[0][0]          
__________________________________________________________________________________________________
conv2d_921 (Conv2D)             (None, 16, 16, 1024) 4719616     dropout_436[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1065 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_921[0][0]                 
__________________________________________________________________________________________________
conv2d_922 (Conv2D)             (None, 16, 16, 1024) 9438208     leaky_re_lu_1065[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1066 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_922[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_193 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_1066[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1067 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_transpose_193[0][0]       
__________________________________________________________________________________________________
concatenate_193 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_1067[0][0]           
                                                                 leaky_re_lu_1064[0][0]           
__________________________________________________________________________________________________
dropout_437 (Dropout)           (None, 32, 32, 1024) 0           concatenate_193[0][0]            
__________________________________________________________________________________________________
conv2d_923 (Conv2D)             (None, 32, 32, 512)  4719104     dropout_437[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1068 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_923[0][0]                 
__________________________________________________________________________________________________
conv2d_924 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_1068[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1069 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_924[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_194 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_1069[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1070 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_transpose_194[0][0]       
__________________________________________________________________________________________________
concatenate_194 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_1070[0][0]           
                                                                 leaky_re_lu_1062[0][0]           
__________________________________________________________________________________________________
dropout_438 (Dropout)           (None, 64, 64, 512)  0           concatenate_194[0][0]            
__________________________________________________________________________________________________
conv2d_925 (Conv2D)             (None, 64, 64, 256)  1179904     dropout_438[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1071 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_925[0][0]                 
__________________________________________________________________________________________________
conv2d_926 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_1071[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1072 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_926[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_195 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_1072[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1073 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_transpose_195[0][0]       
__________________________________________________________________________________________________
concatenate_195 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_1073[0][0]           
                                                                 leaky_re_lu_1060[0][0]           
__________________________________________________________________________________________________
dropout_439 (Dropout)           (None, 128, 128, 256 0           concatenate_195[0][0]            
__________________________________________________________________________________________________
conv2d_927 (Conv2D)             (None, 128, 128, 128 295040      dropout_439[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1074 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_927[0][0]                 
__________________________________________________________________________________________________
conv2d_928 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_1074[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1075 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_928[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_196 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_1075[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1076 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_transpose_196[0][0]       
__________________________________________________________________________________________________
concatenate_196 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_1076[0][0]           
                                                                 leaky_re_lu_1058[0][0]           
__________________________________________________________________________________________________
dropout_440 (Dropout)           (None, 256, 256, 128 0           concatenate_196[0][0]            
__________________________________________________________________________________________________
dropout_441 (Dropout)           (None, 256, 256, 128 0           dropout_440[0][0]                
__________________________________________________________________________________________________
conv2d_929 (Conv2D)             (None, 256, 256, 64) 73792       dropout_441[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1077 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_929[0][0]                 
__________________________________________________________________________________________________
conv2d_930 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_1077[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1078 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_930[0][0]                 
__________________________________________________________________________________________________
conv2d_931 (Conv2D)             (None, 256, 256, 3)  195         leaky_re_lu_1078[0][0]           
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 47s - loss: 1.5042 - acc: 0.8474 - val_loss: 0.6734 - val_acc: 0.9433

Epoch 00001: val_acc improved from -inf to 0.94326, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.6466 - acc: 0.9327 - val_loss: 0.6301 - val_acc: 0.9433

Epoch 00002: val_acc improved from 0.94326 to 0.94328, saving model to unn_grid.h5
Epoch 3/1000
 - 46s - loss: 0.5817 - acc: 0.9321 - val_loss: 0.5341 - val_acc: 0.9432

Epoch 00003: val_acc did not improve from 0.94328
Epoch 4/1000
 - 46s - loss: 0.4759 - acc: 0.9282 - val_loss: 0.3437 - val_acc: 0.9338

Epoch 00004: val_acc did not improve from 0.94328

Epoch 00004: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 5/1000
 - 46s - loss: 0.3580 - acc: 0.9296 - val_loss: 0.3862 - val_acc: 0.8762

Epoch 00005: val_acc did not improve from 0.94328
Epoch 6/1000
 - 46s - loss: 0.3341 - acc: 0.9296 - val_loss: 0.4391 - val_acc: 0.8516

Epoch 00006: val_acc did not improve from 0.94328
Epoch 7/1000
 - 46s - loss: 0.3154 - acc: 0.9297 - val_loss: 0.4001 - val_acc: 0.8652

Epoch 00007: val_acc did not improve from 0.94328

Epoch 00007: ReduceLROnPlateau reducing learning rate to 9.999999974752428e-08.
Epoch 00007: early stopping
Model: "model_50"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_50 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_932 (Conv2D)             (None, 256, 256, 64) 640         input_50[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_1079 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_932[0][0]                 
__________________________________________________________________________________________________
conv2d_933 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_1079[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1080 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_933[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_197 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_1080[0][0]           
__________________________________________________________________________________________________
dropout_442 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_197[0][0]          
__________________________________________________________________________________________________
conv2d_934 (Conv2D)             (None, 128, 128, 128 73856       dropout_442[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1081 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_934[0][0]                 
__________________________________________________________________________________________________
conv2d_935 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_1081[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1082 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_935[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_198 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_1082[0][0]           
__________________________________________________________________________________________________
dropout_443 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_198[0][0]          
__________________________________________________________________________________________________
conv2d_936 (Conv2D)             (None, 64, 64, 256)  295168      dropout_443[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1083 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_936[0][0]                 
__________________________________________________________________________________________________
conv2d_937 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_1083[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1084 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_937[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_199 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_1084[0][0]           
__________________________________________________________________________________________________
dropout_444 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_199[0][0]          
__________________________________________________________________________________________________
conv2d_938 (Conv2D)             (None, 32, 32, 512)  1180160     dropout_444[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1085 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_938[0][0]                 
__________________________________________________________________________________________________
conv2d_939 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_1085[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1086 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_939[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_200 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_1086[0][0]           
__________________________________________________________________________________________________
dropout_445 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_200[0][0]          
__________________________________________________________________________________________________
conv2d_940 (Conv2D)             (None, 16, 16, 1024) 4719616     dropout_445[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1087 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_940[0][0]                 
__________________________________________________________________________________________________
conv2d_941 (Conv2D)             (None, 16, 16, 1024) 9438208     leaky_re_lu_1087[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1088 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_941[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_197 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_1088[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1089 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_transpose_197[0][0]       
__________________________________________________________________________________________________
concatenate_197 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_1089[0][0]           
                                                                 leaky_re_lu_1086[0][0]           
__________________________________________________________________________________________________
dropout_446 (Dropout)           (None, 32, 32, 1024) 0           concatenate_197[0][0]            
__________________________________________________________________________________________________
conv2d_942 (Conv2D)             (None, 32, 32, 512)  4719104     dropout_446[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1090 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_942[0][0]                 
__________________________________________________________________________________________________
conv2d_943 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_1090[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1091 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_943[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_198 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_1091[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1092 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_transpose_198[0][0]       
__________________________________________________________________________________________________
concatenate_198 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_1092[0][0]           
                                                                 leaky_re_lu_1084[0][0]           
__________________________________________________________________________________________________
dropout_447 (Dropout)           (None, 64, 64, 512)  0           concatenate_198[0][0]            
__________________________________________________________________________________________________
conv2d_944 (Conv2D)             (None, 64, 64, 256)  1179904     dropout_447[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1093 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_944[0][0]                 
__________________________________________________________________________________________________
conv2d_945 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_1093[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1094 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_945[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_199 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_1094[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1095 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_transpose_199[0][0]       
__________________________________________________________________________________________________
concatenate_199 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_1095[0][0]           
                                                                 leaky_re_lu_1082[0][0]           
__________________________________________________________________________________________________
dropout_448 (Dropout)           (None, 128, 128, 256 0           concatenate_199[0][0]            
__________________________________________________________________________________________________
conv2d_946 (Conv2D)             (None, 128, 128, 128 295040      dropout_448[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1096 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_946[0][0]                 
__________________________________________________________________________________________________
conv2d_947 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_1096[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1097 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_947[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_200 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_1097[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1098 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_transpose_200[0][0]       
__________________________________________________________________________________________________
concatenate_200 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_1098[0][0]           
                                                                 leaky_re_lu_1080[0][0]           
__________________________________________________________________________________________________
dropout_449 (Dropout)           (None, 256, 256, 128 0           concatenate_200[0][0]            
__________________________________________________________________________________________________
dropout_450 (Dropout)           (None, 256, 256, 128 0           dropout_449[0][0]                
__________________________________________________________________________________________________
conv2d_948 (Conv2D)             (None, 256, 256, 64) 73792       dropout_450[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1099 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_948[0][0]                 
__________________________________________________________________________________________________
conv2d_949 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_1099[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1100 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_949[0][0]                 
__________________________________________________________________________________________________
conv2d_950 (Conv2D)             (None, 256, 256, 3)  195         leaky_re_lu_1100[0][0]           
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1213 samples, validate on 135 samples
Epoch 1/1000
 - 48s - loss: 0.9201 - acc: 0.8821 - val_loss: 0.4431 - val_acc: 0.9135

Epoch 00001: val_acc improved from -inf to 0.91347, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.5241 - acc: 0.9358 - val_loss: 0.3498 - val_acc: 0.9135

Epoch 00002: val_acc improved from 0.91347 to 0.91348, saving model to unn_grid.h5
Epoch 3/1000
 - 46s - loss: 0.4490 - acc: 0.9325 - val_loss: 0.3824 - val_acc: 0.9132

Epoch 00003: val_acc did not improve from 0.91348
Epoch 4/1000
 - 46s - loss: 0.3070 - acc: 0.9315 - val_loss: 0.3042 - val_acc: 0.9121

Epoch 00004: val_acc did not improve from 0.91348

Epoch 00004: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 5/1000
 - 46s - loss: 0.2346 - acc: 0.9346 - val_loss: 0.3068 - val_acc: 0.9113

Epoch 00005: val_acc did not improve from 0.91348
Epoch 6/1000
 - 46s - loss: 0.2263 - acc: 0.9350 - val_loss: 0.3108 - val_acc: 0.9098

Epoch 00006: val_acc did not improve from 0.91348
Epoch 7/1000
 - 46s - loss: 0.2205 - acc: 0.9352 - val_loss: 0.2977 - val_acc: 0.9101

Epoch 00007: val_acc did not improve from 0.91348

Epoch 00007: ReduceLROnPlateau reducing learning rate to 9.999999974752428e-08.
Epoch 00007: early stopping
scores= [[0.94593302 0.45337382 0.40869075]
 [0.93582602 0.33330832 0.3119443 ]
 [0.95986734 0.64962314 0.57892187]
 [0.93558513 0.33322472 0.31186717]
 [0.95149693 0.52931513 0.48150358]
 [0.93571018 0.33331998 0.31195914]
 [0.95960049 0.62126837 0.55187472]
 [0.93582604 0.33330626 0.31194201]
 [0.96562115 0.72077765 0.63546703]
 [0.93588448 0.3333275  0.3119623 ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]] parameters= (64, 'Adam', 0.35, 'glorot_uniform', 1e-05)
Model: "model_51"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_51 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_951 (Conv2D)             (None, 256, 256, 64) 640         input_51[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_1101 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_951[0][0]                 
__________________________________________________________________________________________________
conv2d_952 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_1101[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1102 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_952[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_201 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_1102[0][0]           
__________________________________________________________________________________________________
dropout_451 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_201[0][0]          
__________________________________________________________________________________________________
conv2d_953 (Conv2D)             (None, 128, 128, 128 73856       dropout_451[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1103 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_953[0][0]                 
__________________________________________________________________________________________________
conv2d_954 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_1103[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1104 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_954[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_202 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_1104[0][0]           
__________________________________________________________________________________________________
dropout_452 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_202[0][0]          
__________________________________________________________________________________________________
conv2d_955 (Conv2D)             (None, 64, 64, 256)  295168      dropout_452[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1105 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_955[0][0]                 
__________________________________________________________________________________________________
conv2d_956 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_1105[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1106 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_956[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_203 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_1106[0][0]           
__________________________________________________________________________________________________
dropout_453 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_203[0][0]          
__________________________________________________________________________________________________
conv2d_957 (Conv2D)             (None, 32, 32, 512)  1180160     dropout_453[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1107 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_957[0][0]                 
__________________________________________________________________________________________________
conv2d_958 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_1107[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1108 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_958[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_204 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_1108[0][0]           
__________________________________________________________________________________________________
dropout_454 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_204[0][0]          
__________________________________________________________________________________________________
conv2d_959 (Conv2D)             (None, 16, 16, 1024) 4719616     dropout_454[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1109 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_959[0][0]                 
__________________________________________________________________________________________________
conv2d_960 (Conv2D)             (None, 16, 16, 1024) 9438208     leaky_re_lu_1109[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1110 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_960[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_201 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_1110[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1111 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_transpose_201[0][0]       
__________________________________________________________________________________________________
concatenate_201 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_1111[0][0]           
                                                                 leaky_re_lu_1108[0][0]           
__________________________________________________________________________________________________
dropout_455 (Dropout)           (None, 32, 32, 1024) 0           concatenate_201[0][0]            
__________________________________________________________________________________________________
conv2d_961 (Conv2D)             (None, 32, 32, 512)  4719104     dropout_455[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1112 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_961[0][0]                 
__________________________________________________________________________________________________
conv2d_962 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_1112[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1113 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_962[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_202 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_1113[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1114 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_transpose_202[0][0]       
__________________________________________________________________________________________________
concatenate_202 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_1114[0][0]           
                                                                 leaky_re_lu_1106[0][0]           
__________________________________________________________________________________________________
dropout_456 (Dropout)           (None, 64, 64, 512)  0           concatenate_202[0][0]            
__________________________________________________________________________________________________
conv2d_963 (Conv2D)             (None, 64, 64, 256)  1179904     dropout_456[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1115 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_963[0][0]                 
__________________________________________________________________________________________________
conv2d_964 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_1115[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1116 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_964[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_203 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_1116[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1117 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_transpose_203[0][0]       
__________________________________________________________________________________________________
concatenate_203 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_1117[0][0]           
                                                                 leaky_re_lu_1104[0][0]           
__________________________________________________________________________________________________
dropout_457 (Dropout)           (None, 128, 128, 256 0           concatenate_203[0][0]            
__________________________________________________________________________________________________
conv2d_965 (Conv2D)             (None, 128, 128, 128 295040      dropout_457[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1118 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_965[0][0]                 
__________________________________________________________________________________________________
conv2d_966 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_1118[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1119 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_966[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_204 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_1119[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1120 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_transpose_204[0][0]       
__________________________________________________________________________________________________
concatenate_204 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_1120[0][0]           
                                                                 leaky_re_lu_1102[0][0]           
__________________________________________________________________________________________________
dropout_458 (Dropout)           (None, 256, 256, 128 0           concatenate_204[0][0]            
__________________________________________________________________________________________________
dropout_459 (Dropout)           (None, 256, 256, 128 0           dropout_458[0][0]                
__________________________________________________________________________________________________
conv2d_967 (Conv2D)             (None, 256, 256, 64) 73792       dropout_459[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1121 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_967[0][0]                 
__________________________________________________________________________________________________
conv2d_968 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_1121[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1122 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_968[0][0]                 
__________________________________________________________________________________________________
conv2d_969 (Conv2D)             (None, 256, 256, 3)  195         leaky_re_lu_1122[0][0]           
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 48s - loss: 0.4956 - acc: 0.9217 - val_loss: 0.1976 - val_acc: 0.9433

Epoch 00001: val_acc improved from -inf to 0.94329, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.2134 - acc: 0.9326 - val_loss: 0.2057 - val_acc: 0.9433

Epoch 00002: val_acc improved from 0.94329 to 0.94329, saving model to unn_grid.h5
Epoch 3/1000
 - 46s - loss: 0.1914 - acc: 0.9329 - val_loss: 0.1822 - val_acc: 0.9433

Epoch 00003: val_acc did not improve from 0.94329
Epoch 4/1000
 - 46s - loss: 0.1806 - acc: 0.9329 - val_loss: 0.1628 - val_acc: 0.9433

Epoch 00004: val_acc did not improve from 0.94329

Epoch 00004: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 5/1000
 - 46s - loss: 0.1695 - acc: 0.9329 - val_loss: 0.1587 - val_acc: 0.9433

Epoch 00005: val_acc did not improve from 0.94329
Epoch 6/1000
 - 46s - loss: 0.1627 - acc: 0.9329 - val_loss: 0.1526 - val_acc: 0.9433

Epoch 00006: val_acc did not improve from 0.94329
Epoch 7/1000
 - 46s - loss: 0.1638 - acc: 0.9329 - val_loss: 0.1480 - val_acc: 0.9433

Epoch 00007: val_acc did not improve from 0.94329

Epoch 00007: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 00007: early stopping
Model: "model_52"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_52 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_970 (Conv2D)             (None, 256, 256, 64) 640         input_52[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_1123 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_970[0][0]                 
__________________________________________________________________________________________________
conv2d_971 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_1123[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1124 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_971[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_205 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_1124[0][0]           
__________________________________________________________________________________________________
dropout_460 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_205[0][0]          
__________________________________________________________________________________________________
conv2d_972 (Conv2D)             (None, 128, 128, 128 73856       dropout_460[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1125 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_972[0][0]                 
__________________________________________________________________________________________________
conv2d_973 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_1125[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1126 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_973[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_206 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_1126[0][0]           
__________________________________________________________________________________________________
dropout_461 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_206[0][0]          
__________________________________________________________________________________________________
conv2d_974 (Conv2D)             (None, 64, 64, 256)  295168      dropout_461[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1127 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_974[0][0]                 
__________________________________________________________________________________________________
conv2d_975 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_1127[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1128 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_975[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_207 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_1128[0][0]           
__________________________________________________________________________________________________
dropout_462 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_207[0][0]          
__________________________________________________________________________________________________
conv2d_976 (Conv2D)             (None, 32, 32, 512)  1180160     dropout_462[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1129 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_976[0][0]                 
__________________________________________________________________________________________________
conv2d_977 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_1129[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1130 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_977[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_208 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_1130[0][0]           
__________________________________________________________________________________________________
dropout_463 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_208[0][0]          
__________________________________________________________________________________________________
conv2d_978 (Conv2D)             (None, 16, 16, 1024) 4719616     dropout_463[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1131 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_978[0][0]                 
__________________________________________________________________________________________________
conv2d_979 (Conv2D)             (None, 16, 16, 1024) 9438208     leaky_re_lu_1131[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1132 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_979[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_205 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_1132[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1133 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_transpose_205[0][0]       
__________________________________________________________________________________________________
concatenate_205 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_1133[0][0]           
                                                                 leaky_re_lu_1130[0][0]           
__________________________________________________________________________________________________
dropout_464 (Dropout)           (None, 32, 32, 1024) 0           concatenate_205[0][0]            
__________________________________________________________________________________________________
conv2d_980 (Conv2D)             (None, 32, 32, 512)  4719104     dropout_464[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1134 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_980[0][0]                 
__________________________________________________________________________________________________
conv2d_981 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_1134[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1135 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_981[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_206 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_1135[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1136 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_transpose_206[0][0]       
__________________________________________________________________________________________________
concatenate_206 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_1136[0][0]           
                                                                 leaky_re_lu_1128[0][0]           
__________________________________________________________________________________________________
dropout_465 (Dropout)           (None, 64, 64, 512)  0           concatenate_206[0][0]            
__________________________________________________________________________________________________
conv2d_982 (Conv2D)             (None, 64, 64, 256)  1179904     dropout_465[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1137 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_982[0][0]                 
__________________________________________________________________________________________________
conv2d_983 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_1137[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1138 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_983[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_207 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_1138[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1139 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_transpose_207[0][0]       
__________________________________________________________________________________________________
concatenate_207 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_1139[0][0]           
                                                                 leaky_re_lu_1126[0][0]           
__________________________________________________________________________________________________
dropout_466 (Dropout)           (None, 128, 128, 256 0           concatenate_207[0][0]            
__________________________________________________________________________________________________
conv2d_984 (Conv2D)             (None, 128, 128, 128 295040      dropout_466[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1140 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_984[0][0]                 
__________________________________________________________________________________________________
conv2d_985 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_1140[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1141 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_985[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_208 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_1141[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1142 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_transpose_208[0][0]       
__________________________________________________________________________________________________
concatenate_208 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_1142[0][0]           
                                                                 leaky_re_lu_1124[0][0]           
__________________________________________________________________________________________________
dropout_467 (Dropout)           (None, 256, 256, 128 0           concatenate_208[0][0]            
__________________________________________________________________________________________________
dropout_468 (Dropout)           (None, 256, 256, 128 0           dropout_467[0][0]                
__________________________________________________________________________________________________
conv2d_986 (Conv2D)             (None, 256, 256, 64) 73792       dropout_468[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1143 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_986[0][0]                 
__________________________________________________________________________________________________
conv2d_987 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_1143[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1144 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_987[0][0]                 
__________________________________________________________________________________________________
conv2d_988 (Conv2D)             (None, 256, 256, 3)  195         leaky_re_lu_1144[0][0]           
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 47s - loss: 0.9527 - acc: 0.9314 - val_loss: 0.9141 - val_acc: 0.9433

Epoch 00001: val_acc improved from -inf to 0.94329, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 1.0042 - acc: 0.9377 - val_loss: 0.9141 - val_acc: 0.9433

Epoch 00002: val_acc did not improve from 0.94329
Epoch 3/1000
 - 46s - loss: 1.0042 - acc: 0.9377 - val_loss: 0.9141 - val_acc: 0.9433

Epoch 00003: val_acc did not improve from 0.94329
Epoch 4/1000
 - 46s - loss: 1.0042 - acc: 0.9377 - val_loss: 0.9141 - val_acc: 0.9433

Epoch 00004: val_acc did not improve from 0.94329

Epoch 00004: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 5/1000
 - 46s - loss: 1.0042 - acc: 0.9377 - val_loss: 0.9141 - val_acc: 0.9433

Epoch 00005: val_acc did not improve from 0.94329
Epoch 6/1000
 - 46s - loss: 1.0042 - acc: 0.9377 - val_loss: 0.9141 - val_acc: 0.9433

Epoch 00006: val_acc did not improve from 0.94329
Epoch 00006: early stopping
Model: "model_53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_53 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_989 (Conv2D)             (None, 256, 256, 64) 640         input_53[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_1145 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_989[0][0]                 
__________________________________________________________________________________________________
conv2d_990 (Conv2D)             (None, 256, 256, 64) 36928       leaky_re_lu_1145[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1146 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_990[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_209 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_1146[0][0]           
__________________________________________________________________________________________________
dropout_469 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_209[0][0]          
__________________________________________________________________________________________________
conv2d_991 (Conv2D)             (None, 128, 128, 128 73856       dropout_469[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1147 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_991[0][0]                 
__________________________________________________________________________________________________
conv2d_992 (Conv2D)             (None, 128, 128, 128 147584      leaky_re_lu_1147[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1148 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_992[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_210 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_1148[0][0]           
__________________________________________________________________________________________________
dropout_470 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_210[0][0]          
__________________________________________________________________________________________________
conv2d_993 (Conv2D)             (None, 64, 64, 256)  295168      dropout_470[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1149 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_993[0][0]                 
__________________________________________________________________________________________________
conv2d_994 (Conv2D)             (None, 64, 64, 256)  590080      leaky_re_lu_1149[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1150 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_994[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_211 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_1150[0][0]           
__________________________________________________________________________________________________
dropout_471 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_211[0][0]          
__________________________________________________________________________________________________
conv2d_995 (Conv2D)             (None, 32, 32, 512)  1180160     dropout_471[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1151 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_995[0][0]                 
__________________________________________________________________________________________________
conv2d_996 (Conv2D)             (None, 32, 32, 512)  2359808     leaky_re_lu_1151[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1152 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_996[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_212 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_1152[0][0]           
__________________________________________________________________________________________________
dropout_472 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_212[0][0]          
__________________________________________________________________________________________________
conv2d_997 (Conv2D)             (None, 16, 16, 1024) 4719616     dropout_472[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1153 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_997[0][0]                 
__________________________________________________________________________________________________
conv2d_998 (Conv2D)             (None, 16, 16, 1024) 9438208     leaky_re_lu_1153[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1154 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_998[0][0]                 
__________________________________________________________________________________________________
conv2d_transpose_209 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_1154[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1155 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_transpose_209[0][0]       
__________________________________________________________________________________________________
concatenate_209 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_1155[0][0]           
                                                                 leaky_re_lu_1152[0][0]           
__________________________________________________________________________________________________
dropout_473 (Dropout)           (None, 32, 32, 1024) 0           concatenate_209[0][0]            
__________________________________________________________________________________________________
conv2d_999 (Conv2D)             (None, 32, 32, 512)  4719104     dropout_473[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1156 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_999[0][0]                 
__________________________________________________________________________________________________
conv2d_1000 (Conv2D)            (None, 32, 32, 512)  2359808     leaky_re_lu_1156[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1157 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1000[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_210 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_1157[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1158 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_transpose_210[0][0]       
__________________________________________________________________________________________________
concatenate_210 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_1158[0][0]           
                                                                 leaky_re_lu_1150[0][0]           
__________________________________________________________________________________________________
dropout_474 (Dropout)           (None, 64, 64, 512)  0           concatenate_210[0][0]            
__________________________________________________________________________________________________
conv2d_1001 (Conv2D)            (None, 64, 64, 256)  1179904     dropout_474[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1159 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1001[0][0]                
__________________________________________________________________________________________________
conv2d_1002 (Conv2D)            (None, 64, 64, 256)  590080      leaky_re_lu_1159[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1160 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1002[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_211 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_1160[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1161 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_transpose_211[0][0]       
__________________________________________________________________________________________________
concatenate_211 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_1161[0][0]           
                                                                 leaky_re_lu_1148[0][0]           
__________________________________________________________________________________________________
dropout_475 (Dropout)           (None, 128, 128, 256 0           concatenate_211[0][0]            
__________________________________________________________________________________________________
conv2d_1003 (Conv2D)            (None, 128, 128, 128 295040      dropout_475[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1162 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1003[0][0]                
__________________________________________________________________________________________________
conv2d_1004 (Conv2D)            (None, 128, 128, 128 147584      leaky_re_lu_1162[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1163 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1004[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_212 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_1163[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1164 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_transpose_212[0][0]       
__________________________________________________________________________________________________
concatenate_212 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_1164[0][0]           
                                                                 leaky_re_lu_1146[0][0]           
__________________________________________________________________________________________________
dropout_476 (Dropout)           (None, 256, 256, 128 0           concatenate_212[0][0]            
__________________________________________________________________________________________________
dropout_477 (Dropout)           (None, 256, 256, 128 0           dropout_476[0][0]                
__________________________________________________________________________________________________
conv2d_1005 (Conv2D)            (None, 256, 256, 64) 73792       dropout_477[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1165 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1005[0][0]                
__________________________________________________________________________________________________
conv2d_1006 (Conv2D)            (None, 256, 256, 64) 36928       leaky_re_lu_1165[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1166 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1006[0][0]                
__________________________________________________________________________________________________
conv2d_1007 (Conv2D)            (None, 256, 256, 3)  195         leaky_re_lu_1166[0][0]           
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 48s - loss: 0.4054 - acc: 0.9259 - val_loss: 0.2071 - val_acc: 0.9433

Epoch 00001: val_acc improved from -inf to 0.94328, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.2032 - acc: 0.9294 - val_loss: 0.1881 - val_acc: 0.9432

Epoch 00002: val_acc did not improve from 0.94328
Epoch 3/1000
 - 46s - loss: 0.1830 - acc: 0.9294 - val_loss: 0.1582 - val_acc: 0.9433

Epoch 00003: val_acc improved from 0.94328 to 0.94329, saving model to unn_grid.h5
Epoch 4/1000
 - 46s - loss: 0.1708 - acc: 0.9300 - val_loss: 0.1545 - val_acc: 0.9468

Epoch 00004: val_acc improved from 0.94329 to 0.94682, saving model to unn_grid.h5
Epoch 5/1000
 - 46s - loss: 0.1626 - acc: 0.9333 - val_loss: 0.1341 - val_acc: 0.9495

Epoch 00005: val_acc improved from 0.94682 to 0.94946, saving model to unn_grid.h5
Epoch 6/1000
 - 46s - loss: 0.1499 - acc: 0.9441 - val_loss: 0.1283 - val_acc: 0.9557

Epoch 00006: val_acc improved from 0.94946 to 0.95570, saving model to unn_grid.h5
Epoch 7/1000
 - 46s - loss: 0.1373 - acc: 0.9510 - val_loss: 0.1355 - val_acc: 0.9546

Epoch 00007: val_acc did not improve from 0.95570
Epoch 8/1000
 - 46s - loss: 0.1182 - acc: 0.9576 - val_loss: 0.1169 - val_acc: 0.9620

Epoch 00008: val_acc improved from 0.95570 to 0.96203, saving model to unn_grid.h5
Epoch 9/1000
 - 46s - loss: 0.1104 - acc: 0.9608 - val_loss: 0.1304 - val_acc: 0.9537

Epoch 00009: val_acc did not improve from 0.96203
Epoch 10/1000
 - 46s - loss: 0.0965 - acc: 0.9651 - val_loss: 0.1110 - val_acc: 0.9635

Epoch 00010: val_acc improved from 0.96203 to 0.96353, saving model to unn_grid.h5
Epoch 11/1000
 - 46s - loss: 0.1005 - acc: 0.9641 - val_loss: 0.1043 - val_acc: 0.9638

Epoch 00011: val_acc improved from 0.96353 to 0.96380, saving model to unn_grid.h5
Epoch 12/1000
 - 46s - loss: 0.0854 - acc: 0.9686 - val_loss: 0.0983 - val_acc: 0.9647

Epoch 00012: val_acc improved from 0.96380 to 0.96471, saving model to unn_grid.h5
Epoch 13/1000
 - 46s - loss: 0.0780 - acc: 0.9711 - val_loss: 0.0969 - val_acc: 0.9654

Epoch 00013: val_acc improved from 0.96471 to 0.96543, saving model to unn_grid.h5
Epoch 14/1000
 - 46s - loss: 0.0726 - acc: 0.9730 - val_loss: 0.1115 - val_acc: 0.9643

Epoch 00014: val_acc did not improve from 0.96543
Epoch 15/1000
 - 46s - loss: 0.0692 - acc: 0.9743 - val_loss: 0.1118 - val_acc: 0.9657

Epoch 00015: val_acc improved from 0.96543 to 0.96568, saving model to unn_grid.h5
Epoch 16/1000
 - 46s - loss: 0.0638 - acc: 0.9761 - val_loss: 0.1081 - val_acc: 0.9617

Epoch 00016: val_acc did not improve from 0.96568
Epoch 17/1000
 - 46s - loss: 0.0599 - acc: 0.9778 - val_loss: 0.1091 - val_acc: 0.9644

Epoch 00017: val_acc did not improve from 0.96568
Epoch 18/1000
 - 46s - loss: 0.0574 - acc: 0.9786 - val_loss: 0.1148 - val_acc: 0.9662

Epoch 00018: val_acc improved from 0.96568 to 0.96620, saving model to unn_grid.h5
Epoch 19/1000
 - 46s - loss: 0.0503 - acc: 0.9808 - val_loss: 0.1065 - val_acc: 0.9654

Epoch 00019: val_acc did not improve from 0.96620
Epoch 20/1000
 - 46s - loss: 0.0451 - acc: 0.9828 - val_loss: 0.1451 - val_acc: 0.9642

Epoch 00020: val_acc did not improve from 0.96620
Epoch 21/1000
 - 46s - loss: 0.0435 - acc: 0.9833 - val_loss: 0.1260 - val_acc: 0.9649

Epoch 00021: val_acc did not improve from 0.96620

Epoch 00021: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 22/1000
 - 46s - loss: 0.0342 - acc: 0.9867 - val_loss: 0.1387 - val_acc: 0.9665

Epoch 00022: val_acc improved from 0.96620 to 0.96649, saving model to unn_grid.h5
Epoch 23/1000
 - 46s - loss: 0.0297 - acc: 0.9883 - val_loss: 0.1434 - val_acc: 0.9666

Epoch 00023: val_acc improved from 0.96649 to 0.96655, saving model to unn_grid.h5
Epoch 24/1000
 - 46s - loss: 0.0278 - acc: 0.9889 - val_loss: 0.1514 - val_acc: 0.9669

Epoch 00024: val_acc improved from 0.96655 to 0.96686, saving model to unn_grid.h5
Epoch 25/1000
 - 46s - loss: 0.0268 - acc: 0.9893 - val_loss: 0.1594 - val_acc: 0.9665

Epoch 00025: val_acc did not improve from 0.96686
Epoch 26/1000
 - 46s - loss: 0.0258 - acc: 0.9897 - val_loss: 0.1645 - val_acc: 0.9665

Epoch 00026: val_acc did not improve from 0.96686
Epoch 27/1000
 - 46s - loss: 0.0249 - acc: 0.9900 - val_loss: 0.1673 - val_acc: 0.9666

Epoch 00027: val_acc did not improve from 0.96686

Epoch 00027: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 28/1000
 - 46s - loss: 0.0235 - acc: 0.9905 - val_loss: 0.1738 - val_acc: 0.9665

Epoch 00028: val_acc did not improve from 0.96686
Epoch 29/1000
 - 46s - loss: 0.0234 - acc: 0.9905 - val_loss: 0.1754 - val_acc: 0.9665

Epoch 00029: val_acc did not improve from 0.96686
Epoch 00029: early stopping
Model: "model_54"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_54 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_1008 (Conv2D)            (None, 256, 256, 64) 640         input_54[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_1167 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1008[0][0]                
__________________________________________________________________________________________________
conv2d_1009 (Conv2D)            (None, 256, 256, 64) 36928       leaky_re_lu_1167[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1168 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1009[0][0]                
__________________________________________________________________________________________________
max_pooling2d_213 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_1168[0][0]           
__________________________________________________________________________________________________
dropout_478 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_213[0][0]          
__________________________________________________________________________________________________
conv2d_1010 (Conv2D)            (None, 128, 128, 128 73856       dropout_478[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1169 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1010[0][0]                
__________________________________________________________________________________________________
conv2d_1011 (Conv2D)            (None, 128, 128, 128 147584      leaky_re_lu_1169[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1170 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1011[0][0]                
__________________________________________________________________________________________________
max_pooling2d_214 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_1170[0][0]           
__________________________________________________________________________________________________
dropout_479 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_214[0][0]          
__________________________________________________________________________________________________
conv2d_1012 (Conv2D)            (None, 64, 64, 256)  295168      dropout_479[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1171 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1012[0][0]                
__________________________________________________________________________________________________
conv2d_1013 (Conv2D)            (None, 64, 64, 256)  590080      leaky_re_lu_1171[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1172 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1013[0][0]                
__________________________________________________________________________________________________
max_pooling2d_215 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_1172[0][0]           
__________________________________________________________________________________________________
dropout_480 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_215[0][0]          
__________________________________________________________________________________________________
conv2d_1014 (Conv2D)            (None, 32, 32, 512)  1180160     dropout_480[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1173 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1014[0][0]                
__________________________________________________________________________________________________
conv2d_1015 (Conv2D)            (None, 32, 32, 512)  2359808     leaky_re_lu_1173[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1174 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1015[0][0]                
__________________________________________________________________________________________________
max_pooling2d_216 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_1174[0][0]           
__________________________________________________________________________________________________
dropout_481 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_216[0][0]          
__________________________________________________________________________________________________
conv2d_1016 (Conv2D)            (None, 16, 16, 1024) 4719616     dropout_481[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1175 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_1016[0][0]                
__________________________________________________________________________________________________
conv2d_1017 (Conv2D)            (None, 16, 16, 1024) 9438208     leaky_re_lu_1175[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1176 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_1017[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_213 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_1176[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1177 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_transpose_213[0][0]       
__________________________________________________________________________________________________
concatenate_213 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_1177[0][0]           
                                                                 leaky_re_lu_1174[0][0]           
__________________________________________________________________________________________________
dropout_482 (Dropout)           (None, 32, 32, 1024) 0           concatenate_213[0][0]            
__________________________________________________________________________________________________
conv2d_1018 (Conv2D)            (None, 32, 32, 512)  4719104     dropout_482[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1178 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1018[0][0]                
__________________________________________________________________________________________________
conv2d_1019 (Conv2D)            (None, 32, 32, 512)  2359808     leaky_re_lu_1178[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1179 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1019[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_214 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_1179[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1180 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_transpose_214[0][0]       
__________________________________________________________________________________________________
concatenate_214 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_1180[0][0]           
                                                                 leaky_re_lu_1172[0][0]           
__________________________________________________________________________________________________
dropout_483 (Dropout)           (None, 64, 64, 512)  0           concatenate_214[0][0]            
__________________________________________________________________________________________________
conv2d_1020 (Conv2D)            (None, 64, 64, 256)  1179904     dropout_483[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1181 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1020[0][0]                
__________________________________________________________________________________________________
conv2d_1021 (Conv2D)            (None, 64, 64, 256)  590080      leaky_re_lu_1181[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1182 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1021[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_215 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_1182[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1183 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_transpose_215[0][0]       
__________________________________________________________________________________________________
concatenate_215 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_1183[0][0]           
                                                                 leaky_re_lu_1170[0][0]           
__________________________________________________________________________________________________
dropout_484 (Dropout)           (None, 128, 128, 256 0           concatenate_215[0][0]            
__________________________________________________________________________________________________
conv2d_1022 (Conv2D)            (None, 128, 128, 128 295040      dropout_484[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1184 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1022[0][0]                
__________________________________________________________________________________________________
conv2d_1023 (Conv2D)            (None, 128, 128, 128 147584      leaky_re_lu_1184[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1185 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1023[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_216 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_1185[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1186 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_transpose_216[0][0]       
__________________________________________________________________________________________________
concatenate_216 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_1186[0][0]           
                                                                 leaky_re_lu_1168[0][0]           
__________________________________________________________________________________________________
dropout_485 (Dropout)           (None, 256, 256, 128 0           concatenate_216[0][0]            
__________________________________________________________________________________________________
dropout_486 (Dropout)           (None, 256, 256, 128 0           dropout_485[0][0]                
__________________________________________________________________________________________________
conv2d_1024 (Conv2D)            (None, 256, 256, 64) 73792       dropout_486[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1187 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1024[0][0]                
__________________________________________________________________________________________________
conv2d_1025 (Conv2D)            (None, 256, 256, 64) 36928       leaky_re_lu_1187[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1188 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1025[0][0]                
__________________________________________________________________________________________________
conv2d_1026 (Conv2D)            (None, 256, 256, 3)  195         leaky_re_lu_1188[0][0]           
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 47s - loss: 0.4763 - acc: 0.9278 - val_loss: 0.1845 - val_acc: 0.9429

Epoch 00001: val_acc improved from -inf to 0.94294, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.1848 - acc: 0.9371 - val_loss: 0.1616 - val_acc: 0.9433

Epoch 00002: val_acc improved from 0.94294 to 0.94326, saving model to unn_grid.h5
Epoch 3/1000
 - 46s - loss: 0.1671 - acc: 0.9376 - val_loss: 0.1456 - val_acc: 0.9451

Epoch 00003: val_acc improved from 0.94326 to 0.94512, saving model to unn_grid.h5
Epoch 4/1000
 - 46s - loss: 0.1582 - acc: 0.9394 - val_loss: 0.1439 - val_acc: 0.9433

Epoch 00004: val_acc did not improve from 0.94512
Epoch 5/1000
 - 46s - loss: 0.1530 - acc: 0.9411 - val_loss: 0.1345 - val_acc: 0.9536

Epoch 00005: val_acc improved from 0.94512 to 0.95356, saving model to unn_grid.h5
Epoch 6/1000
 - 46s - loss: 0.1450 - acc: 0.9460 - val_loss: 0.1248 - val_acc: 0.9553

Epoch 00006: val_acc improved from 0.95356 to 0.95526, saving model to unn_grid.h5
Epoch 7/1000
 - 46s - loss: 0.1316 - acc: 0.9504 - val_loss: 0.1195 - val_acc: 0.9573

Epoch 00007: val_acc improved from 0.95526 to 0.95729, saving model to unn_grid.h5
Epoch 8/1000
 - 46s - loss: 0.1198 - acc: 0.9568 - val_loss: 0.1353 - val_acc: 0.9494

Epoch 00008: val_acc did not improve from 0.95729
Epoch 9/1000
 - 46s - loss: 0.1073 - acc: 0.9608 - val_loss: 0.1262 - val_acc: 0.9541

Epoch 00009: val_acc did not improve from 0.95729
Epoch 10/1000
 - 46s - loss: 0.0970 - acc: 0.9647 - val_loss: 0.1179 - val_acc: 0.9598

Epoch 00010: val_acc improved from 0.95729 to 0.95978, saving model to unn_grid.h5
Epoch 11/1000
 - 46s - loss: 0.0907 - acc: 0.9669 - val_loss: 0.1075 - val_acc: 0.9596

Epoch 00011: val_acc did not improve from 0.95978
Epoch 12/1000
 - 46s - loss: 0.0851 - acc: 0.9689 - val_loss: 0.1031 - val_acc: 0.9649

Epoch 00012: val_acc improved from 0.95978 to 0.96490, saving model to unn_grid.h5
Epoch 13/1000
 - 46s - loss: 0.0779 - acc: 0.9713 - val_loss: 0.0974 - val_acc: 0.9658

Epoch 00013: val_acc improved from 0.96490 to 0.96581, saving model to unn_grid.h5
Epoch 14/1000
 - 46s - loss: 0.0788 - acc: 0.9713 - val_loss: 0.1005 - val_acc: 0.9651

Epoch 00014: val_acc did not improve from 0.96581
Epoch 15/1000
 - 46s - loss: 0.0702 - acc: 0.9739 - val_loss: 0.1185 - val_acc: 0.9626

Epoch 00015: val_acc did not improve from 0.96581
Epoch 16/1000
 - 46s - loss: 0.0671 - acc: 0.9747 - val_loss: 0.1016 - val_acc: 0.9660

Epoch 00016: val_acc improved from 0.96581 to 0.96596, saving model to unn_grid.h5
Epoch 17/1000
 - 46s - loss: 0.0623 - acc: 0.9768 - val_loss: 0.0955 - val_acc: 0.9667

Epoch 00017: val_acc improved from 0.96596 to 0.96673, saving model to unn_grid.h5
Epoch 18/1000
 - 46s - loss: 0.0596 - acc: 0.9777 - val_loss: 0.1019 - val_acc: 0.9662

Epoch 00018: val_acc did not improve from 0.96673
Epoch 19/1000
 - 46s - loss: 0.0542 - acc: 0.9793 - val_loss: 0.1126 - val_acc: 0.9622

Epoch 00019: val_acc did not improve from 0.96673
Epoch 20/1000
 - 46s - loss: 0.0515 - acc: 0.9807 - val_loss: 0.1136 - val_acc: 0.9653

Epoch 00020: val_acc did not improve from 0.96673

Epoch 00020: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 21/1000
 - 46s - loss: 0.0390 - acc: 0.9848 - val_loss: 0.1240 - val_acc: 0.9671

Epoch 00021: val_acc improved from 0.96673 to 0.96712, saving model to unn_grid.h5
Epoch 22/1000
 - 46s - loss: 0.0355 - acc: 0.9861 - val_loss: 0.1188 - val_acc: 0.9683

Epoch 00022: val_acc improved from 0.96712 to 0.96830, saving model to unn_grid.h5
Epoch 23/1000
 - 46s - loss: 0.0336 - acc: 0.9868 - val_loss: 0.1224 - val_acc: 0.9682

Epoch 00023: val_acc did not improve from 0.96830
Epoch 24/1000
 - 46s - loss: 0.0321 - acc: 0.9873 - val_loss: 0.1265 - val_acc: 0.9680

Epoch 00024: val_acc did not improve from 0.96830
Epoch 25/1000
 - 46s - loss: 0.0309 - acc: 0.9878 - val_loss: 0.1287 - val_acc: 0.9679

Epoch 00025: val_acc did not improve from 0.96830

Epoch 00025: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 26/1000
 - 46s - loss: 0.0290 - acc: 0.9885 - val_loss: 0.1324 - val_acc: 0.9681

Epoch 00026: val_acc did not improve from 0.96830
Epoch 27/1000
 - 46s - loss: 0.0288 - acc: 0.9886 - val_loss: 0.1325 - val_acc: 0.9681

Epoch 00027: val_acc did not improve from 0.96830
Epoch 00027: early stopping
Model: "model_55"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_55 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_1027 (Conv2D)            (None, 256, 256, 64) 640         input_55[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_1189 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1027[0][0]                
__________________________________________________________________________________________________
conv2d_1028 (Conv2D)            (None, 256, 256, 64) 36928       leaky_re_lu_1189[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1190 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1028[0][0]                
__________________________________________________________________________________________________
max_pooling2d_217 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_1190[0][0]           
__________________________________________________________________________________________________
dropout_487 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_217[0][0]          
__________________________________________________________________________________________________
conv2d_1029 (Conv2D)            (None, 128, 128, 128 73856       dropout_487[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1191 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1029[0][0]                
__________________________________________________________________________________________________
conv2d_1030 (Conv2D)            (None, 128, 128, 128 147584      leaky_re_lu_1191[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1192 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1030[0][0]                
__________________________________________________________________________________________________
max_pooling2d_218 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_1192[0][0]           
__________________________________________________________________________________________________
dropout_488 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_218[0][0]          
__________________________________________________________________________________________________
conv2d_1031 (Conv2D)            (None, 64, 64, 256)  295168      dropout_488[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1193 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1031[0][0]                
__________________________________________________________________________________________________
conv2d_1032 (Conv2D)            (None, 64, 64, 256)  590080      leaky_re_lu_1193[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1194 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1032[0][0]                
__________________________________________________________________________________________________
max_pooling2d_219 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_1194[0][0]           
__________________________________________________________________________________________________
dropout_489 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_219[0][0]          
__________________________________________________________________________________________________
conv2d_1033 (Conv2D)            (None, 32, 32, 512)  1180160     dropout_489[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1195 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1033[0][0]                
__________________________________________________________________________________________________
conv2d_1034 (Conv2D)            (None, 32, 32, 512)  2359808     leaky_re_lu_1195[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1196 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1034[0][0]                
__________________________________________________________________________________________________
max_pooling2d_220 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_1196[0][0]           
__________________________________________________________________________________________________
dropout_490 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_220[0][0]          
__________________________________________________________________________________________________
conv2d_1035 (Conv2D)            (None, 16, 16, 1024) 4719616     dropout_490[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1197 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_1035[0][0]                
__________________________________________________________________________________________________
conv2d_1036 (Conv2D)            (None, 16, 16, 1024) 9438208     leaky_re_lu_1197[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1198 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_1036[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_217 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_1198[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1199 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_transpose_217[0][0]       
__________________________________________________________________________________________________
concatenate_217 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_1199[0][0]           
                                                                 leaky_re_lu_1196[0][0]           
__________________________________________________________________________________________________
dropout_491 (Dropout)           (None, 32, 32, 1024) 0           concatenate_217[0][0]            
__________________________________________________________________________________________________
conv2d_1037 (Conv2D)            (None, 32, 32, 512)  4719104     dropout_491[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1200 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1037[0][0]                
__________________________________________________________________________________________________
conv2d_1038 (Conv2D)            (None, 32, 32, 512)  2359808     leaky_re_lu_1200[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1201 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1038[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_218 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_1201[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1202 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_transpose_218[0][0]       
__________________________________________________________________________________________________
concatenate_218 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_1202[0][0]           
                                                                 leaky_re_lu_1194[0][0]           
__________________________________________________________________________________________________
dropout_492 (Dropout)           (None, 64, 64, 512)  0           concatenate_218[0][0]            
__________________________________________________________________________________________________
conv2d_1039 (Conv2D)            (None, 64, 64, 256)  1179904     dropout_492[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1203 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1039[0][0]                
__________________________________________________________________________________________________
conv2d_1040 (Conv2D)            (None, 64, 64, 256)  590080      leaky_re_lu_1203[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1204 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1040[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_219 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_1204[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1205 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_transpose_219[0][0]       
__________________________________________________________________________________________________
concatenate_219 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_1205[0][0]           
                                                                 leaky_re_lu_1192[0][0]           
__________________________________________________________________________________________________
dropout_493 (Dropout)           (None, 128, 128, 256 0           concatenate_219[0][0]            
__________________________________________________________________________________________________
conv2d_1041 (Conv2D)            (None, 128, 128, 128 295040      dropout_493[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1206 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1041[0][0]                
__________________________________________________________________________________________________
conv2d_1042 (Conv2D)            (None, 128, 128, 128 147584      leaky_re_lu_1206[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1207 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1042[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_220 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_1207[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1208 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_transpose_220[0][0]       
__________________________________________________________________________________________________
concatenate_220 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_1208[0][0]           
                                                                 leaky_re_lu_1190[0][0]           
__________________________________________________________________________________________________
dropout_494 (Dropout)           (None, 256, 256, 128 0           concatenate_220[0][0]            
__________________________________________________________________________________________________
dropout_495 (Dropout)           (None, 256, 256, 128 0           dropout_494[0][0]                
__________________________________________________________________________________________________
conv2d_1043 (Conv2D)            (None, 256, 256, 64) 73792       dropout_495[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1209 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1043[0][0]                
__________________________________________________________________________________________________
conv2d_1044 (Conv2D)            (None, 256, 256, 64) 36928       leaky_re_lu_1209[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1210 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1044[0][0]                
__________________________________________________________________________________________________
conv2d_1045 (Conv2D)            (None, 256, 256, 3)  195         leaky_re_lu_1210[0][0]           
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1213 samples, validate on 135 samples
Epoch 1/1000
 - 47s - loss: 0.3994 - acc: 0.9348 - val_loss: 0.2772 - val_acc: 0.9135

Epoch 00001: val_acc improved from -inf to 0.91348, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.2042 - acc: 0.9403 - val_loss: 0.2264 - val_acc: 0.9135

Epoch 00002: val_acc improved from 0.91348 to 0.91348, saving model to unn_grid.h5
Epoch 3/1000
 - 46s - loss: 0.1867 - acc: 0.9405 - val_loss: 0.2194 - val_acc: 0.9135

Epoch 00003: val_acc did not improve from 0.91348
Epoch 4/1000
 - 46s - loss: 0.1713 - acc: 0.9405 - val_loss: 0.2246 - val_acc: 0.9135

Epoch 00004: val_acc did not improve from 0.91348

Epoch 00004: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 5/1000
 - 46s - loss: 0.1579 - acc: 0.9405 - val_loss: 0.2041 - val_acc: 0.9135

Epoch 00005: val_acc did not improve from 0.91348
Epoch 6/1000
 - 46s - loss: 0.1536 - acc: 0.9405 - val_loss: 0.2030 - val_acc: 0.9135

Epoch 00006: val_acc did not improve from 0.91348
Epoch 7/1000
 - 46s - loss: 0.1509 - acc: 0.9405 - val_loss: 0.2008 - val_acc: 0.9135

Epoch 00007: val_acc did not improve from 0.91348

Epoch 00007: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 00007: early stopping
scores= [[0.94593302 0.45337382 0.40869075]
 [0.93582602 0.33330832 0.3119443 ]
 [0.95986734 0.64962314 0.57892187]
 [0.93558513 0.33322472 0.31186717]
 [0.95149693 0.52931513 0.48150358]
 [0.93571018 0.33331998 0.31195914]
 [0.95960049 0.62126837 0.55187472]
 [0.93582604 0.33330626 0.31194201]
 [0.96562115 0.72077765 0.63546703]
 [0.93588448 0.3333275  0.3119623 ]
 [0.94705553 0.49200807 0.44335227]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]] parameters= (64, 'Adam', 0.2, 'glorot_uniform', 0.0001)
Model: "model_56"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_56 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_1046 (Conv2D)            (None, 256, 256, 64) 640         input_56[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_1211 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1046[0][0]                
__________________________________________________________________________________________________
conv2d_1047 (Conv2D)            (None, 256, 256, 64) 36928       leaky_re_lu_1211[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1212 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1047[0][0]                
__________________________________________________________________________________________________
max_pooling2d_221 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_1212[0][0]           
__________________________________________________________________________________________________
dropout_496 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_221[0][0]          
__________________________________________________________________________________________________
conv2d_1048 (Conv2D)            (None, 128, 128, 128 73856       dropout_496[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1213 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1048[0][0]                
__________________________________________________________________________________________________
conv2d_1049 (Conv2D)            (None, 128, 128, 128 147584      leaky_re_lu_1213[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1214 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1049[0][0]                
__________________________________________________________________________________________________
max_pooling2d_222 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_1214[0][0]           
__________________________________________________________________________________________________
dropout_497 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_222[0][0]          
__________________________________________________________________________________________________
conv2d_1050 (Conv2D)            (None, 64, 64, 256)  295168      dropout_497[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1215 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1050[0][0]                
__________________________________________________________________________________________________
conv2d_1051 (Conv2D)            (None, 64, 64, 256)  590080      leaky_re_lu_1215[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1216 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1051[0][0]                
__________________________________________________________________________________________________
max_pooling2d_223 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_1216[0][0]           
__________________________________________________________________________________________________
dropout_498 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_223[0][0]          
__________________________________________________________________________________________________
conv2d_1052 (Conv2D)            (None, 32, 32, 512)  1180160     dropout_498[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1217 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1052[0][0]                
__________________________________________________________________________________________________
conv2d_1053 (Conv2D)            (None, 32, 32, 512)  2359808     leaky_re_lu_1217[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1218 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1053[0][0]                
__________________________________________________________________________________________________
max_pooling2d_224 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_1218[0][0]           
__________________________________________________________________________________________________
dropout_499 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_224[0][0]          
__________________________________________________________________________________________________
conv2d_1054 (Conv2D)            (None, 16, 16, 1024) 4719616     dropout_499[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1219 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_1054[0][0]                
__________________________________________________________________________________________________
conv2d_1055 (Conv2D)            (None, 16, 16, 1024) 9438208     leaky_re_lu_1219[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1220 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_1055[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_221 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_1220[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1221 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_transpose_221[0][0]       
__________________________________________________________________________________________________
concatenate_221 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_1221[0][0]           
                                                                 leaky_re_lu_1218[0][0]           
__________________________________________________________________________________________________
dropout_500 (Dropout)           (None, 32, 32, 1024) 0           concatenate_221[0][0]            
__________________________________________________________________________________________________
conv2d_1056 (Conv2D)            (None, 32, 32, 512)  4719104     dropout_500[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1222 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1056[0][0]                
__________________________________________________________________________________________________
conv2d_1057 (Conv2D)            (None, 32, 32, 512)  2359808     leaky_re_lu_1222[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1223 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1057[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_222 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_1223[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1224 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_transpose_222[0][0]       
__________________________________________________________________________________________________
concatenate_222 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_1224[0][0]           
                                                                 leaky_re_lu_1216[0][0]           
__________________________________________________________________________________________________
dropout_501 (Dropout)           (None, 64, 64, 512)  0           concatenate_222[0][0]            
__________________________________________________________________________________________________
conv2d_1058 (Conv2D)            (None, 64, 64, 256)  1179904     dropout_501[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1225 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1058[0][0]                
__________________________________________________________________________________________________
conv2d_1059 (Conv2D)            (None, 64, 64, 256)  590080      leaky_re_lu_1225[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1226 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1059[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_223 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_1226[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1227 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_transpose_223[0][0]       
__________________________________________________________________________________________________
concatenate_223 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_1227[0][0]           
                                                                 leaky_re_lu_1214[0][0]           
__________________________________________________________________________________________________
dropout_502 (Dropout)           (None, 128, 128, 256 0           concatenate_223[0][0]            
__________________________________________________________________________________________________
conv2d_1060 (Conv2D)            (None, 128, 128, 128 295040      dropout_502[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1228 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1060[0][0]                
__________________________________________________________________________________________________
conv2d_1061 (Conv2D)            (None, 128, 128, 128 147584      leaky_re_lu_1228[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1229 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1061[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_224 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_1229[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1230 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_transpose_224[0][0]       
__________________________________________________________________________________________________
concatenate_224 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_1230[0][0]           
                                                                 leaky_re_lu_1212[0][0]           
__________________________________________________________________________________________________
dropout_503 (Dropout)           (None, 256, 256, 128 0           concatenate_224[0][0]            
__________________________________________________________________________________________________
dropout_504 (Dropout)           (None, 256, 256, 128 0           dropout_503[0][0]                
__________________________________________________________________________________________________
conv2d_1062 (Conv2D)            (None, 256, 256, 64) 73792       dropout_504[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1231 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1062[0][0]                
__________________________________________________________________________________________________
conv2d_1063 (Conv2D)            (None, 256, 256, 64) 36928       leaky_re_lu_1231[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1232 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1063[0][0]                
__________________________________________________________________________________________________
conv2d_1064 (Conv2D)            (None, 256, 256, 3)  195         leaky_re_lu_1232[0][0]           
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 47s - loss: 0.5301 - acc: 0.9250 - val_loss: 0.3568 - val_acc: 0.9398

Epoch 00001: val_acc improved from -inf to 0.93981, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.2664 - acc: 0.9248 - val_loss: 0.2302 - val_acc: 0.9403

Epoch 00002: val_acc improved from 0.93981 to 0.94030, saving model to unn_grid.h5
Epoch 3/1000
 - 46s - loss: 0.2137 - acc: 0.9295 - val_loss: 0.2507 - val_acc: 0.9383

Epoch 00003: val_acc did not improve from 0.94030
Epoch 4/1000
 - 46s - loss: 0.1930 - acc: 0.9311 - val_loss: 0.1970 - val_acc: 0.9387

Epoch 00004: val_acc did not improve from 0.94030
Epoch 5/1000
 - 46s - loss: 0.1809 - acc: 0.9316 - val_loss: 0.1754 - val_acc: 0.9387

Epoch 00005: val_acc did not improve from 0.94030

Epoch 00005: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 6/1000
 - 46s - loss: 0.1728 - acc: 0.9320 - val_loss: 0.1873 - val_acc: 0.9389

Epoch 00006: val_acc did not improve from 0.94030
Epoch 7/1000
 - 46s - loss: 0.1712 - acc: 0.9322 - val_loss: 0.1853 - val_acc: 0.9385

Epoch 00007: val_acc did not improve from 0.94030
Epoch 00007: early stopping
Model: "model_57"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_57 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_1065 (Conv2D)            (None, 256, 256, 64) 640         input_57[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_1233 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1065[0][0]                
__________________________________________________________________________________________________
conv2d_1066 (Conv2D)            (None, 256, 256, 64) 36928       leaky_re_lu_1233[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1234 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1066[0][0]                
__________________________________________________________________________________________________
max_pooling2d_225 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_1234[0][0]           
__________________________________________________________________________________________________
dropout_505 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_225[0][0]          
__________________________________________________________________________________________________
conv2d_1067 (Conv2D)            (None, 128, 128, 128 73856       dropout_505[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1235 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1067[0][0]                
__________________________________________________________________________________________________
conv2d_1068 (Conv2D)            (None, 128, 128, 128 147584      leaky_re_lu_1235[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1236 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1068[0][0]                
__________________________________________________________________________________________________
max_pooling2d_226 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_1236[0][0]           
__________________________________________________________________________________________________
dropout_506 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_226[0][0]          
__________________________________________________________________________________________________
conv2d_1069 (Conv2D)            (None, 64, 64, 256)  295168      dropout_506[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1237 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1069[0][0]                
__________________________________________________________________________________________________
conv2d_1070 (Conv2D)            (None, 64, 64, 256)  590080      leaky_re_lu_1237[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1238 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1070[0][0]                
__________________________________________________________________________________________________
max_pooling2d_227 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_1238[0][0]           
__________________________________________________________________________________________________
dropout_507 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_227[0][0]          
__________________________________________________________________________________________________
conv2d_1071 (Conv2D)            (None, 32, 32, 512)  1180160     dropout_507[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1239 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1071[0][0]                
__________________________________________________________________________________________________
conv2d_1072 (Conv2D)            (None, 32, 32, 512)  2359808     leaky_re_lu_1239[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1240 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1072[0][0]                
__________________________________________________________________________________________________
max_pooling2d_228 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_1240[0][0]           
__________________________________________________________________________________________________
dropout_508 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_228[0][0]          
__________________________________________________________________________________________________
conv2d_1073 (Conv2D)            (None, 16, 16, 1024) 4719616     dropout_508[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1241 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_1073[0][0]                
__________________________________________________________________________________________________
conv2d_1074 (Conv2D)            (None, 16, 16, 1024) 9438208     leaky_re_lu_1241[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1242 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_1074[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_225 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_1242[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1243 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_transpose_225[0][0]       
__________________________________________________________________________________________________
concatenate_225 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_1243[0][0]           
                                                                 leaky_re_lu_1240[0][0]           
__________________________________________________________________________________________________
dropout_509 (Dropout)           (None, 32, 32, 1024) 0           concatenate_225[0][0]            
__________________________________________________________________________________________________
conv2d_1075 (Conv2D)            (None, 32, 32, 512)  4719104     dropout_509[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1244 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1075[0][0]                
__________________________________________________________________________________________________
conv2d_1076 (Conv2D)            (None, 32, 32, 512)  2359808     leaky_re_lu_1244[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1245 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1076[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_226 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_1245[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1246 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_transpose_226[0][0]       
__________________________________________________________________________________________________
concatenate_226 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_1246[0][0]           
                                                                 leaky_re_lu_1238[0][0]           
__________________________________________________________________________________________________
dropout_510 (Dropout)           (None, 64, 64, 512)  0           concatenate_226[0][0]            
__________________________________________________________________________________________________
conv2d_1077 (Conv2D)            (None, 64, 64, 256)  1179904     dropout_510[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1247 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1077[0][0]                
__________________________________________________________________________________________________
conv2d_1078 (Conv2D)            (None, 64, 64, 256)  590080      leaky_re_lu_1247[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1248 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1078[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_227 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_1248[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1249 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_transpose_227[0][0]       
__________________________________________________________________________________________________
concatenate_227 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_1249[0][0]           
                                                                 leaky_re_lu_1236[0][0]           
__________________________________________________________________________________________________
dropout_511 (Dropout)           (None, 128, 128, 256 0           concatenate_227[0][0]            
__________________________________________________________________________________________________
conv2d_1079 (Conv2D)            (None, 128, 128, 128 295040      dropout_511[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1250 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1079[0][0]                
__________________________________________________________________________________________________
conv2d_1080 (Conv2D)            (None, 128, 128, 128 147584      leaky_re_lu_1250[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1251 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1080[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_228 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_1251[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1252 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_transpose_228[0][0]       
__________________________________________________________________________________________________
concatenate_228 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_1252[0][0]           
                                                                 leaky_re_lu_1234[0][0]           
__________________________________________________________________________________________________
dropout_512 (Dropout)           (None, 256, 256, 128 0           concatenate_228[0][0]            
__________________________________________________________________________________________________
dropout_513 (Dropout)           (None, 256, 256, 128 0           dropout_512[0][0]                
__________________________________________________________________________________________________
conv2d_1081 (Conv2D)            (None, 256, 256, 64) 73792       dropout_513[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1253 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1081[0][0]                
__________________________________________________________________________________________________
conv2d_1082 (Conv2D)            (None, 256, 256, 64) 36928       leaky_re_lu_1253[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1254 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1082[0][0]                
__________________________________________________________________________________________________
conv2d_1083 (Conv2D)            (None, 256, 256, 3)  195         leaky_re_lu_1254[0][0]           
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 47s - loss: 0.7973 - acc: 0.8942 - val_loss: 0.6153 - val_acc: 0.9433

Epoch 00001: val_acc improved from -inf to 0.94327, saving model to unn_grid.h5
Epoch 2/1000
 - 45s - loss: 0.4801 - acc: 0.9318 - val_loss: 0.5501 - val_acc: 0.9432

Epoch 00002: val_acc did not improve from 0.94327
Epoch 3/1000
 - 45s - loss: 0.3814 - acc: 0.9294 - val_loss: 0.3096 - val_acc: 0.9428

Epoch 00003: val_acc did not improve from 0.94327
Epoch 4/1000
 - 46s - loss: 0.2514 - acc: 0.9315 - val_loss: 0.2280 - val_acc: 0.9255

Epoch 00004: val_acc did not improve from 0.94327

Epoch 00004: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 5/1000
 - 46s - loss: 0.2037 - acc: 0.9345 - val_loss: 0.1963 - val_acc: 0.9359

Epoch 00005: val_acc did not improve from 0.94327
Epoch 6/1000
 - 45s - loss: 0.1986 - acc: 0.9350 - val_loss: 0.1975 - val_acc: 0.9356

Epoch 00006: val_acc did not improve from 0.94327
Epoch 00006: early stopping
Model: "model_58"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_58 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_1084 (Conv2D)            (None, 256, 256, 64) 640         input_58[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_1255 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1084[0][0]                
__________________________________________________________________________________________________
conv2d_1085 (Conv2D)            (None, 256, 256, 64) 36928       leaky_re_lu_1255[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1256 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1085[0][0]                
__________________________________________________________________________________________________
max_pooling2d_229 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_1256[0][0]           
__________________________________________________________________________________________________
dropout_514 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_229[0][0]          
__________________________________________________________________________________________________
conv2d_1086 (Conv2D)            (None, 128, 128, 128 73856       dropout_514[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1257 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1086[0][0]                
__________________________________________________________________________________________________
conv2d_1087 (Conv2D)            (None, 128, 128, 128 147584      leaky_re_lu_1257[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1258 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1087[0][0]                
__________________________________________________________________________________________________
max_pooling2d_230 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_1258[0][0]           
__________________________________________________________________________________________________
dropout_515 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_230[0][0]          
__________________________________________________________________________________________________
conv2d_1088 (Conv2D)            (None, 64, 64, 256)  295168      dropout_515[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1259 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1088[0][0]                
__________________________________________________________________________________________________
conv2d_1089 (Conv2D)            (None, 64, 64, 256)  590080      leaky_re_lu_1259[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1260 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1089[0][0]                
__________________________________________________________________________________________________
max_pooling2d_231 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_1260[0][0]           
__________________________________________________________________________________________________
dropout_516 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_231[0][0]          
__________________________________________________________________________________________________
conv2d_1090 (Conv2D)            (None, 32, 32, 512)  1180160     dropout_516[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1261 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1090[0][0]                
__________________________________________________________________________________________________
conv2d_1091 (Conv2D)            (None, 32, 32, 512)  2359808     leaky_re_lu_1261[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1262 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1091[0][0]                
__________________________________________________________________________________________________
max_pooling2d_232 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_1262[0][0]           
__________________________________________________________________________________________________
dropout_517 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_232[0][0]          
__________________________________________________________________________________________________
conv2d_1092 (Conv2D)            (None, 16, 16, 1024) 4719616     dropout_517[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1263 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_1092[0][0]                
__________________________________________________________________________________________________
conv2d_1093 (Conv2D)            (None, 16, 16, 1024) 9438208     leaky_re_lu_1263[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1264 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_1093[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_229 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_1264[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1265 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_transpose_229[0][0]       
__________________________________________________________________________________________________
concatenate_229 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_1265[0][0]           
                                                                 leaky_re_lu_1262[0][0]           
__________________________________________________________________________________________________
dropout_518 (Dropout)           (None, 32, 32, 1024) 0           concatenate_229[0][0]            
__________________________________________________________________________________________________
conv2d_1094 (Conv2D)            (None, 32, 32, 512)  4719104     dropout_518[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1266 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1094[0][0]                
__________________________________________________________________________________________________
conv2d_1095 (Conv2D)            (None, 32, 32, 512)  2359808     leaky_re_lu_1266[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1267 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1095[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_230 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_1267[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1268 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_transpose_230[0][0]       
__________________________________________________________________________________________________
concatenate_230 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_1268[0][0]           
                                                                 leaky_re_lu_1260[0][0]           
__________________________________________________________________________________________________
dropout_519 (Dropout)           (None, 64, 64, 512)  0           concatenate_230[0][0]            
__________________________________________________________________________________________________
conv2d_1096 (Conv2D)            (None, 64, 64, 256)  1179904     dropout_519[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1269 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1096[0][0]                
__________________________________________________________________________________________________
conv2d_1097 (Conv2D)            (None, 64, 64, 256)  590080      leaky_re_lu_1269[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1270 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1097[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_231 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_1270[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1271 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_transpose_231[0][0]       
__________________________________________________________________________________________________
concatenate_231 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_1271[0][0]           
                                                                 leaky_re_lu_1258[0][0]           
__________________________________________________________________________________________________
dropout_520 (Dropout)           (None, 128, 128, 256 0           concatenate_231[0][0]            
__________________________________________________________________________________________________
conv2d_1098 (Conv2D)            (None, 128, 128, 128 295040      dropout_520[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1272 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1098[0][0]                
__________________________________________________________________________________________________
conv2d_1099 (Conv2D)            (None, 128, 128, 128 147584      leaky_re_lu_1272[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1273 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1099[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_232 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_1273[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1274 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_transpose_232[0][0]       
__________________________________________________________________________________________________
concatenate_232 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_1274[0][0]           
                                                                 leaky_re_lu_1256[0][0]           
__________________________________________________________________________________________________
dropout_521 (Dropout)           (None, 256, 256, 128 0           concatenate_232[0][0]            
__________________________________________________________________________________________________
dropout_522 (Dropout)           (None, 256, 256, 128 0           dropout_521[0][0]                
__________________________________________________________________________________________________
conv2d_1100 (Conv2D)            (None, 256, 256, 64) 73792       dropout_522[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1275 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1100[0][0]                
__________________________________________________________________________________________________
conv2d_1101 (Conv2D)            (None, 256, 256, 64) 36928       leaky_re_lu_1275[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1276 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1101[0][0]                
__________________________________________________________________________________________________
conv2d_1102 (Conv2D)            (None, 256, 256, 3)  195         leaky_re_lu_1276[0][0]           
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 47s - loss: 0.6753 - acc: 0.9173 - val_loss: 0.6070 - val_acc: 0.9432

Epoch 00001: val_acc improved from -inf to 0.94318, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.4450 - acc: 0.9206 - val_loss: 0.3526 - val_acc: 0.9387

Epoch 00002: val_acc did not improve from 0.94318
Epoch 3/1000
 - 46s - loss: 0.2919 - acc: 0.9229 - val_loss: 0.2669 - val_acc: 0.9374

Epoch 00003: val_acc did not improve from 0.94318
Epoch 4/1000
 - 46s - loss: 0.2217 - acc: 0.9267 - val_loss: 0.2209 - val_acc: 0.9390

Epoch 00004: val_acc did not improve from 0.94318

Epoch 00004: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 5/1000
 - 45s - loss: 0.1986 - acc: 0.9287 - val_loss: 0.2198 - val_acc: 0.9379

Epoch 00005: val_acc did not improve from 0.94318
Epoch 6/1000
 - 45s - loss: 0.1961 - acc: 0.9294 - val_loss: 0.2075 - val_acc: 0.9396

Epoch 00006: val_acc did not improve from 0.94318
Epoch 00006: early stopping
Model: "model_59"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_59 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_1103 (Conv2D)            (None, 256, 256, 64) 640         input_59[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_1277 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1103[0][0]                
__________________________________________________________________________________________________
conv2d_1104 (Conv2D)            (None, 256, 256, 64) 36928       leaky_re_lu_1277[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1278 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1104[0][0]                
__________________________________________________________________________________________________
max_pooling2d_233 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_1278[0][0]           
__________________________________________________________________________________________________
dropout_523 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_233[0][0]          
__________________________________________________________________________________________________
conv2d_1105 (Conv2D)            (None, 128, 128, 128 73856       dropout_523[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1279 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1105[0][0]                
__________________________________________________________________________________________________
conv2d_1106 (Conv2D)            (None, 128, 128, 128 147584      leaky_re_lu_1279[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1280 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1106[0][0]                
__________________________________________________________________________________________________
max_pooling2d_234 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_1280[0][0]           
__________________________________________________________________________________________________
dropout_524 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_234[0][0]          
__________________________________________________________________________________________________
conv2d_1107 (Conv2D)            (None, 64, 64, 256)  295168      dropout_524[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1281 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1107[0][0]                
__________________________________________________________________________________________________
conv2d_1108 (Conv2D)            (None, 64, 64, 256)  590080      leaky_re_lu_1281[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1282 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1108[0][0]                
__________________________________________________________________________________________________
max_pooling2d_235 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_1282[0][0]           
__________________________________________________________________________________________________
dropout_525 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_235[0][0]          
__________________________________________________________________________________________________
conv2d_1109 (Conv2D)            (None, 32, 32, 512)  1180160     dropout_525[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1283 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1109[0][0]                
__________________________________________________________________________________________________
conv2d_1110 (Conv2D)            (None, 32, 32, 512)  2359808     leaky_re_lu_1283[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1284 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1110[0][0]                
__________________________________________________________________________________________________
max_pooling2d_236 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_1284[0][0]           
__________________________________________________________________________________________________
dropout_526 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_236[0][0]          
__________________________________________________________________________________________________
conv2d_1111 (Conv2D)            (None, 16, 16, 1024) 4719616     dropout_526[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1285 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_1111[0][0]                
__________________________________________________________________________________________________
conv2d_1112 (Conv2D)            (None, 16, 16, 1024) 9438208     leaky_re_lu_1285[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1286 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_1112[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_233 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_1286[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1287 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_transpose_233[0][0]       
__________________________________________________________________________________________________
concatenate_233 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_1287[0][0]           
                                                                 leaky_re_lu_1284[0][0]           
__________________________________________________________________________________________________
dropout_527 (Dropout)           (None, 32, 32, 1024) 0           concatenate_233[0][0]            
__________________________________________________________________________________________________
conv2d_1113 (Conv2D)            (None, 32, 32, 512)  4719104     dropout_527[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1288 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1113[0][0]                
__________________________________________________________________________________________________
conv2d_1114 (Conv2D)            (None, 32, 32, 512)  2359808     leaky_re_lu_1288[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1289 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1114[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_234 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_1289[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1290 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_transpose_234[0][0]       
__________________________________________________________________________________________________
concatenate_234 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_1290[0][0]           
                                                                 leaky_re_lu_1282[0][0]           
__________________________________________________________________________________________________
dropout_528 (Dropout)           (None, 64, 64, 512)  0           concatenate_234[0][0]            
__________________________________________________________________________________________________
conv2d_1115 (Conv2D)            (None, 64, 64, 256)  1179904     dropout_528[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1291 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1115[0][0]                
__________________________________________________________________________________________________
conv2d_1116 (Conv2D)            (None, 64, 64, 256)  590080      leaky_re_lu_1291[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1292 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1116[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_235 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_1292[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1293 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_transpose_235[0][0]       
__________________________________________________________________________________________________
concatenate_235 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_1293[0][0]           
                                                                 leaky_re_lu_1280[0][0]           
__________________________________________________________________________________________________
dropout_529 (Dropout)           (None, 128, 128, 256 0           concatenate_235[0][0]            
__________________________________________________________________________________________________
conv2d_1117 (Conv2D)            (None, 128, 128, 128 295040      dropout_529[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1294 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1117[0][0]                
__________________________________________________________________________________________________
conv2d_1118 (Conv2D)            (None, 128, 128, 128 147584      leaky_re_lu_1294[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1295 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1118[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_236 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_1295[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1296 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_transpose_236[0][0]       
__________________________________________________________________________________________________
concatenate_236 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_1296[0][0]           
                                                                 leaky_re_lu_1278[0][0]           
__________________________________________________________________________________________________
dropout_530 (Dropout)           (None, 256, 256, 128 0           concatenate_236[0][0]            
__________________________________________________________________________________________________
dropout_531 (Dropout)           (None, 256, 256, 128 0           dropout_530[0][0]                
__________________________________________________________________________________________________
conv2d_1119 (Conv2D)            (None, 256, 256, 64) 73792       dropout_531[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1297 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1119[0][0]                
__________________________________________________________________________________________________
conv2d_1120 (Conv2D)            (None, 256, 256, 64) 36928       leaky_re_lu_1297[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1298 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1120[0][0]                
__________________________________________________________________________________________________
conv2d_1121 (Conv2D)            (None, 256, 256, 3)  195         leaky_re_lu_1298[0][0]           
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1212 samples, validate on 135 samples
Epoch 1/1000
 - 47s - loss: 0.6398 - acc: 0.9230 - val_loss: 0.4030 - val_acc: 0.9422

Epoch 00001: val_acc improved from -inf to 0.94218, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.3395 - acc: 0.9259 - val_loss: 0.2546 - val_acc: 0.9329

Epoch 00002: val_acc did not improve from 0.94218
Epoch 3/1000
 - 46s - loss: 0.2322 - acc: 0.9301 - val_loss: 0.2413 - val_acc: 0.9342

Epoch 00003: val_acc did not improve from 0.94218
Epoch 4/1000
 - 46s - loss: 0.2021 - acc: 0.9339 - val_loss: 0.2076 - val_acc: 0.9404

Epoch 00004: val_acc did not improve from 0.94218

Epoch 00004: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 5/1000
 - 46s - loss: 0.1826 - acc: 0.9358 - val_loss: 0.2035 - val_acc: 0.9380

Epoch 00005: val_acc did not improve from 0.94218
Epoch 6/1000
 - 46s - loss: 0.1799 - acc: 0.9357 - val_loss: 0.2061 - val_acc: 0.9380

Epoch 00006: val_acc did not improve from 0.94218
Epoch 00006: early stopping
Model: "model_60"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_60 (InputLayer)           (None, 256, 256, 1)  0                                            
__________________________________________________________________________________________________
conv2d_1122 (Conv2D)            (None, 256, 256, 64) 640         input_60[0][0]                   
__________________________________________________________________________________________________
leaky_re_lu_1299 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1122[0][0]                
__________________________________________________________________________________________________
conv2d_1123 (Conv2D)            (None, 256, 256, 64) 36928       leaky_re_lu_1299[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1300 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1123[0][0]                
__________________________________________________________________________________________________
max_pooling2d_237 (MaxPooling2D (None, 128, 128, 64) 0           leaky_re_lu_1300[0][0]           
__________________________________________________________________________________________________
dropout_532 (Dropout)           (None, 128, 128, 64) 0           max_pooling2d_237[0][0]          
__________________________________________________________________________________________________
conv2d_1124 (Conv2D)            (None, 128, 128, 128 73856       dropout_532[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1301 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1124[0][0]                
__________________________________________________________________________________________________
conv2d_1125 (Conv2D)            (None, 128, 128, 128 147584      leaky_re_lu_1301[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1302 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1125[0][0]                
__________________________________________________________________________________________________
max_pooling2d_238 (MaxPooling2D (None, 64, 64, 128)  0           leaky_re_lu_1302[0][0]           
__________________________________________________________________________________________________
dropout_533 (Dropout)           (None, 64, 64, 128)  0           max_pooling2d_238[0][0]          
__________________________________________________________________________________________________
conv2d_1126 (Conv2D)            (None, 64, 64, 256)  295168      dropout_533[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1303 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1126[0][0]                
__________________________________________________________________________________________________
conv2d_1127 (Conv2D)            (None, 64, 64, 256)  590080      leaky_re_lu_1303[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1304 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1127[0][0]                
__________________________________________________________________________________________________
max_pooling2d_239 (MaxPooling2D (None, 32, 32, 256)  0           leaky_re_lu_1304[0][0]           
__________________________________________________________________________________________________
dropout_534 (Dropout)           (None, 32, 32, 256)  0           max_pooling2d_239[0][0]          
__________________________________________________________________________________________________
conv2d_1128 (Conv2D)            (None, 32, 32, 512)  1180160     dropout_534[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1305 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1128[0][0]                
__________________________________________________________________________________________________
conv2d_1129 (Conv2D)            (None, 32, 32, 512)  2359808     leaky_re_lu_1305[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1306 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1129[0][0]                
__________________________________________________________________________________________________
max_pooling2d_240 (MaxPooling2D (None, 16, 16, 512)  0           leaky_re_lu_1306[0][0]           
__________________________________________________________________________________________________
dropout_535 (Dropout)           (None, 16, 16, 512)  0           max_pooling2d_240[0][0]          
__________________________________________________________________________________________________
conv2d_1130 (Conv2D)            (None, 16, 16, 1024) 4719616     dropout_535[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1307 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_1130[0][0]                
__________________________________________________________________________________________________
conv2d_1131 (Conv2D)            (None, 16, 16, 1024) 9438208     leaky_re_lu_1307[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1308 (LeakyReLU)    (None, 16, 16, 1024) 0           conv2d_1131[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_237 (Conv2DTra (None, 32, 32, 512)  4719104     leaky_re_lu_1308[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1309 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_transpose_237[0][0]       
__________________________________________________________________________________________________
concatenate_237 (Concatenate)   (None, 32, 32, 1024) 0           leaky_re_lu_1309[0][0]           
                                                                 leaky_re_lu_1306[0][0]           
__________________________________________________________________________________________________
dropout_536 (Dropout)           (None, 32, 32, 1024) 0           concatenate_237[0][0]            
__________________________________________________________________________________________________
conv2d_1132 (Conv2D)            (None, 32, 32, 512)  4719104     dropout_536[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1310 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1132[0][0]                
__________________________________________________________________________________________________
conv2d_1133 (Conv2D)            (None, 32, 32, 512)  2359808     leaky_re_lu_1310[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1311 (LeakyReLU)    (None, 32, 32, 512)  0           conv2d_1133[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_238 (Conv2DTra (None, 64, 64, 256)  1179904     leaky_re_lu_1311[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1312 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_transpose_238[0][0]       
__________________________________________________________________________________________________
concatenate_238 (Concatenate)   (None, 64, 64, 512)  0           leaky_re_lu_1312[0][0]           
                                                                 leaky_re_lu_1304[0][0]           
__________________________________________________________________________________________________
dropout_537 (Dropout)           (None, 64, 64, 512)  0           concatenate_238[0][0]            
__________________________________________________________________________________________________
conv2d_1134 (Conv2D)            (None, 64, 64, 256)  1179904     dropout_537[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1313 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1134[0][0]                
__________________________________________________________________________________________________
conv2d_1135 (Conv2D)            (None, 64, 64, 256)  590080      leaky_re_lu_1313[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1314 (LeakyReLU)    (None, 64, 64, 256)  0           conv2d_1135[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_239 (Conv2DTra (None, 128, 128, 128 295040      leaky_re_lu_1314[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1315 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_transpose_239[0][0]       
__________________________________________________________________________________________________
concatenate_239 (Concatenate)   (None, 128, 128, 256 0           leaky_re_lu_1315[0][0]           
                                                                 leaky_re_lu_1302[0][0]           
__________________________________________________________________________________________________
dropout_538 (Dropout)           (None, 128, 128, 256 0           concatenate_239[0][0]            
__________________________________________________________________________________________________
conv2d_1136 (Conv2D)            (None, 128, 128, 128 295040      dropout_538[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1316 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1136[0][0]                
__________________________________________________________________________________________________
conv2d_1137 (Conv2D)            (None, 128, 128, 128 147584      leaky_re_lu_1316[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1317 (LeakyReLU)    (None, 128, 128, 128 0           conv2d_1137[0][0]                
__________________________________________________________________________________________________
conv2d_transpose_240 (Conv2DTra (None, 256, 256, 64) 73792       leaky_re_lu_1317[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1318 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_transpose_240[0][0]       
__________________________________________________________________________________________________
concatenate_240 (Concatenate)   (None, 256, 256, 128 0           leaky_re_lu_1318[0][0]           
                                                                 leaky_re_lu_1300[0][0]           
__________________________________________________________________________________________________
dropout_539 (Dropout)           (None, 256, 256, 128 0           concatenate_240[0][0]            
__________________________________________________________________________________________________
dropout_540 (Dropout)           (None, 256, 256, 128 0           dropout_539[0][0]                
__________________________________________________________________________________________________
conv2d_1138 (Conv2D)            (None, 256, 256, 64) 73792       dropout_540[0][0]                
__________________________________________________________________________________________________
leaky_re_lu_1319 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1138[0][0]                
__________________________________________________________________________________________________
conv2d_1139 (Conv2D)            (None, 256, 256, 64) 36928       leaky_re_lu_1319[0][0]           
__________________________________________________________________________________________________
leaky_re_lu_1320 (LeakyReLU)    (None, 256, 256, 64) 0           conv2d_1139[0][0]                
__________________________________________________________________________________________________
conv2d_1140 (Conv2D)            (None, 256, 256, 3)  195         leaky_re_lu_1320[0][0]           
==================================================================================================
Total params: 34,512,323
Trainable params: 34,512,323
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1213 samples, validate on 135 samples
Epoch 1/1000
 - 47s - loss: 0.8530 - acc: 0.8933 - val_loss: 0.3754 - val_acc: 0.9134

Epoch 00001: val_acc improved from -inf to 0.91344, saving model to unn_grid.h5
Epoch 2/1000
 - 46s - loss: 0.4847 - acc: 0.9342 - val_loss: 0.2959 - val_acc: 0.9132

Epoch 00002: val_acc did not improve from 0.91344
Epoch 3/1000
 - 46s - loss: 0.3829 - acc: 0.9303 - val_loss: 0.2515 - val_acc: 0.9117

Epoch 00003: val_acc did not improve from 0.91344
Epoch 4/1000
 - 46s - loss: 0.2656 - acc: 0.9322 - val_loss: 0.2901 - val_acc: 0.9026

Epoch 00004: val_acc did not improve from 0.91344

Epoch 00004: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-07.
Epoch 5/1000
 - 46s - loss: 0.2159 - acc: 0.9350 - val_loss: 0.2523 - val_acc: 0.9097

Epoch 00005: val_acc did not improve from 0.91344
Epoch 6/1000
 - 46s - loss: 0.2098 - acc: 0.9356 - val_loss: 0.2401 - val_acc: 0.9118
Using TensorFlow backend.

Epoch 00006: val_acc did not improve from 0.91344
Epoch 00006: early stopping
scores= [[0.94593302 0.45337382 0.40869075]
 [0.93582602 0.33330832 0.3119443 ]
 [0.95986734 0.64962314 0.57892187]
 [0.93558513 0.33322472 0.31186717]
 [0.95149693 0.52931513 0.48150358]
 [0.93571018 0.33331998 0.31195914]
 [0.95960049 0.62126837 0.55187472]
 [0.93582604 0.33330626 0.31194201]
 [0.96562115 0.72077765 0.63546703]
 [0.93588448 0.3333275  0.3119623 ]
 [0.94705553 0.49200807 0.44335227]
 [0.93516948 0.33512789 0.31371097]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]] parameters= (64, 'Adam', 0.2, 'glorot_uniform', 1e-05)
[[0.94593302 0.45337382 0.40869075]
 [0.93582602 0.33330832 0.3119443 ]
 [0.95986734 0.64962314 0.57892187]
 [0.93558513 0.33322472 0.31186717]
 [0.95149693 0.52931513 0.48150358]
 [0.93571018 0.33331998 0.31195914]
 [0.95960049 0.62126837 0.55187472]
 [0.93582604 0.33330626 0.31194201]
 [0.96562115 0.72077765 0.63546703]
 [0.93588448 0.3333275  0.3119623 ]
 [0.94705553 0.49200807 0.44335227]
 [0.93516948 0.33512789 0.31371097]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]
 [0.         0.         0.        ]]
